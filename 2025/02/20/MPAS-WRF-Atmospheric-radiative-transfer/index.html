

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="wpsze">
  <meta name="keywords" content="">
  
    <meta name="description" content="Read MPAS |WRF | Solar Energy  Radiative transfer Radiative transfer (also called radiation transport) is the physical phenomenon of energy transfer in the form of electromagnetic radiation. The prop">
<meta property="og:type" content="article">
<meta property="og:title" content="MPAS | WRF | Atmospheric radiative transfer">
<meta property="og:url" content="https://waipangsze.github.io/2025/02/20/MPAS-WRF-Atmospheric-radiative-transfer/index.html">
<meta property="og:site_name" content="wpsze">
<meta property="og:description" content="Read MPAS |WRF | Solar Energy  Radiative transfer Radiative transfer (also called radiation transport) is the physical phenomenon of energy transfer in the form of electromagnetic radiation. The prop">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.imgur.com/PdvPtL0.png">
<meta property="article:published_time" content="2025-02-20T03:26:00.000Z">
<meta property="article:modified_time" content="2025-03-10T00:34:43.097Z">
<meta property="article:author" content="wpsze">
<meta property="article:tag" content="MPAS">
<meta property="article:tag" content="NWP">
<meta property="article:tag" content="WRF">
<meta property="article:tag" content="ERA5">
<meta property="article:tag" content="GFS">
<meta property="article:tag" content="RRTM">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.imgur.com/PdvPtL0.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>MPAS | WRF | Atmospheric radiative transfer - wpsze</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"waipangsze.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":"F7MK-FcxSomhtc1N3hIUDA"},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=F7MK-FcxSomhtc1N3hIUDA", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', 'F7MK-FcxSomhtc1N3hIUDA');
        });
      }
    </script>
  

  

  

  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>wpsze</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>Links</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/bookmark/" target="_self">
                <i class="iconfont icon-bookmark"></i>
                <span>Bookmarks</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                <span>Docs</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Physics/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Physics</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Maths/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Maths</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/CFD/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>CFD</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/ML/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>ML</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Meteorology/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Meteorology</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/MPAS/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>MPAS</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/monitor/" target="_self">
                    
                    <span>Real Time Monitoring</span>
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About Me</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://i.imgur.com/PdvPtL0.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="MPAS | WRF | Atmospheric radiative transfer"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-02-20 11:26" pubdate>
          February 20, 2025 am
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          732 words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          7 mins
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> views
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">MPAS | WRF | Atmospheric radiative transfer</h1>
            
            
              <div class="markdown-body">
                
                <ul>
<li>Read <a href="https://waipangsze.github.io/2025/02/12/MPAS-WRF-Solar-Energy/"><strong>MPAS |WRF | Solar Energy</strong></a></li>
</ul>
<h1 id="radiative-transfer">Radiative transfer</h1>
<p><strong>Radiative transfer</strong> (also called <strong>radiation transport</strong>) is the physical phenomenon of energy transfer in the form of electromagnetic radiation. The propagation of radiation through a medium is affected by <em>absorption, emission, and scattering processes</em>. The equation of radiative transfer describes these interactions mathematically.</p>
<h2 id="intensity">Intensity</h2>
<p>In physics and many other areas of science and engineering the <strong>intensity</strong> or <strong>flux of radiant energy</strong> is the <em>power</em> transferred per <em>unit area</em>, where the area is measured on the plane perpendicular to the direction of propagation of the energy. In the SI system, it has units watts per square metre (<strong>W/m2</strong>).</p>
<p>If a point source is radiating energy in all directions (producing a spherical wave), and no energy is absorbed or scattered by the medium, then the intensity decreases in proportion to the distance from the object squared. This is an example of the inverse-square law.</p>
<p>Applying the law of conservation of energy, if the net power emanating is constant,</p>
<p><span class="math display">\[
P = \int \mathbf{I} \cdot d\mathbf{A},
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(P\)</span> is the net power (Watts) radiated;</li>
<li><span class="math inline">\(\mathbf{I}\)</span> is the intensity vector as a function of position;</li>
<li>the magnitude <span class="math inline">\(|\mathbf{I}|\)</span> is the intensity as a function of position;</li>
<li><span class="math inline">\(d\mathbf{A}\)</span> is a differential element of a closed surface that contains the source.</li>
</ul>
<h2 id="intensity-as-a-function-of-position-on-earths-surface">Intensity as a Function of Position on Earth’s Surface</h2>
<h3 id="understand-the-power-output-of-the-sun-luminosity"><strong>Understand the Power Output of the Sun (Luminosity)</strong></h3>
<p>The total power (or luminosity) of the Sun, <span class="math inline">\(P_{\text{Sun}}\)</span> , represents the total energy it emits per unit time across all wavelengths and directions. This is a well-known value in astrophysics, and as of my latest knowledge update, the Sun’s luminosity is approximately:</p>
<p><span class="math display">\[
\begin{align}
P/A &amp;= \sigma T^4 \\
\sigma &amp;= 5.67×10^{-8}\\
R_{\text{Sun}} &amp;= 695500×1000 m \\
T_{\text{Sun}} &amp;= 5778 K \\
P_{\text{Sun}} &amp;\approx 3.828 \times 10^{26} \, \text{W} \, (\text{watts})
\end{align}
\tag{1}
\]</span></p>
<p>This is the net power radiated by the Sun into space, assuming it behaves as a <strong>near-perfect blackbody emitter</strong> at a <em>surface temperature</em> of about <span class="math inline">\(5,778 K\)</span>.</p>
<h3 id="earths-distance-from-the-sun">Earth’s Distance from the Sun:</h3>
<p>The average distance from the Sun to Earth is:</p>
<p><span class="math display">\[
r \approx 1 \, \text{AU} = 1.496 \times 10^{11} \, \text{m}
\]</span></p>
<p>Now, calculate <span class="math inline">\(r^2\)</span>:</p>
<p><span class="math display">\[
r^2 = (1.496 \times 10^{11})^2 = 2.238 \times 10^{22} \, \text{m}^2
\]</span></p>
<p>Calculate <span class="math inline">\(4 \pi r^2\)</span>:</p>
<p><span class="math display">\[
4 \pi r^2 \approx 4 \times 3.1416 \times 2.238 \times 10^{22} \approx 2.813 \times 10^{23} \, \text{m}^2
\]</span></p>
<p>Now, compute the intensity at Earth’s distance (top of the atmosphere, assuming no atmospheric effects):</p>
<p><span class="math display">\[
I = \frac{3.828 \times 10^{26}}{2.813 \times 10^{23}} \approx 1,361 \, \text{W/m}^2
\]</span></p>
<h3 id="geometry-of-earths-surface"><strong>Geometry of Earth’s Surface</strong></h3>
<p>Earth is a sphere with a radius <span class="math inline">\(R_{\text{Earth}} \approx 6,371 \, \text{km} = 6.371 \times 10^6 \, \text{m}\)</span>. The intensity (flux) at the top of the atmosphere <span class="math inline">\((1,361 W/m²)\)</span> is the incident flux perpendicular to the Sun’s rays. However, on Earth’s surface, the intensity varies due to:</p>
<ul>
<li>The angle of incidence (cosine effect): The flux decreases as <span class="math inline">\(\cos\theta\)</span>, where <span class="math inline">\(\theta\)</span> is the zenith angle (angle from the vertical).</li>
<li>The curvature of Earth: Only a portion of Earth’s surface is illuminated at any time, and the flux spreads over the illuminated hemisphere.</li>
</ul>
<h3 id="assuming-perpendicular-incidence-at-the-sub-solar-point"><strong>Assuming Perpendicular Incidence at the Sub-Solar Point</strong></h3>
<p>At the sub-solar point (directly under the Sun, where <span class="math inline">\(\theta = 0\)</span>), the intensity on Earth’s surface (ignoring atmospheric effects, as per the image) would still be <span class="math inline">\(1,361 W/m²\)</span>, because no energy is absorbed or scattered.</p>
<p>Across the rest of the illuminated hemisphere, the intensity decreases with <span class="math inline">\(\cos\theta\)</span>. For a point on Earth’s surface at zenith angle <span class="math inline">\(\theta\)</span>, the flux is:</p>
<p><span class="math display">\[
I_{\text{surface}} = I \cdot \cos\theta = 1,361 \cdot \cos\theta \, \text{W/m}^2
\]</span></p>
<p>The differential area element on a sphere is <span class="math inline">\(dA = R_{\text{Earth}}^2 \sin\theta \, d\theta \, d\phi\)</span>, where <span class="math inline">\(\theta\)</span> is the zenith angle (0 to <span class="math inline">\(\pi/2\)</span> for the illuminated hemisphere) and <span class="math inline">\(\phi\)</span> is the azimuthal angle (0 to <span class="math inline">\(2\pi\)</span>).</p>
<p>The intensity at angle <span class="math inline">\(\theta\)</span> is <span class="math inline">\(I \cdot \cos\theta\)</span>. The power <span class="math inline">\(dP\)</span> through a differential area <span class="math inline">\(dA\)</span> is:</p>
<p><span class="math display">\[
dP = I \cdot \cos\theta \cdot dA = (1,361 \cdot \cos\theta) \cdot (R_{\text{Earth}}^2 \sin\theta \, d\theta \, d\phi)
\]</span></p>
<p>Integrate over <span class="math inline">\(\theta\)</span> from 0 to <span class="math inline">\(\pi/2\)</span> and <span class="math inline">\(\phi\)</span> from 0 to <span class="math inline">\(2\pi\)</span>:</p>
<p><span class="math display">\[
P_{\text{Earth}} = \int_0^{2\pi} \int_0^{\pi/2} (1,361 \cdot \cos\theta) \cdot (R_{\text{Earth}}^2 \sin\theta) \, d\theta \, d\phi
\]</span></p>
<p>First, integrate over <span class="math inline">\(\phi\)</span>:</p>
<p><span class="math display">\[
\int_0^{2\pi} d\phi = 2\pi
\]</span></p>
<p>Now, integrate over <span class="math inline">\(\theta\)</span>:</p>
<p><span class="math display">\[
\int_0^{\pi/2} (1,361 \cdot \cos\theta) \cdot (\sin\theta) \, d\theta = 1,361 \cdot R_{\text{Earth}}^2 \int_0^{\pi/2} \sin\theta \cos\theta \, d\theta
\]</span></p>
<p>Use the substitution <span class="math inline">\(u = \sin\theta\)</span>, so <span class="math inline">\(du = \cos\theta \, d\theta\)</span>. The limits change from <span class="math inline">\(\theta = 0\)</span> to <span class="math inline">\(\pi/2\)</span> (i.e., <span class="math inline">\(u = 0\)</span> to 1):</p>
<p><span class="math display">\[
\int_0^{\pi/2} \sin\theta \cos\theta \, d\theta = \int_0^1 u \, du = \left[ \frac{u^2}{2} \right]_0^1 = \frac{1}{2}
\]</span></p>
<p>So:</p>
<p><span class="math display">\[
P_{\text{Earth}} = 1,361 \cdot R_{\text{Earth}}^2 \cdot 2\pi \cdot \frac{1}{2} = 1,361 \cdot \pi \cdot R_{\text{Earth}}^2
\]</span></p>
<p>Substitute <span class="math inline">\(R_{\text{Earth}} = 6.371 \times 10^6 \, \text{m}\)</span>:</p>
<p><span class="math display">\[
R_{\text{Earth}}^2 = (6.371 \times 10^6)^2 = 4.059 \times 10^{13} \, \text{m}^2
\]</span></p>
<p><span class="math display">\[
P_{\text{Earth}} = 1,361 \cdot \pi \cdot 4.059 \times 10^{13}
\]</span></p>
<p><span class="math display">\[
P_{\text{Earth}} \approx 4,276 \cdot 4.059 \times 10^{13} \approx 1.736 \times 10^{17} \, \text{W}
\]</span></p>
<p>This is the total power received by Earth’s illuminated hemisphere, ignoring atmospheric effects. However, note that the actual power received at the surface is less due to atmospheric absorption and scattering.</p>
<h1 id="more">More</h1>
<h2 id="solutions-to-the-equation-of-radiative-transfer">Solutions to the equation of radiative transfer</h2>
<p>Solutions to the equation of radiative transfer form an enormous body of work. The differences however, are essentially due to the various forms for the emission and absorption coefficients. If scattering is ignored, then a general steady state solution in terms of the emission and absorption coefficients may be written:</p>
<p><span class="math display">\[
I_\nu(s)=I_\nu(s_0)e^{-\tau_\nu(s_0,s)}+\int_{s_0}^s j_\nu(s&#39;)
e^{-\tau_\nu(s&#39;,s)}\,ds&#39;
\]</span></p>
<p>where <span class="math inline">\(\tau_\nu(s_1,s_2)\)</span> is the <strong>optical depth</strong> of the medium between positions <span class="math inline">\(s_1\)</span> and <span class="math inline">\(s_2\)</span>:</p>
<p><span class="math display">\[
\tau_\nu(s_1,s_2) \ \stackrel{\mathrm{def}}{=}\ \int_{s_1}^{s_2} \alpha_\nu(s)\,ds
\]</span></p>
<h2 id="radiance-發射率">radiance 發射率</h2>
<p>光源的 <code>輻射率</code> 或 <code>輻亮度</code> <strong>(radiance)</strong>，是描述非點光源時光源單位面積強度的物理量，定義為在指定方向上的單位<strong>立體角</strong>和垂直此方向的單位<strong>面積</strong>上的<strong>輻射通量</strong>，記為<strong>L</strong>。</p>
<p>In radiometry, radiance is the radiant flux emitted, reflected, transmitted or received <strong>by a given surface</strong>, per unit solid angle per unit projected area. Radiance is used to characterize diffuse emission and reflection of electromagnetic radiation, and to quantify emission of neutrinos and other particles. The SI unit of radiance is the watt per steradian per square metre <span class="math inline">\((W sr^{−1} m^{−2})\)</span>. It is a directional quantity: the radiance of a surface depends on the direction from which it is being observed.</p>
<p>The related quantity spectral radiance is the radiance of a surface per unit frequency or wavelength, depending on whether the spectrum is taken as a function of frequency or of wavelength.</p>
<p>Historically, radiance was called "<strong>intensity</strong>" and spectral radiance was called "<strong>specific intensity</strong>". Many fields still use this nomenclature. It is especially dominant in heat transfer, astrophysics and astronomy. "Intensity" has many other meanings in physics, with the most common being power per unit area (<strong>so the radiance is the intensity per solid angle in this case</strong>).</p>
<p><span class="math display">\[
L=\frac{\partial^2 \Phi}{\cos \theta \partial A \partial \Omega}
\]</span></p>
<p>其中：<strong><span class="math inline">\(\Phi\)</span></strong> 是<strong>輻射通量</strong>，單位<strong>瓦特</strong>（W）；<strong><span class="math inline">\(\Omega\)</span></strong>是<strong>立體角</strong>，單位<strong>球面度</strong> <strong>(sr)</strong>。</p>
<div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/GzqyGa8.png" srcset="/img/loading.gif" lazyload /></div><div class="group-image-wrap"><img src="https://i.imgur.com/6KeXzXp.png" srcset="/img/loading.gif" lazyload /></div><div class="group-image-wrap"><img src="https://i.imgur.com/PdvPtL0.png" srcset="/img/loading.gif" lazyload /></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/R2hipMd.png" srcset="/img/loading.gif" lazyload /></div></div></div>
<h1 id="references">References</h1>
<ol type="1">
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Atmospheric_radiative_transfer_codes">Atmospheric radiative transfer codes</a></li>
<li><a target="_blank" rel="noopener" href="https://www.ess.uci.edu/~yu/class/ess200a/lecture.2.global.pdf">lecture.2.global.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cv.nrao.edu/~sransom/web/Ch2.html">Radiation Fundamentals</a></li>
<li><a target="_blank" rel="noopener" href="https://pages.mtu.edu/~scarn/teaching/GE4250/radiation_lecture_slides.pdf">Properties of Radiation</a></li>
<li><a target="_blank" rel="noopener" href="https://labs.phys.utk.edu/mbreinig/phys421/modules/m5/Radiometry.html">Radiometry and Photometry (<strong>Recommend</strong>)</a>
<ol type="1">
<li>To specify the amount of energy emitted by a source, we use the quantities.
<ol type="1">
<li>Energy</li>
<li>Power</li>
<li>Power per unit area</li>
<li>Power per unit solid angle</li>
<li>Power per unit solid angle per unit projected area</li>
</ol></li>
<li>To specify the amount of energy received by a detector, we use one quantity.
<ol type="1">
<li>Power per unit area</li>
</ol></li>
</ol></li>
<li><a target="_blank" rel="noopener" href="https://www.ulethbridge.ca/phy/naylor/documents/pdf/btram.pdf">Chapman, I. M., Naylor, D. A., Gom, B., Querel, R. R., &amp; Davis-Imhof, P. (2010). Btram: An interactive atmospheric radiative transfer model. In 30th Canadian Symposium.</a></li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/MPAS/" class="category-chain-item">MPAS</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/MPAS/" class="print-no-link">#MPAS</a>
      
        <a href="/tags/NWP/" class="print-no-link">#NWP</a>
      
        <a href="/tags/WRF/" class="print-no-link">#WRF</a>
      
        <a href="/tags/ERA5/" class="print-no-link">#ERA5</a>
      
        <a href="/tags/GFS/" class="print-no-link">#GFS</a>
      
        <a href="/tags/RRTM/" class="print-no-link">#RRTM</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>MPAS | WRF | Atmospheric radiative transfer</div>
      <div>https://waipangsze.github.io/2025/02/20/MPAS-WRF-Atmospheric-radiative-transfer/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>wpsze</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>February 20, 2025</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Updated on</div>
          <div>March 10, 2025</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/02/21/ML-NVIDIA-Modulus/" title="ML | NVIDIA Modulus">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ML | NVIDIA Modulus</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/02/19/MPAS-WRF-Extract-GFS-GRIB-files/" title="MPAS | WRF | Extract subset of GFS GRIB files">
                        <span class="hidden-mobile">MPAS | WRF | Extract subset of GFS GRIB files</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9HL36SZ28R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9HL36SZ28R');
</script>

    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">

  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  

  <span id="sitetime"></span>
  <script language=javascript>
    function siteTime(){
      window.setTimeout("siteTime()", 1000);
      var seconds = 1000;
      var minutes = seconds * 60;
      var hours = minutes * 60;
      var days = hours * 24;
      var years = days * 365;
      var today = new Date();
      var todayYear = today.getFullYear();
      var todayMonth = today.getMonth()+1;
      var todayDate = today.getDate();
      var todayHour = today.getHours();
      var todayMinute = today.getMinutes();
      var todaySecond = today.getSeconds();
      /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
      year - 作为date对象的年份，为4位年份值
      month - 0-11之间的整数，做为date对象的月份
      day - 1-31之间的整数，做为date对象的天数
      hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
      minutes - 0-59之间的整数，做为date对象的分钟数
      seconds - 0-59之间的整数，做为date对象的秒数
      microseconds - 0-999之间的整数，做为date对象的毫秒数 */
      var t1 = Date.UTC(2023,04,23,00,00,00); //北京时间2018-2-13 00:00:00
      var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
      var diff = t2-t1;
      var diffYears = Math.floor(diff/years);
      var diffDays = Math.floor((diff/days)-diffYears*365);
      var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
      var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
      var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
      /*document.getElementById("sitetime").innerHTML=" 已运行"+/*diffYears+" 年 "+*/diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
      document.getElementById("sitetime").innerHTML=" 已運行"+diffYears+" 年 "+diffDays+" 天 ";
    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
  </script>
  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
