

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="wpsze">
  <meta name="keywords" content="">
  
    <meta name="description" content="GFS subset download NOMADS Data at NCEP  https:&#x2F;&#x2F;nomads.ncep.noaa.gov&#x2F; https:&#x2F;&#x2F;nomads.ncep.noaa.gov&#x2F;gribfilter.php?ds&#x3D;gfs_0p25_1hr https:&#x2F;&#x2F;nomads.ncep.noaa.gov&#x2F;gribfilter.php?ds&#x3D;gfs_0p25 Example: 1htt">
<meta property="og:type" content="article">
<meta property="og:title" content="MPAS | WRF | Extract subset of GFS GRIB files">
<meta property="og:url" content="https://waipangsze.github.io/2025/02/19/MPAS-WRF-Extract-GFS-GRIB-files/index.html">
<meta property="og:site_name" content="wpsze">
<meta property="og:description" content="GFS subset download NOMADS Data at NCEP  https:&#x2F;&#x2F;nomads.ncep.noaa.gov&#x2F; https:&#x2F;&#x2F;nomads.ncep.noaa.gov&#x2F;gribfilter.php?ds&#x3D;gfs_0p25_1hr https:&#x2F;&#x2F;nomads.ncep.noaa.gov&#x2F;gribfilter.php?ds&#x3D;gfs_0p25 Example: 1htt">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.imgur.com/GO7mmRR.png">
<meta property="article:published_time" content="2025-02-19T10:02:00.000Z">
<meta property="article:modified_time" content="2025-10-16T05:50:18.717Z">
<meta property="article:author" content="wpsze">
<meta property="article:tag" content="WRF">
<meta property="article:tag" content="MPAS">
<meta property="article:tag" content="NWP">
<meta property="article:tag" content="ERA5">
<meta property="article:tag" content="GFS">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.imgur.com/GO7mmRR.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>MPAS | WRF | Extract subset of GFS GRIB files - wpsze</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"waipangsze.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":"F7MK-FcxSomhtc1N3hIUDA"},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=F7MK-FcxSomhtc1N3hIUDA", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', 'F7MK-FcxSomhtc1N3hIUDA');
        });
      }
    </script>
  

  

  

  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>wpsze</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>Links</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/bookmark/" target="_self">
                <i class="iconfont icon-bookmark"></i>
                <span>Bookmarks</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                <span>Docs</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Physics/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Physics</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Maths/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Maths</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/CFD/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>CFD</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/ML/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>ML</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Meteorology/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Meteorology</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/MPAS/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>MPAS</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/PALM/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>PALM</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/monitor/" target="_self">
                    
                    <span>Real Time Monitoring</span>
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About Me</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://i.imgur.com/GO7mmRR.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="MPAS | WRF | Extract subset of GFS GRIB files"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-02-19 18:02" pubdate>
          February 19, 2025 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.8k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          24 mins
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> views
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">MPAS | WRF | Extract subset of GFS GRIB files</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="gfs-subset-download">GFS subset download</h1>
<h2 id="nomads-data-at-ncep">NOMADS Data at NCEP</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://nomads.ncep.noaa.gov/" class="uri">https://nomads.ncep.noaa.gov/</a></li>
<li><a target="_blank" rel="noopener" href="https://nomads.ncep.noaa.gov/gribfilter.php?ds=gfs_0p25_1hr" class="uri">https://nomads.ncep.noaa.gov/gribfilter.php?ds=gfs_0p25_1hr</a></li>
<li><a target="_blank" rel="noopener" href="https://nomads.ncep.noaa.gov/gribfilter.php?ds=gfs_0p25" class="uri">https://nomads.ncep.noaa.gov/gribfilter.php?ds=gfs_0p25</a></li>
<li>Example: <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs URL">https://nomads.ncep.noaa.gov/cgi-bin/filter_gfs_0p25_1hr.pl?dir=%2Fgfs.20250228%2F00%2Fatmos&amp;file=gfs.t00z.pgrb2.0p25.anl&amp;var_TMP=on&amp;var_U-GWD=on&amp;var_V-GWD=on&amp;all_lev=on<br></code></pre></td></tr></table></figure></li>
<li>Dowload script: 
    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-dcdac752" role="button" aria-expanded="false" aria-controls="collapse-dcdac752">
        <div class="fold-arrow">▶</div>download_gfs.sh
      </div>
      <div class="fold-collapse collapse" id="collapse-dcdac752">
        <div class="fold-content">
          <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># define URL</span><br><span class="hljs-comment">#</span><br>workdir=/home/wpsze/mpas/GFS/<br>hr=00<br><span class="hljs-comment">#date_st=20240920</span><br>date_st=$(<span class="hljs-built_in">date</span> -d <span class="hljs-string">&quot;today -1 days&quot;</span> +%Y%m%d)<br><br><span class="hljs-comment">#wget </span><br><br><span class="hljs-keyword">for</span> iday <span class="hljs-keyword">in</span> &#123;0..0..1&#125;; <span class="hljs-keyword">do</span><br>    <br>    idate=$(<span class="hljs-built_in">date</span> -d <span class="hljs-string">&quot;<span class="hljs-variable">$date_st</span> + <span class="hljs-variable">$iday</span> days&quot;</span> +%Y%m%d)<br>    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$date_st</span> <span class="hljs-variable">$idate</span><br><br>    <span class="hljs-keyword">for</span> fhr <span class="hljs-keyword">in</span> &#123;000..384..1&#125;; <span class="hljs-keyword">do</span> <span class="hljs-comment"># or &#123;076..76..1&#125;</span><br><br>  <span class="hljs-comment"># https://nomads.ncep.noaa.gov/gribfilter.php?ds=gfs_0p25</span><br><br>    URL=<span class="hljs-string">&quot;https://nomads.ncep.noaa.gov/cgi-bin/filter_gfs_0p25.pl?dir=%2Fgfs.<span class="hljs-variable">$&#123;idate&#125;</span>%2F<span class="hljs-variable">$&#123;hr&#125;</span>%2Fatmos&amp;file=gfs.t<span class="hljs-variable">$&#123;hr&#125;</span>z.pgrb2.0p25.f<span class="hljs-variable">$&#123;fhr&#125;</span>&amp;var_DSWRF=on&amp;var_RH=on&amp;var_TMP=on&amp;var_UGRD=on&amp;var_VGRD=on&amp;lev_2_m_above_ground=on&amp;lev_10_m_above_ground=on&amp;lev_20_m_above_ground=on&amp;lev_30_m_above_ground=on&amp;lev_40_m_above_ground=on&amp;lev_50_m_above_ground=on&amp;lev_80_m_above_ground=on&amp;lev_100_m_above_ground=on&amp;lev_surface=on&quot;</span><br><br>    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;URL&#125;</span><br><br>    yyyymm=<span class="hljs-variable">$&#123;idate:0:6&#125;</span><br>    datapath=<span class="hljs-variable">$&#123;workdir&#125;</span>/0p25/<span class="hljs-variable">$&#123;yyyymm&#125;</span>/<span class="hljs-variable">$&#123;idate&#125;</span>/<br>    <span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$&#123;datapath&#125;</span><br><br>    <span class="hljs-comment"># download file</span><br>    wget -c <span class="hljs-string">&quot;<span class="hljs-variable">$URL</span>&quot;</span> -O <span class="hljs-variable">$&#123;datapath&#125;</span>/gfs.t<span class="hljs-variable">$&#123;hr&#125;</span>z.pgrb2.0p25.f<span class="hljs-variable">$&#123;fhr&#125;</span>.grb<br>    <span class="hljs-keyword">done</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div></li>
</ul>
<figure>
<img src="https://i.imgur.com/uC0QDnd.png" srcset="/img/loading.gif" lazyload alt="NCEP GFS Forecasts (0.25 degree grid)" width="500" /><figcaption>NCEP GFS Forecasts (0.25 degree grid)</figcaption>
</figure>
<h2 id="size-of-grib-file">Size of grib file</h2>
<ul>
<li>If full set is downlaoded,
<ul>
<li><code>519M</code> per grib file.</li>
</ul></li>
</ul>
<h2 id="rda.ucar.edu">rda.ucar.edu</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://rda.ucar.edu/datasets/d084001/dataaccess/#" class="uri">https://rda.ucar.edu/datasets/d084001/dataaccess/#</a>
<ul>
<li>Sign up with orcid</li>
<li>Customizable Data Requests &gt; Subsetting</li>
<li>Waiting for completion</li>
<li>csh/python scripts are provided</li>
</ul></li>
</ul>
<div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/GO7mmRR.png" srcset="/img/loading.gif" lazyload /></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/gyRwXFJ.png" srcset="/img/loading.gif" lazyload /></div><div class="group-image-wrap"><img src="https://i.imgur.com/HDtKiPl.png" srcset="/img/loading.gif" lazyload /></div></div></div>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-6ae3e036" role="button" aria-expanded="false" aria-controls="collapse-6ae3e036">
        <div class="fold-arrow">▶</div>rda-download.csh
      </div>
      <div class="fold-collapse collapse" id="collapse-6ae3e036">
        <div class="fold-content">
          <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/usr/bin/env csh</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># c-shell script to download selected files from rda.ucar.edu using Wget</span><br><span class="hljs-comment"># NOTE: if you want to run under a different shell, make sure you change</span><br><span class="hljs-comment">#       the &#x27;set&#x27; commands according to your shell&#x27;s syntax</span><br><span class="hljs-comment"># after you save the file, don&#x27;t forget to make it executable</span><br><span class="hljs-comment">#   i.e. - &quot;chmod 755 &lt;name_of_script&gt;&quot;</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Experienced Wget Users: add additional command-line flags to &#x27;opts&#x27; here</span><br><span class="hljs-comment">#   Use the -r (--recursive) option with care</span><br><span class="hljs-comment">#   Do NOT use the -b (--background) option - simultaneous file downloads</span><br><span class="hljs-comment">#       can cause your data access to be blocked</span><br><span class="hljs-built_in">set</span> opts = <span class="hljs-string">&quot;-N&quot;</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Check wget version.  Set the --no-check-certificate option </span><br><span class="hljs-comment"># if wget version is 1.10 or higher</span><br><span class="hljs-built_in">set</span> v = `wget -V |grep <span class="hljs-string">&#x27;GNU Wget &#x27;</span> | <span class="hljs-built_in">cut</span> -d <span class="hljs-string">&#x27; &#x27;</span> -f 3`<br><span class="hljs-built_in">set</span> a = `<span class="hljs-built_in">echo</span> <span class="hljs-variable">$v</span> | <span class="hljs-built_in">cut</span> -d <span class="hljs-string">&#x27;.&#x27;</span> -f 1`<br><span class="hljs-built_in">set</span> b = `<span class="hljs-built_in">echo</span> <span class="hljs-variable">$v</span> | <span class="hljs-built_in">cut</span> -d <span class="hljs-string">&#x27;.&#x27;</span> -f 2`<br><span class="hljs-keyword">if</span>(100 * <span class="hljs-variable">$a</span> + <span class="hljs-variable">$b</span> &gt; 109) <span class="hljs-keyword">then</span><br>  <span class="hljs-built_in">set</span> cert_opt = <span class="hljs-string">&quot;--no-check-certificate&quot;</span><br><span class="hljs-keyword">else</span><br>  <span class="hljs-built_in">set</span> cert_opt = <span class="hljs-string">&quot;&quot;</span><br>endif<br><br><span class="hljs-built_in">set</span> filelist= ( \<br>  https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2024123000.f384-25.2025011200.f195.grib2.tar \<br>  https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025011200.f198-25.2025011618.f135.grib2.tar \<br>  https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025011618.f138-25.2025012100.f360.grib2.tar \<br>  https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025012100.f366-25.2025012512.f129.grib2.tar \<br>  https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025012512.f132-25.2025012918.f330.grib2.tar \<br>  https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025012918.f336-25.2025020306.f105.grib2.tar \<br>  https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025020306.f108-25.2025020712.f228.grib2.tar \<br>  https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025020712.f231-25.2025021200.f003.grib2.tar \<br>  https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025021200.f006-25.2025021606.f084.grib2.tar \<br>  https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025021606.f087-25.2025021712.f384.grib2.tar \<br>)<br><span class="hljs-keyword">while</span>(<span class="hljs-variable">$#filelist</span> &gt; 0)<br>  <span class="hljs-built_in">set</span> syscmd = <span class="hljs-string">&quot;wget <span class="hljs-variable">$cert_opt</span> <span class="hljs-variable">$opts</span> <span class="hljs-variable">$filelist</span>[1]&quot;</span><br>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$syscmd</span> ...&quot;</span><br>  <span class="hljs-variable">$syscmd</span><br>  <span class="hljs-built_in">shift</span> filelist<br>end<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-9c51fa20" role="button" aria-expanded="false" aria-controls="collapse-9c51fa20">
        <div class="fold-arrow">▶</div>rda-download.py
      </div>
      <div class="fold-collapse collapse" id="collapse-9c51fa20">
        <div class="fold-content">
          <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-string">&quot;&quot;&quot; </span><br><span class="hljs-string">Python script to download selected files from rda.ucar.edu.</span><br><span class="hljs-string">After you save the file, don&#x27;t forget to make it executable</span><br><span class="hljs-string">i.e. - &quot;chmod 755 &lt;name_of_script&gt;&quot;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">import</span> sys, os<br><span class="hljs-keyword">from</span> urllib.request <span class="hljs-keyword">import</span> build_opener<br><br>opener = build_opener()<br><br>filelist = [<br>  <span class="hljs-string">&#x27;https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2024123000.f384-25.2025011200.f195.grib2.tar&#x27;</span>,<br>  <span class="hljs-string">&#x27;https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025011200.f198-25.2025011618.f135.grib2.tar&#x27;</span>,<br>  <span class="hljs-string">&#x27;https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025011618.f138-25.2025012100.f360.grib2.tar&#x27;</span>,<br>  <span class="hljs-string">&#x27;https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025012100.f366-25.2025012512.f129.grib2.tar&#x27;</span>,<br>  <span class="hljs-string">&#x27;https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025012512.f132-25.2025012918.f330.grib2.tar&#x27;</span>,<br>  <span class="hljs-string">&#x27;https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025012918.f336-25.2025020306.f105.grib2.tar&#x27;</span>,<br>  <span class="hljs-string">&#x27;https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025020306.f108-25.2025020712.f228.grib2.tar&#x27;</span>,<br>  <span class="hljs-string">&#x27;https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025020712.f231-25.2025021200.f003.grib2.tar&#x27;</span>,<br>  <span class="hljs-string">&#x27;https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025021200.f006-25.2025021606.f084.grib2.tar&#x27;</span>,<br>  <span class="hljs-string">&#x27;https://request.rda.ucar.edu/dsrqst/SZE782753/TarFiles/gfs.0p25.2025021606.f087-25.2025021712.f384.grib2.tar&#x27;</span><br>]<br><br><span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> filelist:<br>    ofile = os.path.basename(file)<br>    sys.stdout.write(<span class="hljs-string">&quot;downloading &quot;</span> + ofile + <span class="hljs-string">&quot; ... &quot;</span>)<br>    sys.stdout.flush()<br>    infile = opener.<span class="hljs-built_in">open</span>(file)<br>    outfile = <span class="hljs-built_in">open</span>(ofile, <span class="hljs-string">&quot;wb&quot;</span>)<br>    outfile.write(infile.read())<br>    outfile.close()<br>    sys.stdout.write(<span class="hljs-string">&quot;done\n&quot;</span>)<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<h1 id="micromamba-env-setup">Micromamba env setup</h1>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yml"> <span class="hljs-string">$</span> <span class="hljs-string">cat</span> <span class="hljs-string">list.yml</span> <br><span class="hljs-attr">name:</span> <span class="hljs-string">PGW</span><br><span class="hljs-attr">channels:</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">anaconda</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">conda-forge</span><br><span class="hljs-attr">dependencies:</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">conda-forge::cdo</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">conda-forge::dask</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">matplotlib</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">python=3.11</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">scipy</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">conda-forge::wgrib</span><br></code></pre></td></tr></table></figure>
<h1 id="grib-checking">grib checking</h1>
<p>take GFS-wave model as example,</p>
<ul>
<li><code>grib_ls gfs.t00z.global.0p16.f000.grib2</code> 
    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-90469042" role="button" aria-expanded="false" aria-controls="collapse-90469042">
        <div class="fold-arrow">▶</div>gfs.t00z.global.0p16.f000.grib2
      </div>
      <div class="fold-collapse collapse" id="collapse-90469042">
        <div class="fold-content">
          <figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs console">gfs.t00z.global.0p16.f000.grib2<br>edition      centre       date         dataType     gridType     stepRange    typeOfLevel  level        shortName    packingType  <br>2            kwbc         20250227     fc           regular_ll   0            surface      1            ws           grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            surface      1            wdir         grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            surface      1            u            grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            surface      1            v            grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            surface      1            swh          grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            surface      1            perpw        grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            surface      1            dirpw        grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            surface      1            shww         grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            orderedSequenceData  1            swell        grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            orderedSequenceData  2            swell        grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            orderedSequenceData  3            swell        grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            surface      1            mpww         grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            orderedSequenceData  1            swper        grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            orderedSequenceData  2            swper        grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            orderedSequenceData  3            swper        grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            surface      1            wvdir        grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            orderedSequenceData  1            swdir        grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            orderedSequenceData  2            swdir        grid_jpeg   <br>2            kwbc         20250227     fc           regular_ll   0            orderedSequenceData  3            swdir        grid_jpeg   <br>19 of 19 messages in gfs.t00z.global.0p16.f000.grib2<br><br>19 of 19 total messages in 1 files<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div></li>
<li>re-download dataset that only contains surface variables.</li>
<li><code>grib_to_netcdf gfs.t00z.global.0p16.f000.grib2 -o test.nc</code></li>
<li><code>ncvis/ncview test.nc</code></li>
</ul>
<h2 id="from-fullset-of-gfs">From Fullset of GFS</h2>
<h3 id="to-check-paramid">To check <code>paramId</code></h3>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fortran">$ grib_ls -n <span class="hljs-keyword">parameter</span> grib.<span class="hljs-keyword">file</span><br></code></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">centre</span>      paramId     shortName   units       name        <br><span class="hljs-attribute">kwbc</span>        <span class="hljs-number">260074</span>      prmsl       Pa          Pressure reduced to MSL <br><span class="hljs-attribute">kwbc</span>        <span class="hljs-number">260018</span>      clwmr       kg kg**-<span class="hljs-number">1</span>   Cloud mixing ratio <br><span class="hljs-attribute">kwbc</span>        <span class="hljs-number">260019</span>      icmr        kg kg**-<span class="hljs-number">1</span>   Ice water mixing ratio <br><span class="hljs-attribute">kwbc</span>        <span class="hljs-number">260020</span>      rwmr        kg kg**-<span class="hljs-number">1</span>   Rain mixing ratio <br><span class="hljs-attribute">kwbc</span>        <span class="hljs-number">260021</span>      snmr        kg kg**-<span class="hljs-number">1</span>   Snow mixing ratio <br></code></pre></td></tr></table></figure>
<h3 id="wind-speed-heightaboveground">wind speed (heightAboveGround)</h3>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-5d5d193e" role="button" aria-expanded="false" aria-controls="collapse-5d5d193e">
        <div class="fold-arrow">▶</div>wind speed (heightAboveGround)
      </div>
      <div class="fold-collapse collapse" id="collapse-5d5d193e">
        <div class="fold-content">
          <figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            heightAboveGround  <span class="hljs-number">20</span>           u            grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            heightAboveGround  <span class="hljs-number">20</span>           v            grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            heightAboveGround  <span class="hljs-number">30</span>           u            grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            heightAboveGround  <span class="hljs-number">30</span>           v            grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            heightAboveGround  <span class="hljs-number">40</span>           u            grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            heightAboveGround  <span class="hljs-number">40</span>           v            grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            heightAboveGround  <span class="hljs-number">50</span>           u            grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            heightAboveGround  <span class="hljs-number">50</span>           v            grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            heightAboveGround  <span class="hljs-number">80</span>           t            grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            heightAboveGround  <span class="hljs-number">80</span>           q            grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            heightAboveGround  <span class="hljs-number">80</span>           pres         grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            heightAboveGround  <span class="hljs-number">80</span>           u            grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            heightAboveGround  <span class="hljs-number">80</span>           v            grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            heightAboveGround  <span class="hljs-number">100</span>          t            grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            heightAboveGround  <span class="hljs-number">100</span>          <span class="hljs-number">100</span>u         grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            heightAboveGround  <span class="hljs-number">100</span>          <span class="hljs-number">100</span>v         grid_complex_spatial_differencing <br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<h3 id="surface">surface</h3>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-8bbf6858" role="button" aria-expanded="false" aria-controls="collapse-8bbf6858">
        <div class="fold-arrow">▶</div>surface
      </div>
      <div class="fold-collapse collapse" id="collapse-8bbf6858">
        <div class="fold-content">
          <figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            vis          grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            gust         grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            hindex       grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            sp           grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            orog         grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            t            grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            cnwat        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            sdwe         grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            sde          grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            pevpr        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            icetk        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            cpofp        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            cprat        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            prate        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            cprat        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            prate        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            tp           grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            tp           grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            acpcp        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            acpcp        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            watr         grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            csnow        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            cicep        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            cfrzr        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            crain        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            csnow        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            cicep        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            cfrzr        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            crain        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            lhtfl        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            shtfl        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            gflux        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            uflx         grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            vflx         grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            sr           grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            fricv        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            u-gwd        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            v-gwd        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            veg          grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            slt          grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            wilt         grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            fldcp        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            SUNSD        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            lftx         grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            cape         grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            cin          grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            dswrf        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            dlwrf        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            uswrf        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            ulwrf        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            <span class="hljs-number">4</span>lftx        grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            hpbl         grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            lsm          grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            ci           grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">0</span>-<span class="hljs-number">3</span>          surface      <span class="hljs-number">0</span>            al           grid_complex_spatial_differencing <br><span class="hljs-symbol">2 </span>           kwbc         <span class="hljs-number">20241130</span>     fc           regular_ll   <span class="hljs-number">3</span>            surface      <span class="hljs-number">0</span>            ist          grid_complex_spatial_differencing <br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<h1 id="read-gfs-grib2-files">Read GFS grib2 files</h1>
<p>To process a CSV file containing station information (latitude and longitude) and extract weather data from GFS GRIB files, you can follow the steps below. This example assumes you have a CSV file named <code>stations.csv</code> with columns for station names, latitude, and longitude.</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs console"><span class="hljs-meta prompt_"> $ </span><span class="language-bash">grib_ls ./subset-GFS/gfs.0p25.2025021200.f006.grib2</span><br>./subset-GFS/gfs.0p25.2025021200.f006.grib2<br>edition      centre       date         dataType     gridType     typeOfLevel  level        stepRange    shortName    packingType  <br>2            kwbc         20250212     fc           regular_ll   surface      0            0-6          dswrf        grid_complex_spatial_differencing <br>1 of 1 messages in ./subset-GFS/gfs.0p25.2025021200.f006.grib2<br></code></pre></td></tr></table></figure>
<h2 id="step-1-prepare-your-csv-file">Step 1: Prepare Your CSV File</h2>
<p>Ensure your <code>stations.csv</code> has the following structure:</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">station</span>,latitude,longitude<br><span class="hljs-attribute">Station1</span>,<span class="hljs-number">22</span>.<span class="hljs-number">3</span>,<span class="hljs-number">114</span>.<span class="hljs-number">2</span><br><span class="hljs-attribute">Station2</span>,<span class="hljs-number">22</span>.<span class="hljs-number">6</span>,<span class="hljs-number">114</span>.<span class="hljs-number">6</span><br></code></pre></td></tr></table></figure>
<h2 id="step-2-code-to-extract-data-and-save-to-csv">Step 2: Code to Extract Data and Save to CSV</h2>
<p>Here's a complete Python script that reads the station information, extracts the required data from the GRIB files, and writes the results to a new CSV file.</p>
<ul>
<li><code>$ grib_ls -p paramId,shortName,level gfs_20241204_0000_0p25_003</code></li>
</ul>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-5bf6db73" role="button" aria-expanded="false" aria-controls="collapse-5bf6db73">
        <div class="fold-arrow">▶</div>grib_ls -p paramId,shortName,level
      </div>
      <div class="fold-collapse collapse" id="collapse-5bf6db73">
        <div class="fold-content">
          <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">paramId     shortName   level <br>134         sp          0          <br>228002      orog        0          <br>130         t           0          <br>228139      st          0          <br>260185      soilw       0          <br>260205      soill       0          <br>228139      st          0          <br>260185      soilw       0          <br>260205      soill       0          <br>228139      st          0          <br>260185      soilw       0          <br>260205      soill       0          <br>228139      st          1          <br>260185      soilw       1          <br>260205      soill       1          <br>260189      cnwat       0          <br>260056      sdwe        0          <br>3066        sde         0          <br>260037      pevpr       0          <br>3092        icetk       0          <br>167         2t          2          <br>174096      2sh         2          <br>168         2d          2          <br>260242      2r          2          <br>260255      aptmp       2          <br>3015        tmax        2          <br>3016        tmin        2          <br>165         10u         10         <br>166         10v         10         <br>3097        iceg        10 <br>......<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<ul>
<li>$ <code>wgrib2 gfs_20241204_0000_0p25_003 -v</code> 
    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-c21ca059" role="button" aria-expanded="false" aria-controls="collapse-c21ca059">
        <div class="fold-arrow">▶</div>wgrib2 -v
      </div>
      <div class="fold-collapse collapse" id="collapse-c21ca059">
        <div class="fold-content">
          <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">1:0:d=2024120400:PRMSL Pressure Reduced to MSL [Pa]:mean sea level:3 hour fcst:<br>2:998096:d=2024120400:CLMR Cloud Mixing Ratio [kg/kg]:1 hybrid level:3 hour fcst:<br>3:1076966:d=2024120400:ICMR Ice Water Mixing Ratio [kg/kg]:1 hybrid level:3 hour fcst:<br>4:1405742:d=2024120400:RWMR Rain Mixing Ratio [kg/kg]:1 hybrid level:3 hour fcst:<br>5:1656285:d=2024120400:SNMR Snow Mixing Ratio [kg/kg]:1 hybrid level:3 hour fcst:<br>6:1757478:d=2024120400:GRLE Graupel [kg/kg]:1 hybrid level:3 hour fcst:<br>7:1805850:d=2024120400:REFD Reflectivity [dB]:1 hybrid level:3 hour fcst:<br>8:2596761:d=2024120400:REFD Reflectivity [dB]:2 hybrid level:3 hour fcst:<br>9:3388182:d=2024120400:REFC Composite reflectivity [dB]:entire atmosphere:3 hour fcst:<br>10:4239776:d=2024120400:VIS Visibility [m]:surface:3 hour fcst:<br>......<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div></li>
</ul>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-98e16488" role="button" aria-expanded="false" aria-controls="collapse-98e16488">
        <div class="fold-arrow">▶</div>extract_GFS.py
      </div>
      <div class="fold-collapse collapse" id="collapse-98e16488">
        <div class="fold-content">
          <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/bin/python</span><br><br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> xarray <span class="hljs-keyword">as</span> xr<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> glob<br><br><span class="hljs-comment">#===============================================================================================</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_assign</span>(<span class="hljs-params">ds, var, lat, lon</span>):<br>    <span class="hljs-comment"># Check if &#x27;var&#x27; exists in the dataset</span><br>    <span class="hljs-keyword">if</span> var <span class="hljs-keyword">in</span> ds:<br>        <span class="hljs-keyword">return</span> ds[var].interp(latitude=lat, longitude=lon, method=<span class="hljs-string">&#x27;linear&#x27;</span>).values<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> np.nan  <span class="hljs-comment"># Assign NaN if &#x27;var&#x27; does not exist</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_wind_direction</span>(<span class="hljs-params">u, v</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Calculates the meteorological wind direction from u and v components.</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Args:</span><br><span class="hljs-string">        u (float or array-like): Eastward wind component.</span><br><span class="hljs-string">        v (float or array-like): Northward wind component.</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Returns:</span><br><span class="hljs-string">        float or array-like: Wind direction in degrees (0-360), representing</span><br><span class="hljs-string">                             the direction the wind is coming *from*.</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> (np.rad2deg(np.arctan2(u, v)) + <span class="hljs-number">180.0</span>) % <span class="hljs-number">360.0</span><br>    <br><span class="hljs-comment">#===============================================================================================</span><br><span class="hljs-comment"># Step 1: Load the station data</span><br>stations = pd.read_csv(<span class="hljs-string">&#x27;station.csv&#x27;</span>)<br><br><span class="hljs-comment"># Step 2: Get and sort the list of GFS GRIB files</span><br><span class="hljs-comment">#grib_files = sorted(glob.glob(&#x27;./0p25/202509/20250914/gfs.t00z*grb&#x27;) )  # Adjust the path and pattern</span><br>yyyymm=<span class="hljs-string">&quot;202411&quot;</span><br>dd=<span class="hljs-string">&quot;30&quot;</span><br>grib_files = <span class="hljs-built_in">sorted</span>(glob.glob(<span class="hljs-string">f&quot;./0p25/<span class="hljs-subst">&#123;yyyymm&#125;</span>/<span class="hljs-subst">&#123;yyyymm&#125;</span><span class="hljs-subst">&#123;dd&#125;</span>/gfs_*0p25*&quot;</span>)) <br><br><span class="hljs-comment"># Remove files that end with &#x27;.idx&#x27;</span><br>grib_files = [file <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> grib_files <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> file.endswith(<span class="hljs-string">&#x27;.idx&#x27;</span>)]<br><br><span class="hljs-comment"># Remove the first row (first file)</span><br><span class="hljs-keyword">if</span> grib_files:<br>    grib_files = grib_files[<span class="hljs-number">1</span>:<span class="hljs-number">4</span>]<br><br><span class="hljs-comment"># Step 3: Interpolate data for each station across all GRIB files</span><br>results = []<br><br><span class="hljs-comment"># GFS grib file</span><br><span class="hljs-comment"># Coordinates:</span><br><span class="hljs-comment"># * time        (time) datetime64[ns] 824B 2025-02-12 2025-02-12 ... 2025-02-12</span><br><span class="hljs-comment"># step        (time) timedelta64[ns] 824B 0 days 06:00:00 ... 16 days 00:00:00</span><br><span class="hljs-comment"># surface     float64 8B 0.0</span><br><span class="hljs-comment"># * latitude    (latitude) float64 6kB 90.0 89.75 89.5 ... -89.5 -89.75 -90.0</span><br><span class="hljs-comment"># * longitude   (longitude) float64 12kB 0.0 0.25 0.5 0.75 ... 359.2 359.5 359.8</span><br><span class="hljs-comment"># valid_time  (time) datetime64[ns] 824B 2025-02-12T06:00:00 ... 2025-02-28</span><br><br><br><span class="hljs-keyword">for</span> grib_file <span class="hljs-keyword">in</span> grib_files:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Processing: <span class="hljs-subst">&#123;grib_file&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># Step 4: Open the GRIB files using xarray</span><br>    <span class="hljs-comment"># ds = xr.open_mfdataset(grib_files, engine=&#x27;cfgrib&#x27;, combine=&#x27;by_coords&#x27;) #combine=&#x27;nested&#x27;, concat_dim=&quot;time&quot;) # combine=&#x27;by_coords&#x27;)</span><br>    <span class="hljs-comment">#ds = xr.open_dataset(grib_file, engine=&#x27;cfgrib&#x27;, decode_timedelta=True, filter_by_keys=&#123;&#x27;typeOfLevel&#x27;: &#x27;surface&#x27;, &#x27;shortName&#x27;: &#x27;dswrf&#x27;&#125;)</span><br><br>    ds_2t = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;2t&#x27;</span>&#125;)<br>    ds_2r = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;2r&#x27;</span>&#125;) <br><br>    ds_10u = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;10u&#x27;</span>&#125;)<br>    ds_10v = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;10v&#x27;</span>&#125;)<br>    ds_100u = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;100u&#x27;</span>&#125;)<br>    ds_100v = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;100v&#x27;</span>&#125;)<br><br>    ds_20u = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;u&#x27;</span>, <span class="hljs-string">&#x27;typeOfLevel&#x27;</span>: <span class="hljs-string">&#x27;heightAboveGround&#x27;</span>, <span class="hljs-string">&#x27;level&#x27;</span>: <span class="hljs-number">20</span>&#125;)<br>    ds_20v = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;v&#x27;</span>, <span class="hljs-string">&#x27;typeOfLevel&#x27;</span>: <span class="hljs-string">&#x27;heightAboveGround&#x27;</span>, <span class="hljs-string">&#x27;level&#x27;</span>: <span class="hljs-number">20</span>&#125;)<br>    ds_30u = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;u&#x27;</span>, <span class="hljs-string">&#x27;typeOfLevel&#x27;</span>: <span class="hljs-string">&#x27;heightAboveGround&#x27;</span>, <span class="hljs-string">&#x27;level&#x27;</span>: <span class="hljs-number">30</span>&#125;)<br>    ds_30v = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;v&#x27;</span>, <span class="hljs-string">&#x27;typeOfLevel&#x27;</span>: <span class="hljs-string">&#x27;heightAboveGround&#x27;</span>, <span class="hljs-string">&#x27;level&#x27;</span>: <span class="hljs-number">30</span>&#125;)<br>    ds_40u = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;u&#x27;</span>, <span class="hljs-string">&#x27;typeOfLevel&#x27;</span>: <span class="hljs-string">&#x27;heightAboveGround&#x27;</span>, <span class="hljs-string">&#x27;level&#x27;</span>: <span class="hljs-number">40</span>&#125;)<br>    ds_40v = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;v&#x27;</span>, <span class="hljs-string">&#x27;typeOfLevel&#x27;</span>: <span class="hljs-string">&#x27;heightAboveGround&#x27;</span>, <span class="hljs-string">&#x27;level&#x27;</span>: <span class="hljs-number">40</span>&#125;)<br>    ds_50u = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;u&#x27;</span>, <span class="hljs-string">&#x27;typeOfLevel&#x27;</span>: <span class="hljs-string">&#x27;heightAboveGround&#x27;</span>, <span class="hljs-string">&#x27;level&#x27;</span>: <span class="hljs-number">50</span>&#125;)<br>    ds_50v = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;v&#x27;</span>, <span class="hljs-string">&#x27;typeOfLevel&#x27;</span>: <span class="hljs-string">&#x27;heightAboveGround&#x27;</span>, <span class="hljs-string">&#x27;level&#x27;</span>: <span class="hljs-number">50</span>&#125;)<br>    ds_80u = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;u&#x27;</span>, <span class="hljs-string">&#x27;typeOfLevel&#x27;</span>: <span class="hljs-string">&#x27;heightAboveGround&#x27;</span>, <span class="hljs-string">&#x27;level&#x27;</span>: <span class="hljs-number">80</span>&#125;)<br>    ds_80v = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;v&#x27;</span>, <span class="hljs-string">&#x27;typeOfLevel&#x27;</span>: <span class="hljs-string">&#x27;heightAboveGround&#x27;</span>, <span class="hljs-string">&#x27;level&#x27;</span>: <span class="hljs-number">80</span>&#125;)<br><br>    ds_dswrf = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;typeOfLevel&#x27;</span>: <span class="hljs-string">&#x27;surface&#x27;</span>, <span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;dswrf&#x27;</span>&#125;)<br>    ds_sp = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;sp&#x27;</span>&#125;)<br>    ds_hpbl = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;hpbl&#x27;</span>&#125;)<br><br>    ds_vis = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;vis&#x27;</span>, <span class="hljs-string">&#x27;typeOfLevel&#x27;</span>: <span class="hljs-string">&#x27;surface&#x27;</span>&#125;) <span class="hljs-comment"># Visibility [m]</span><br>    ds_cape = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;cape&#x27;</span>, <span class="hljs-string">&#x27;typeOfLevel&#x27;</span>: <span class="hljs-string">&#x27;surface&#x27;</span>&#125;) <span class="hljs-comment"># CAPE Convective Available Potential Energy [J/kg]</span><br>    ds_cin = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>, filter_by_keys=&#123;<span class="hljs-string">&#x27;shortName&#x27;</span>: <span class="hljs-string">&#x27;cin&#x27;</span>, <span class="hljs-string">&#x27;typeOfLevel&#x27;</span>: <span class="hljs-string">&#x27;surface&#x27;</span>&#125;) <span class="hljs-comment"># CIN Convective Inhibition [J/kg]</span><br><br><br>    <span class="hljs-comment">#print(ds_2r)</span><br>    <span class="hljs-comment">#exit()</span><br>    <span class="hljs-comment">## Print the names of the variables</span><br>    <span class="hljs-comment"># print(ds_2t)</span><br>    <span class="hljs-comment"># selected_time = ds_2t.time.values # It is initial time!!</span><br>    selected_time = ds_2t.valid_time.values <span class="hljs-comment"># It is valid time</span><br>    <span class="hljs-comment">## Assuming selected_time_utc is in numpy datetime64 format</span><br>    selected_time_utc = pd.to_datetime(selected_time)  <span class="hljs-comment"># Convert to pandas datetime</span><br>    selected_time_utc_plus_8 = selected_time_utc + pd.Timedelta(hours=<span class="hljs-number">8</span>)  <span class="hljs-comment"># Add 8 hours</span><br><br>    <span class="hljs-built_in">print</span>(selected_time)<br><br>    <span class="hljs-comment"># Step 5: Extract data for each station</span><br>    <span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> stations.iterrows():<br>        lat = row[<span class="hljs-string">&#x27;latitude&#x27;</span>]<br>        lon = row[<span class="hljs-string">&#x27;longitude&#x27;</span>]<br>        <br>        <span class="hljs-comment"># Step 6: Interpolate the data using bilinear interpolation</span><br>        t2m = check_assign(ds_2t, <span class="hljs-string">&#x27;t2m&#x27;</span>, lat, lon) - <span class="hljs-number">273.15</span>        <span class="hljs-comment"># var name = t2m</span><br>        r2m = check_assign(ds_2r, <span class="hljs-string">&#x27;r2&#x27;</span>, lat, lon)                  <span class="hljs-comment"># var name = r2</span><br>        u10 = check_assign(ds_10u, <span class="hljs-string">&#x27;u10&#x27;</span>, lat, lon)<br>        v10 = check_assign(ds_10v, <span class="hljs-string">&#x27;v10&#x27;</span>, lat, lon)<br>        u80 = check_assign(ds_80u, <span class="hljs-string">&#x27;u&#x27;</span>, lat, lon)<br>        v80 = check_assign(ds_80v, <span class="hljs-string">&#x27;v&#x27;</span>, lat, lon)<br>        u100 = check_assign(ds_100u, <span class="hljs-string">&#x27;u100&#x27;</span>, lat, lon)<br>        v100 = check_assign(ds_100v, <span class="hljs-string">&#x27;v100&#x27;</span>, lat, lon)<br>        dswrf = check_assign(ds_dswrf, <span class="hljs-string">&#x27;dswrf&#x27;</span>, lat, lon)<br>        hpbl = check_assign(ds_hpbl, <span class="hljs-string">&#x27;hpbl&#x27;</span>, lat, lon)<br>        vis = check_assign(ds_vis, <span class="hljs-string">&#x27;vis&#x27;</span>, lat, lon)<br>        <br>        <span class="hljs-comment"># Step 7: Append the results</span><br>        results.append(&#123;<br>            <span class="hljs-string">&#x27;station&#x27;</span>: row[<span class="hljs-string">&#x27;station&#x27;</span>],<br>            <span class="hljs-string">&#x27;datetime[UTC]&#x27;</span>: selected_time_utc,<br>            <span class="hljs-string">&#x27;datetime[BJT]&#x27;</span>: selected_time_utc_plus_8,<br>            <span class="hljs-string">&#x27;t2m[degC]&#x27;</span>: t2m,<br>            <span class="hljs-string">&#x27;r2m[%]&#x27;</span>: r2m,<br>            <span class="hljs-string">&#x27;u10[m/s]&#x27;</span>: u10,<br>            <span class="hljs-string">&#x27;v10[m/s]&#x27;</span>: v10,<br>            <span class="hljs-string">&#x27;ws10[m/s]&#x27;</span>: np.sqrt(u10**<span class="hljs-number">2</span> + u10**<span class="hljs-number">2</span>),<br>            <span class="hljs-string">&#x27;wd10[deg]&#x27;</span>: calculate_wind_direction(u10, v10),<br>            <span class="hljs-string">&#x27;ws80[m/s]&#x27;</span>: np.sqrt(u80**<span class="hljs-number">2</span> + u80**<span class="hljs-number">2</span>),<br>            <span class="hljs-string">&#x27;wd80[deg]&#x27;</span>: calculate_wind_direction(u80, v80),<br>            <span class="hljs-string">&#x27;ws100[m/s]&#x27;</span>: np.sqrt(u100**<span class="hljs-number">2</span> + u100**<span class="hljs-number">2</span>),<br>            <span class="hljs-string">&#x27;wd100[deg]&#x27;</span>: calculate_wind_direction(u100, v100),<br>            <span class="hljs-string">&#x27;dswrf[W/m2]&#x27;</span>: dswrf,<br>            <span class="hljs-string">&#x27;hpbl[m]&#x27;</span>: hpbl,<br>            <span class="hljs-string">&#x27;vis[m]&#x27;</span>: vis,<br>        &#125;)<br><br><span class="hljs-comment"># Step 8: Create a DataFrame from the results</span><br>output_df = pd.DataFrame(results)<br><br><span class="hljs-comment"># Step 9: Save the results to a CSV file</span><br>output_df.to_csv(<span class="hljs-string">f&#x27;GFS_<span class="hljs-subst">&#123;yyyymm&#125;</span><span class="hljs-subst">&#123;dd&#125;</span>.csv&#x27;</span>, index=<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<h2 id="step-3-run-the-script">Step 3: Run the Script</h2>
<ol type="1">
<li>Make sure to replace <code>'path_to_your_file.grib2'</code> with the actual path to your GRIB file.</li>
<li>Save the script to a <code>.py</code> file and run it using Python.</li>
</ol>
<h2 id="output">Output</h2>
<p>The output will be a CSV file named <code>output.csv</code> with the following columns:</p>
<ul>
<li><code>station</code></li>
<li><code>t2m</code> (Temperature at 2m)</li>
<li><code>u10</code> (U-component of wind at 10m)</li>
<li><code>v10</code> (V-component of wind at 10m)</li>
<li><code>rh2m</code> (Relative humidity at 2m)</li>
<li><code>sdswrf</code> (The surface downward shortwave radiation flux)</li>
</ul>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs console"><span class="hljs-meta prompt_"> $ </span><span class="language-bash"><span class="hljs-built_in">cat</span> output.csv</span> <br>station,sdswrf<br>Station1,52.232960662841684<br>Station2,47.779839172363275<br></code></pre></td></tr></table></figure>
<h2 id="note">Note</h2>
<ul>
<li>Ensure that the indices for <code>t2m</code>, <code>u10</code>, <code>v10</code>, <code>rh2m</code>, and <code>sdswrf</code> are correctly set according to how your GRIB data is structured.</li>
<li>You may need to adjust the extraction logic based on the specific GRIB messages you are working with.</li>
</ul>
<h1 id="read-multiple-gfs-grib-files">Read Multiple GFS grib files</h1>
<h2 id="code-to-extract-data-and-save-to-csv">Code to Extract Data and Save to CSV</h2>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-4f34dce5" role="button" aria-expanded="false" aria-controls="collapse-4f34dce5">
        <div class="fold-arrow">▶</div>extract_GFS_multiple.py
      </div>
      <div class="fold-collapse collapse" id="collapse-4f34dce5">
        <div class="fold-content">
          <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/bin/python</span><br><br><span class="hljs-comment">#------------------------------------------------#</span><br><span class="hljs-comment">#Author:         wpsze</span><br><span class="hljs-comment">#Email：         wpsze</span><br><span class="hljs-comment">#date:           2025-02-19 14:29:21</span><br><span class="hljs-comment">#Version:        0.0 </span><br><span class="hljs-comment">#Description:    The purpose of the script</span><br><span class="hljs-comment">#Copyright (C)： 2025 All rights reserved</span><br><span class="hljs-comment">#------------------------------------------------#</span><br><br><span class="hljs-keyword">import</span> xarray <span class="hljs-keyword">as</span> xr<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> glob<br><br><span class="hljs-comment"># Step 1: Load the station data</span><br>stations = pd.read_csv(<span class="hljs-string">&#x27;station.csv&#x27;</span>)<br><br><span class="hljs-comment"># Step 2: Get and sort the list of GFS GRIB files</span><br>grib_files = <span class="hljs-built_in">sorted</span>(glob.glob(<span class="hljs-string">&#x27;./subset-GFS/gfs.0p25.2025021200.f*.grib2&#x27;</span>) )  <span class="hljs-comment"># Adjust the path and pattern</span><br><br><span class="hljs-comment"># Step 3: Interpolate data for each station across all GRIB files</span><br>results = []<br><br><span class="hljs-comment"># GFS grib file</span><br><span class="hljs-comment"># Coordinates:</span><br><span class="hljs-comment"># * time        (time) datetime64[ns] 824B 2025-02-12 2025-02-12 ... 2025-02-12</span><br><span class="hljs-comment"># step        (time) timedelta64[ns] 824B 0 days 06:00:00 ... 16 days 00:00:00</span><br><span class="hljs-comment"># surface     float64 8B 0.0</span><br><span class="hljs-comment"># * latitude    (latitude) float64 6kB 90.0 89.75 89.5 ... -89.5 -89.75 -90.0</span><br><span class="hljs-comment"># * longitude   (longitude) float64 12kB 0.0 0.25 0.5 0.75 ... 359.2 359.5 359.8</span><br><span class="hljs-comment"># valid_time  (time) datetime64[ns] 824B 2025-02-12T06:00:00 ... 2025-02-28</span><br><br><br><span class="hljs-keyword">for</span> grib_file <span class="hljs-keyword">in</span> grib_files:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Processing: <span class="hljs-subst">&#123;grib_file&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># Step 4: Open the GRIB files using xarray</span><br>    <span class="hljs-comment"># ds = xr.open_mfdataset(grib_files, engine=&#x27;cfgrib&#x27;, combine=&#x27;by_coords&#x27;) #combine=&#x27;nested&#x27;, concat_dim=&quot;time&quot;) # combine=&#x27;by_coords&#x27;)</span><br>    ds = xr.open_dataset(grib_file, engine=<span class="hljs-string">&#x27;cfgrib&#x27;</span>, decode_timedelta=<span class="hljs-literal">True</span>) <span class="hljs-comment">#,backend_kwargs=&#123;&#x27;filter_by_keys&#x27;: &#123;&#x27;typeOfLevel&#x27;: &#x27;isobaricInhPa&#x27;&#125;&#125;)</span><br><br>    <span class="hljs-comment">## Print the names of the variables</span><br>    <span class="hljs-comment"># print(ds)</span><br>    <span class="hljs-comment"># selected_time = ds.time.values # It is initial time!!</span><br>    selected_time = ds.valid_time.values <span class="hljs-comment"># It is valid time</span><br>    <span class="hljs-comment">## Assuming selected_time_utc is in numpy datetime64 format</span><br>    selected_time_utc = pd.to_datetime(selected_time)  <span class="hljs-comment"># Convert to pandas datetime</span><br>    selected_time_utc_plus_8 = selected_time_utc + pd.Timedelta(hours=<span class="hljs-number">8</span>)  <span class="hljs-comment"># Add 8 hours</span><br><br>    <span class="hljs-built_in">print</span>(selected_time)<br><br>    <span class="hljs-comment"># Step 5: Extract data for each station</span><br>    <span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> stations.iterrows():<br>        lat = row[<span class="hljs-string">&#x27;latitude&#x27;</span>]<br>        lon = row[<span class="hljs-string">&#x27;longitude&#x27;</span>]<br>        <br>        <span class="hljs-comment"># Step 6: Interpolate the data using bilinear interpolation</span><br>        <span class="hljs-comment"># t2m = ds[&#x27;t2m&#x27;].interp(latitude=lat, longitude=lon, method=&#x27;linear&#x27;).values</span><br>        <span class="hljs-comment"># u10 = ds[&#x27;u10&#x27;].interp(latitude=lat, longitude=lon, method=&#x27;linear&#x27;).values</span><br>        <span class="hljs-comment"># v10 = ds[&#x27;v10&#x27;].interp(latitude=lat, longitude=lon, method=&#x27;linear&#x27;).values</span><br>        <span class="hljs-comment"># rh2m = ds[&#x27;rh2m&#x27;].interp(latitude=lat, longitude=lon, method=&#x27;linear&#x27;).values</span><br>        sdswrf = ds[<span class="hljs-string">&#x27;sdswrf&#x27;</span>].interp(latitude=lat, longitude=lon, method=<span class="hljs-string">&#x27;linear&#x27;</span>).values<br>        <br>        <span class="hljs-comment"># Step 7: Append the results</span><br>        results.append(&#123;<br>            <span class="hljs-string">&#x27;station&#x27;</span>: row[<span class="hljs-string">&#x27;station&#x27;</span>],<br>            <span class="hljs-string">&#x27;datetime&#x27;</span>: selected_time,<br>            <span class="hljs-string">&#x27;sdswrf&#x27;</span>: sdswrf<br>            <span class="hljs-comment"># &#x27;t2m&#x27;: t2m,</span><br>            <span class="hljs-comment"># &#x27;u10&#x27;: u10,</span><br>            <span class="hljs-comment"># &#x27;v10&#x27;: v10,</span><br>            <span class="hljs-comment"># &#x27;rh2m&#x27;: rh2m</span><br>        &#125;)<br><br><span class="hljs-comment"># Step 8: Create a DataFrame from the results</span><br>output_df = pd.DataFrame(results)<br><br><span class="hljs-comment"># Step 9: Save the results to a CSV file</span><br>output_df.to_csv(<span class="hljs-string">&#x27;output_multiple.csv&#x27;</span>, index=<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<h2 id="output-1">Output</h2>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-05b78603" role="button" aria-expanded="false" aria-controls="collapse-05b78603">
        <div class="fold-arrow">▶</div>output_multiple.csv
      </div>
      <div class="fold-collapse collapse" id="collapse-05b78603">
        <div class="fold-content">
          <figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs console">station,datetime[UTC],datetime[BJT],sdswrf<br>Station1,2025-02-12 06:00:00,2025-02-12 14:00:00,52.232960662841684<br>Station2,2025-02-12 06:00:00,2025-02-12 14:00:00,47.779839172363275<br>Station1,2025-02-12 09:00:00,2025-02-12 17:00:00,62.86639785766609<br>Station2,2025-02-12 09:00:00,2025-02-12 17:00:00,40.13679992675776<br>Station1,2025-02-12 12:00:00,2025-02-12 20:00:00,33.28959899902347<br>Station2,2025-02-12 12:00:00,2025-02-12 20:00:00,22.780800170898374<br>Station1,2025-02-12 15:00:00,2025-02-12 23:00:00,0.0<br>Station2,2025-02-12 15:00:00,2025-02-12 23:00:00,0.0<br>Station1,2025-02-12 18:00:00,2025-02-13 02:00:00,0.0<br>Station2,2025-02-12 18:00:00,2025-02-13 02:00:00,0.0<br>Station1,2025-02-12 21:00:00,2025-02-13 05:00:00,0.0<br>Station2,2025-02-12 21:00:00,2025-02-13 05:00:00,0.0<br>Station1,2025-02-13 00:00:00,2025-02-13 08:00:00,2.2220799827575504<br>Station2,2025-02-13 00:00:00,2025-02-13 08:00:00,3.2377599430084407<br>Station1,2025-02-13 03:00:00,2025-02-13 11:00:00,146.60479980468722<br>Station2,2025-02-13 03:00:00,2025-02-13 11:00:00,215.17280273437623<br>Station1,2025-02-13 06:00:00,2025-02-13 14:00:00,154.97856079101527<br>Station2,2025-02-13 06:00:00,2025-02-13 14:00:00,259.47327941894736<br>Station1,2025-02-13 09:00:00,2025-02-13 17:00:00,137.50800354003917<br>......<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<h1 id="xarrays-interp-method-with-the-linear-option-on-a-2d-array"><code>xarray</code>'s <code>interp</code> method with the <code>"linear"</code> option on a 2D array</h1>
<p>When using <code>xarray</code>'s <code>interp</code> method with the <code>"linear"</code> option on a 2D array, the method performs linear interpolation along the specified dimensions. This allows you to compute interpolated values at new coordinate points based on existing data in two dimensions.</p>
<h3 id="how-it-works-for-2d-arrays">How It Works for 2D Arrays</h3>
<ol type="1">
<li><strong>Data Structure</strong>: A 2D array in <code>xarray</code> is typically represented as a <code>DataArray</code> or a <code>Dataset</code>, where you have two dimensions (e.g., latitude and longitude, or time and another variable).</li>
<li><strong>Linear Interpolation</strong>: The <code>"linear"</code> method calculates the interpolated values by creating linear relationships between existing data points. For each new coordinate point specified, it finds the nearest surrounding points in both dimensions and computes the interpolated value based on the linear ratio of the distances.</li>
</ol>
<ul>
<li>For each new coordinate:
<ul>
<li>The method identifies the surrounding points in the original 2D array.</li>
<li>It calculates the interpolated value based on the linear relationship between the values at these surrounding points.</li>
<li>The interpolation is done separately for each dimension, effectively creating a <strong>bilinear interpolation effect</strong>.</li>
</ul></li>
<li><strong>2D Linear Interpolation</strong>: The <code>"linear"</code> method allows you to compute intermediate values smoothly between known data points in a 2D grid.</li>
<li><strong>Applications</strong>: This is useful in various fields such as geospatial analysis, climate modeling, and any scenario where a grid of values needs to be estimated at non-integer coordinates.</li>
</ul>
<p>Using <code>xarray</code>'s <code>interp</code> method in this way enables effective handling of multi-dimensional datasets, ensuring accurate and smooth transitions between data points.</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/MPAS/" class="category-chain-item">MPAS</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/WRF/" class="print-no-link">#WRF</a>
      
        <a href="/tags/MPAS/" class="print-no-link">#MPAS</a>
      
        <a href="/tags/NWP/" class="print-no-link">#NWP</a>
      
        <a href="/tags/ERA5/" class="print-no-link">#ERA5</a>
      
        <a href="/tags/GFS/" class="print-no-link">#GFS</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>MPAS | WRF | Extract subset of GFS GRIB files</div>
      <div>https://waipangsze.github.io/2025/02/19/MPAS-WRF-Extract-GFS-GRIB-files/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>wpsze</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>February 19, 2025</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Updated on</div>
          <div>October 16, 2025</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/02/20/MPAS-WRF-Atmospheric-radiative-transfer/" title="MPAS | WRF | Atmospheric radiative transfer">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">MPAS | WRF | Atmospheric radiative transfer</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/02/18/WRF-MPAS-UCM-Urban-canopy-parameters-UCPs/" title="WRF | MPAS | UCM Urban canopy parameters (UCPs)">
                        <span class="hidden-mobile">WRF | MPAS | UCM Urban canopy parameters (UCPs)</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9HL36SZ28R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9HL36SZ28R');
</script>

    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">

  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  

  <span id="sitetime"></span>
  <script language=javascript>
    function siteTime(){
      window.setTimeout("siteTime()", 1000);
      var seconds = 1000;
      var minutes = seconds * 60;
      var hours = minutes * 60;
      var days = hours * 24;
      var years = days * 365;
      var today = new Date();
      var todayYear = today.getFullYear();
      var todayMonth = today.getMonth()+1;
      var todayDate = today.getDate();
      var todayHour = today.getHours();
      var todayMinute = today.getMinutes();
      var todaySecond = today.getSeconds();
      /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
      year - 作为date对象的年份，为4位年份值
      month - 0-11之间的整数，做为date对象的月份
      day - 1-31之间的整数，做为date对象的天数
      hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
      minutes - 0-59之间的整数，做为date对象的分钟数
      seconds - 0-59之间的整数，做为date对象的秒数
      microseconds - 0-999之间的整数，做为date对象的毫秒数 */
      var t1 = Date.UTC(2023,04,23,00,00,00); //北京时间2018-2-13 00:00:00
      var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
      var diff = t2-t1;
      var diffYears = Math.floor(diff/years);
      var diffDays = Math.floor((diff/days)-diffYears*365);
      var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
      var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
      var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
      /*document.getElementById("sitetime").innerHTML=" 已运行"+/*diffYears+" 年 "+*/diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
      document.getElementById("sitetime").innerHTML=" 已運行"+diffYears+" 年 "+diffDays+" 天 ";
    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
  </script>
  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
