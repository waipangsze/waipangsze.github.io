

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="wpsze">
  <meta name="keywords" content="">
  
    <meta name="description" content="中國氣象局（China Meteorological Administration，縮寫：CMA），是中華人民共和國國務院負責氣象行政管理與科學研究的副部級直屬事業單位。 CMA-GFS (原名为GRAPES-GFS) 作为我国自主研发的新一代全球数值预报模式，从初始场、变分同化、模式框架等核心技术均实现了自主化。CMA-GFS全球模式从2001年开始组织数值预报团队启动研发，2016年实现业务化">
<meta property="og:type" content="article">
<meta property="og:title" content="NWP | CMA | CMA_GFS real time data">
<meta property="og:url" content="https://waipangsze.github.io/2025/04/02/NWP-CMA-CMA_GFS-real-time-data/index.html">
<meta property="og:site_name" content="wpsze">
<meta property="og:description" content="中國氣象局（China Meteorological Administration，縮寫：CMA），是中華人民共和國國務院負責氣象行政管理與科學研究的副部級直屬事業單位。 CMA-GFS (原名为GRAPES-GFS) 作为我国自主研发的新一代全球数值预报模式，从初始场、变分同化、模式框架等核心技术均实现了自主化。CMA-GFS全球模式从2001年开始组织数值预报团队启动研发，2016年实现业务化">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.imgur.com/TtrCqKa.png">
<meta property="article:published_time" content="2025-04-02T08:15:00.000Z">
<meta property="article:modified_time" content="2025-04-23T01:10:40.202Z">
<meta property="article:author" content="wpsze">
<meta property="article:tag" content="NWP">
<meta property="article:tag" content="MPAS">
<meta property="article:tag" content="WRF">
<meta property="article:tag" content="CMA">
<meta property="article:tag" content="CMA_GFS">
<meta property="article:tag" content="Land-sea mask">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.imgur.com/TtrCqKa.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>NWP | CMA | CMA_GFS real time data - wpsze</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"waipangsze.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":"F7MK-FcxSomhtc1N3hIUDA"},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=F7MK-FcxSomhtc1N3hIUDA", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', 'F7MK-FcxSomhtc1N3hIUDA');
        });
      }
    </script>
  

  

  

  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>wpsze</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>Links</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/bookmark/" target="_self">
                <i class="iconfont icon-bookmark"></i>
                <span>Bookmarks</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                <span>Docs</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Physics/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Physics</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Maths/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Maths</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/CFD/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>CFD</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/ML/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>ML</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Meteorology/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Meteorology</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/MPAS/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>MPAS</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/monitor/" target="_self">
                    
                    <span>Real Time Monitoring</span>
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About Me</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://i.imgur.com/TtrCqKa.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="NWP | CMA | CMA_GFS real time data"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-04-02 16:15" pubdate>
          April 2, 2025 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          3k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          25 mins
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> views
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">NWP | CMA | CMA_GFS real time data</h1>
            
            
              <div class="markdown-body">
                
                <p><strong>中國氣象局（China Meteorological Administration，縮寫：CMA）</strong>，是中華人民共和國國務院負責氣象行政管理與科學研究的副部級直屬事業單位。</p>
<p><strong>CMA-GFS (原名为GRAPES-GFS)</strong> 作为我国自主研发的新一代全球数值预报模式，从初始场、变分同化、模式框架等核心技术均实现了自主化。CMA-GFS全球模式从2001年开始组织数值预报团队启动研发，2016年实现业务化并面向全国下发产品。该模式每天运行4次，分别是00、06、12、18 UTC，时间分辨率为3小时，空间分辨率为0.25˚ × 0.25˚，预报时长为10天(240小时)，提供了全球基础要素场和诊断要素场，基础要素场主要包括各层次的高度场、温度场、东西风场、湿度场、比湿场、露点场及海平面气压场、10 m东西风场、2 m温度场、2 m比湿场、2 m露点场、降水量等，诊断要素场主要包括10 m阵风、能量指数、最高最低温度、云量及各层次的涡度散度、垂直速度及相当位温等。</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=108570&amp;extra=page%3D1&amp;page=1">CMA-MESO 3km的模式预报场能作为WRF的初始场吗？ | 2023-8-11</a>
<ul>
<li>等压面数据用CMA MESO 预报场，地面数据用CLDAS网格产品可以吗WPS里的Vtable没有现成的选项，有考虑自己写Vtable文件</li>
<li>我知道<strong>GRAPES-GFS全球版本可以</strong>，中尺度版本可能与这个不同。</li>
<li>这是全球版本数据：<a target="_blank" rel="noopener" href="http://data.wis.cma.cn/DCPC_WMC_BJ/open/nwp/" class="uri">http://data.wis.cma.cn/DCPC_WMC_BJ/open/nwp/</a></li>
<li><strong>CMA-GFS成功了，但是分辨率不够</strong>，我又用了CALMET降尺度，<strong>用 CMA-GFS的话 改Vtable文件 就可以</strong>，MESO数据缺很多土壤数据</li>
<li>不好意思，我的 Vtable文件是老师给的，不能外传，<strong>你可以用python读取grib文件信息对应修改一下，改Vtable.ECWMF就可以</strong></li>
</ul></li>
<li>Github
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/wrf-model/WPS/pull/236">Adding support for CMA-GFS in WPS | Oct 10, 2023</a></li>
<li>The CMA-GFS grib2 datasets is now able to be ingested by the ungrib program. The GRAPES_GFS(here in after referred to as CMA_GFS), the new generation of Global/Regional Assimilation and Prediction Enhanced System which is independently developped by China Meteorological Administration (CMA), has been put into formal operation. So we are committed to solving the problem of WPS correctly handling CMA_GFS forecast data.</li>
<li>one <code>Vtable files(Vtable.CMA_GFS)</code> has been created with the fields required by the WRF model. Modifications to the ungrib source code: <strong>Adding support for code 738</strong> in <code>rd_grid2.F</code> because model levels of CMA_GFS are on generalized vertical height coordinates.</li>
<li>The <strong>CMA_GFS real time data is here</strong>: <a target="_blank" rel="noopener" href="http://data.wis.cma.cn/DCPC_WMC_BJ/open/nwp/gmf_gra/" class="uri">http://data.wis.cma.cn/DCPC_WMC_BJ/open/nwp/gmf_gra/</a></li>
<li><strong>I've tested the program with an Intel compiler and it passed without errors. CMA_GFS forecast data were also used to test, the results are normal.</strong></li>
<li>[<em>Dec 22, 2024</em>] These changes permit ungribbing of the CMA model output. <strong>Tests on derecho were successful</strong>. <strong>Note that the global CMA output files are very large and time-consuming to download</strong>.</li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzI2NTk2MzU3NA==&amp;mid=2247485543&amp;idx=1&amp;sn=e4155bbc8ee16350c57dbf733e3d2386&amp;chksm=ea94193edde39028ec6ec2ecfd5095521c6d1e0a627357bcc8a67ca093c2e462d01ff4a1660e&amp;scene=178&amp;cur_album_id=2858702555684864004#rd">WRF基础 | CMA-GFS运行WRF | Jan 2025</a></li>
</ul>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-8f7bdefe" role="button" aria-expanded="false" aria-controls="collapse-8f7bdefe">
        <div class="fold-arrow">▶</div>rd_grib2.F
      </div>
      <div class="fold-collapse collapse" id="collapse-8f7bdefe">
        <div class="fold-content">
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs rd_grib2.F">line 738:  &amp;               (gfld%ipdtmpl(1) .eq. g2code(2,j)) .and.  !! Added by Dr.Haiqing SONG, 20181201<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-dcdac752" role="button" aria-expanded="false" aria-controls="collapse-dcdac752">
        <div class="fold-arrow">▶</div>Vtable.CMA_GFS
      </div>
      <div class="fold-collapse collapse" id="collapse-dcdac752">
        <div class="fold-content">
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs Vtable.CMA_GFS">GRIB1| Level| From |  To  | metgrid  | metgrid | metgrid                                 |GRIB2|GRIB2|GRIB2|GRIB2|<br>Param| Type |Level1|Level2| Name     | Units   | Description                             |Discp|Catgy|Param|Level|<br>-----+------+------+------+----------+---------+-----------------------------------------+-----------------------+<br>  11 | 100  |   *  |      | TT       | K       | Temperature                             |  0  |  0  |  0  | 100 |<br>  33 | 100  |   *  |      | UU       | m s-1   | U                                       |  0  |  2  |  2  | 100 |<br>  34 | 100  |   *  |      | VV       | m s-1   | V                                       |  0  |  2  |  3  | 100 |<br>  52 | 100  |   *  |      | RH       | %       | Relative Humidity                       |  0  |  1  |  1  | 100 |<br>   7 | 100  |   *  |      | HGT      | m       | Height                                  |  0  |  3  |  5  | 100 |<br>  11 | 105  |   2  |      | TT       | K       | Temperature       at 2 m                |  0  |  0  |  0  | 103 |<br>  52 | 105  |   2  |      | RH       | %       | Relative Humidity at 2 m                |  0  |  1  |  1  | 103 |<br>  33 | 105  |  10  |      | UU       | m s-1   | U                 at 10 m               |  0  |  2  |  2  | 103 |<br>  34 | 105  |  10  |      | VV       | m s-1   | V                 at 10 m               |  0  |  2  |  3  | 103 |<br>   1 |   1  |   0  |      | PSFC     | Pa      | Surface Pressure                        |  0  |  3  |  0  |   1 |<br>   2 | 102  |   0  |      | PMSL     | Pa      | Sea-level Pressure                      |  0  |  3  |  1  | 101 |<br> 144 | 112  |   0  |  10  | SM000010 | fraction| Soil Moist 0-10 cm below grn layer (Up) |  0  |  1  |  0  | 106 |<br> 144 | 112  |  10  |  40  | SM010040 | fraction| Soil Moist 10-40 cm below grn layer     |  0  |  1  |  0  | 106 |<br> 144 | 112  |  40  | 100  | SM040100 | fraction| Soil Moist 40-100 cm below grn layer    |  0  |  1  |  0  | 106 |<br> 144 | 112  | 100  | 200  | SM100200 | fraction| Soil Moist 100-200 cm below gr layer    |  0  |  1  |  0  | 106 |<br>  85 | 112  |   0  |  10  | ST000010 | K       | T 0-10 cm below ground layer (Upper)    |  0  |  0  |  0  | 106 |<br>  85 | 112  |  10  |  40  | ST010040 | K       | T 10-40 cm below ground layer (Upper)   |  0  |  0  |  0  | 106 |<br>  85 | 112  |  40  | 100  | ST040100 | K       | T 40-100 cm below ground layer (Upper)  |  0  |  0  |  0  | 106 |<br>  85 | 112  | 100  | 200  | ST100200 | K       | T 100-200 cm below ground layer (Bottom)|  0  |  0  |  0  | 106 |<br>  11 |   1  |   0  |      | SKINTEMP | K       | Skin temperature                        |  0  |  0  |  0  |   1 |<br>   7 |   1  |   0  |      | SOILHGT  | m       | Terrain field of source analysis        |  0  |  3  |  5  |   1 |<br>  81 |   1  |   0  |      | LANDSEA  | proprtn | Land/Sea flag (1=land, 0 or 2=sea)      |  2  |  0  |  0  |   1 |<br>  65 |   1  |   0  |      | SNOW     | kg m-2  | Water equivalent snow depth             |  0  |  1  | 13  |   1 |<br>     |   1  |   0  |      | SNOWH    | m       | Physical Snow Depth                     |  0  |  1  |     |   1 |<br>  33 |   6  |   0  |      | UMAXW    | m s-1   | U                 at max wind           |  0  |  2  |  2  |   6 |<br>  34 |   6  |   0  |      | VMAXW    | m s-1   | V                 at max wind           |  0  |  2  |  3  |   6 |<br>   2 |   6  |   0  |      | PMAXW    | Pa      | Pressure of max wind level              |  0  |  3  |  0  |   6 |<br>     |   6  |   0  |      | PMAXWNN  | Pa      | PMAXW, used for nearest neighbor interp |  0  |  3  |  0  |   6 |<br>   2 |   6  |   0  |      | TMAXW    | K       | Temperature at max wind level           |  0  |  0  |  0  |   6 |<br>   7 |   6  |   0  |      | HGTMAXW  | m       | Height of max wind level                |  0  |  3  |  5  |   6 |<br>  33 |   7  |   0  |      | UTROP    | m s-1   | U                 at tropopause         |  0  |  2  |  2  |   7 |<br>  34 |   7  |   0  |      | VTROP    | m s-1   | V                 at tropopause         |  0  |  2  |  3  |   7 |<br>   2 |   7  |   0  |      | PTROP    | Pa      | Pressure of tropopause                  |  0  |  3  |  0  |   7 |<br>     |   7  |   0  |      | PTROPNN  | Pa      | PTROP, used for nearest neighbor interp |  0  |  3  |  0  |   7 |<br>   2 |   7  |   0  |      | TTROP    | K       | Temperature at tropopause               |  0  |  0  |  0  |   7 |<br>   7 |   7  |   0  |      | HGTTROP  | m       | Height of tropopause                    |  0  |  3  |  5  |   7 |<br>-----+------+------+------+----------+---------+-----------------------------------------+-----------------------+<br>#  This Vtable was created for CMA/CMA_GFS model data from the CMA server.(http://cemc.cma.cn/intro.html?idx=1)<br>#  The GRAPES_GFS(here in after referred to as CMA_GFS), the new generation of Global/Regional Assimilation and Prediction Enhanced System<br>#  which is independently developped by China Meteorological Administration (CMA), has been put into formal operation.<br>#  The data was accesed from:http://data.wis.cma.cn/DCPC_WMC_BJ/open/nwp/gmf_gra/thh00/    (note hh at end)<br>#  Developed by Dr. Haiqing SONG from Inner Mongolia Meteorological Service of China Meteorological Administration(CMA).<br>#  E-mail:haiqingsong@emails.imau.edu.cn<br>#  wgrib2 -var filename.grib2<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<h1 id="cma">CMA</h1>
<p>数据介绍</p>
<p>CMA-GFS 是我国自主研发的新一代全球数值预报模式，该模式由同化分系统和全球模式分系统两部分组成，于2016年6月业务化运行，向全国实时分发产品。2018年7月四维变分同化实现业务运行。2020年CMA-GFS升级为3.0，模式水平分辨率为25km，模式层顶0.1hPa，垂直分层87层。2022年CMA-GFS升级为3.3版本。2023年CMA-GFS升级为4.0版本</p>
<figure>
<img src="https://i.imgur.com/KDTgahf.png" srcset="/img/loading.gif" lazyload alt="https://data.cma.cn/data/detail/dataCode/F.0003.0008.S001.html" width="400" /><figcaption>https://data.cma.cn/data/detail/dataCode/F.0003.0008.S001.html</figcaption>
</figure>
<h2 id="httpdata.wis.cma.cndcpc_wmc_bjopennwpgmf_gra">http://data.wis.cma.cn/DCPC_WMC_BJ/open/nwp/gmf_gra/</h2>
<ul>
<li>Index of /DCPC_WMC_BJ/open/nwp/gmf_gra/</li>
</ul>
<p><img src="https://i.imgur.com/H9MM6QW.png" srcset="/img/loading.gif" lazyload width="500" /></p>
<h1 id="grib2-file">grib2 file</h1>
<ul>
<li><code>./g2print.exe Z_NAFP_C_BABJ_20250112000000_P_NWPC-GRAPES-GFS-GLB-00000.grib2</code></li>
</ul>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-6ae3e036" role="button" aria-expanded="false" aria-controls="collapse-6ae3e036">
        <div class="fold-arrow">▶</div>log
      </div>
      <div class="fold-collapse collapse" id="collapse-6ae3e036">
        <div class="fold-content">
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><code class="hljs log"> ungrib - grib edition num           2<br> reading from grib file = Z_NAFP_C_BABJ_20250112000000_P_NWPC-GRAPES-GFS-GLB-00000.grib2                                                          <br>      unknown model and orig center   <br>---------------------------------------------------------------------------------------<br> rec Prod Cat Param  Lvl    Lvl      Lvl     Prod    Name            Time          Fcst<br> num Disc     num    code   one      two     Templ                                 hour<br>---------------------------------------------------------------------------------------<br>   1   0    1  10       1       0       0       8     ACPCP    2025-01-12_00:00:00   00  PDT4.8  <br>   2   0    1   9       1       0       0       8     NCPCP    2025-01-12_00:00:00   00  PDT4.8  <br>   3   0    1   8       1       0       0       8     APCP     2025-01-12_00:00:00   00  PDT4.8  <br>   4   0    1  29       1       0       0       8     ASNOW    2025-01-12_00:00:00   00  PDT4.8  <br>   5   0    0   0       1       0       0       0     TMP      2025-01-12_00:00:00   00          <br>   6   0    5   5       1       0       0       8     UNKNOWN  2025-01-12_00:00:00   00  PDT4.8  <br>   7   0    4   9       1       0       0       8     UNKNOWN  2025-01-12_00:00:00   00  PDT4.8  <br>   8   2    0  24       1       0       0       8     UNKNOWN  2025-01-12_00:00:00   00  PDT4.8  <br>   9   0    0  10       1       0       0       8     LHTFL    2025-01-12_00:00:00   00  PDT4.8  <br>  10   0    5   4       1       0       0       8     ULWRF    2025-01-12_00:00:00   00  PDT4.8  <br>  11   0    5   4       8********       0       8     ULWRF    2025-01-12_00:00:00   00  PDT4.8  <br>  12   0    5   8       1       0       0       8     UNKNOWN  2025-01-12_00:00:00   00  PDT4.8  <br>  13   0    5 224       1       0       0       8     UNKNOWN  2025-01-12_00:00:00   00  PDT4.8  <br>  14   0    5 224       8********       0       8     UNKNOWN  2025-01-12_00:00:00   00  PDT4.8  <br>  15   0    4   8       1       0       0       8     USWRF    2025-01-12_00:00:00   00  PDT4.8  <br>  16   0    4   9       8********       0       8     UNKNOWN  2025-01-12_00:00:00   00  PDT4.8  <br>  17   0    4   8       8********       0       8     USWRF    2025-01-12_00:00:00   00  PDT4.8  <br>  18   0    4  11       1       0       0       8     UNKNOWN  2025-01-12_00:00:00   00  PDT4.8  <br>  19   0    4  53       1       0       0       8     UNKNOWN  2025-01-12_00:00:00   00  PDT4.8  <br>  20   0    4  11       8********       0       8     UNKNOWN  2025-01-12_00:00:00   00  PDT4.8  <br>  21   0    4  53       8********       0       8     UNKNOWN  2025-01-12_00:00:00   00  PDT4.8  <br>  22   0    3 228       1       0       0       0     UNKNOWN  2025-01-12_00:00:00   00          <br>  23   0    3   5       1       0       0       0     HGT      2025-01-12_00:00:00   00          <br>  24   0    1   0     103       2       0       0     SPFH     2025-01-12_00:00:00   00          <br>  25   0    0   0     103       2       0       0     TMP      2025-01-12_00:00:00   00          <br>  26   0    2   2     103      10       0       0     UGRD     2025-01-12_00:00:00   00          <br>  27   0    2   3     103      10       0       0     VGRD     2025-01-12_00:00:00   00          <br>  28   0    6   1       1       0********       0     TCDC     2025-01-12_00:00:00   00          <br>  29   0    6   3       1       0********       0     LCDC     2025-01-12_00:00:00   00          <br>  30   0    6   4       1       0********       0     MCDC     2025-01-12_00:00:00   00          <br>  31   0    6   5       1       0********       0     HCDC     2025-01-12_00:00:00   00          <br>  32   0    1  64      10********       0       0     UNKNOWN  2025-01-12_00:00:00   00          <br>  33   0    1  69      10********       0       0     UNKNOWN  2025-01-12_00:00:00   00          <br>  34   0    1  70      10********       0       0     UNKNOWN  2025-01-12_00:00:00   00          <br>  35   0    3  18       1       0       0       0     HPBL     2025-01-12_00:00:00   00          <br>  36   0    2 227       1       0       0       0     UNKNOWN  2025-01-12_00:00:00   00          <br>  37   0    2 228       1       0       0       0     UNKNOWN  2025-01-12_00:00:00   00          <br>  38   0    1  11       1       0       0       0     SNOD     2025-01-12_00:00:00   00          <br>  39   0   19   1       1       0       0       0     ALBDO    2025-01-12_00:00:00   00          <br>  40   0    0   4     103       2       0       8     TMAX     2025-01-12_00:00:00   00  PDT4.8  <br>  41   0    0   5     103       2       0       8     TMIN     2025-01-12_00:00:00   00  PDT4.8  <br>  42   0    1 231     103       2       0       8     UNKNOWN  2025-01-12_00:00:00   00  PDT4.8  <br>  43   0    1 232     103       2       0       8     UNKNOWN  2025-01-12_00:00:00   00  PDT4.8  <br>  44   0    3   0       1       0       0       0     PRES     2025-01-12_00:00:00   00          <br>  45   0    3   1     101       0       0       0     PRMSL    2025-01-12_00:00:00   00          <br>  46   0    2   2     103      30       0       0     UGRD     2025-01-12_00:00:00   00          <br>  47   0    2   2     103      50       0       0     UGRD     2025-01-12_00:00:00   00          <br>  48   0    2   2     103      70       0       0     UGRD     2025-01-12_00:00:00   00          <br>  49   0    2   2     103     100       0       0     UGRD     2025-01-12_00:00:00   00          <br>  50   0    2   2     103     120       0       0     UGRD     2025-01-12_00:00:00   00          <br>  51   0    2   2     103     140       0       0     UGRD     2025-01-12_00:00:00   00          <br>  52   0    2   2     103     160       0       0     UGRD     2025-01-12_00:00:00   00          <br>  53   0    2   2     103     180       0       0     UGRD     2025-01-12_00:00:00   00          <br>  54   0    2   2     103     200       0       0     UGRD     2025-01-12_00:00:00   00          <br>  55   0    2   3     103      30       0       0     VGRD     2025-01-12_00:00:00   00          <br>  56   0    2   3     103      50       0       0     VGRD     2025-01-12_00:00:00   00          <br>  57   0    2   3     103      70       0       0     VGRD     2025-01-12_00:00:00   00          <br>  58   0    2   3     103     100       0       0     VGRD     2025-01-12_00:00:00   00          <br>  59   0    2   3     103     120       0       0     VGRD     2025-01-12_00:00:00   00          <br>  60   0    2   3     103     140       0       0     VGRD     2025-01-12_00:00:00   00          <br>  61   0    2   3     103     160       0       0     VGRD     2025-01-12_00:00:00   00          <br>  62   0    2   3     103     180       0       0     VGRD     2025-01-12_00:00:00   00          <br>  63   0    2   3     103     200       0       0     VGRD     2025-01-12_00:00:00   00          <br>  64   0    3   5     100  100000       0       0     HGT      2025-01-12_00:00:00   00          <br>  65   0    3   5     100   97500       0       0     HGT      2025-01-12_00:00:00   00          <br>  66   0    3   5     100   95000       0       0     HGT      2025-01-12_00:00:00   00          <br>  67   0    3   5     100   92500       0       0     HGT      2025-01-12_00:00:00   00          <br>  68   0    3   5     100   90000       0       0     HGT      2025-01-12_00:00:00   00          <br>  69   0    3   5     100   85000       0       0     HGT      2025-01-12_00:00:00   00          <br>  70   0    3   5     100   80000       0       0     HGT      2025-01-12_00:00:00   00          <br>  71   0    3   5     100   75000       0       0     HGT      2025-01-12_00:00:00   00          <br>  72   0    3   5     100   70000       0       0     HGT      2025-01-12_00:00:00   00          <br>  73   0    3   5     100   65000       0       0     HGT      2025-01-12_00:00:00   00          <br>  74   0    3   5     100   60000       0       0     HGT      2025-01-12_00:00:00   00          <br>  75   0    3   5     100   55000       0       0     HGT      2025-01-12_00:00:00   00          <br>  76   0    3   5     100   50000       0       0     HGT      2025-01-12_00:00:00   00          <br>  77   0    3   5     100   45000       0       0     HGT      2025-01-12_00:00:00   00          <br>  78   0    3   5     100   40000       0       0     HGT      2025-01-12_00:00:00   00          <br>  79   0    3   5     100   35000       0       0     HGT      2025-01-12_00:00:00   00          <br>  80   0    3   5     100   30000       0       0     HGT      2025-01-12_00:00:00   00          <br>  81   0    3   5     100   27500       0       0     HGT      2025-01-12_00:00:00   00          <br>  82   0    3   5     100   25000       0       0     HGT      2025-01-12_00:00:00   00          <br>  83   0    3   5     100   22500       0       0     HGT      2025-01-12_00:00:00   00          <br>  84   0    3   5     100   20000       0       0     HGT      2025-01-12_00:00:00   00          <br>  85   0    3   5     100   17500       0       0     HGT      2025-01-12_00:00:00   00          <br>  86   0    3   5     100   15000       0       0     HGT      2025-01-12_00:00:00   00          <br>  87   0    3   5     100   12500       0       0     HGT      2025-01-12_00:00:00   00          <br>  88   0    3   5     100   10000       0       0     HGT      2025-01-12_00:00:00   00          <br>  89   0    3   5     100    7000       0       0     HGT      2025-01-12_00:00:00   00          <br>  90   0    3   5     100    5000       0       0     HGT      2025-01-12_00:00:00   00          <br>  91   0    3   5     100    3000       0       0     HGT      2025-01-12_00:00:00   00          <br>  92   0    3   5     100    2000       0       0     HGT      2025-01-12_00:00:00   00          <br>  93   0    3   5     100    1000       0       0     HGT      2025-01-12_00:00:00   00          <br>  94   0    3   5     100     700       0       0     HGT      2025-01-12_00:00:00   00          <br>  95   0    3   5     100     500       0       0     HGT      2025-01-12_00:00:00   00          <br>  96   0    3   5     100     400       0       0     HGT      2025-01-12_00:00:00   00          <br>  97   0    3   5     100     300       0       0     HGT      2025-01-12_00:00:00   00          <br>  98   0    3   5     100     200       0       0     HGT      2025-01-12_00:00:00   00          <br>  99   0    3   5     100     150       0       0     HGT      2025-01-12_00:00:00   00          <br> 100   0    3   5     100     100       0       0     HGT      2025-01-12_00:00:00   00          <br> 101   0    3   5     100      50       0       0     HGT      2025-01-12_00:00:00   00          <br> 102   0    3   5     100      20       0       0     HGT      2025-01-12_00:00:00   00          <br> 103   0    3   5     100      10       0       0     HGT      2025-01-12_00:00:00   00          <br> 104   0    0   0     100  100000       0       0     TMP      2025-01-12_00:00:00   00          <br> 105   0    0   0     100   97500       0       0     TMP      2025-01-12_00:00:00   00          <br> 106   0    0   0     100   95000       0       0     TMP      2025-01-12_00:00:00   00          <br> 107   0    0   0     100   92500       0       0     TMP      2025-01-12_00:00:00   00          <br> 108   0    0   0     100   90000       0       0     TMP      2025-01-12_00:00:00   00          <br> 109   0    0   0     100   85000       0       0     TMP      2025-01-12_00:00:00   00          <br> 110   0    0   0     100   80000       0       0     TMP      2025-01-12_00:00:00   00          <br> 111   0    0   0     100   75000       0       0     TMP      2025-01-12_00:00:00   00          <br> 112   0    0   0     100   70000       0       0     TMP      2025-01-12_00:00:00   00          <br> 113   0    0   0     100   65000       0       0     TMP      2025-01-12_00:00:00   00          <br> 114   0    0   0     100   60000       0       0     TMP      2025-01-12_00:00:00   00          <br> 115   0    0   0     100   55000       0       0     TMP      2025-01-12_00:00:00   00          <br> 116   0    0   0     100   50000       0       0     TMP      2025-01-12_00:00:00   00          <br> 117   0    0   0     100   45000       0       0     TMP      2025-01-12_00:00:00   00          <br> 118   0    0   0     100   40000       0       0     TMP      2025-01-12_00:00:00   00          <br> 119   0    0   0     100   35000       0       0     TMP      2025-01-12_00:00:00   00          <br> 120   0    0   0     100   30000       0       0     TMP      2025-01-12_00:00:00   00          <br> 121   0    0   0     100   27500       0       0     TMP      2025-01-12_00:00:00   00          <br> 122   0    0   0     100   25000       0       0     TMP      2025-01-12_00:00:00   00          <br> 123   0    0   0     100   22500       0       0     TMP      2025-01-12_00:00:00   00          <br> 124   0    0   0     100   20000       0       0     TMP      2025-01-12_00:00:00   00          <br> 125   0    0   0     100   17500       0       0     TMP      2025-01-12_00:00:00   00          <br> 126   0    0   0     100   15000       0       0     TMP      2025-01-12_00:00:00   00          <br> 127   0    0   0     100   12500       0       0     TMP      2025-01-12_00:00:00   00          <br> 128   0    0   0     100   10000       0       0     TMP      2025-01-12_00:00:00   00          <br> 129   0    0   0     100    7000       0       0     TMP      2025-01-12_00:00:00   00          <br> 130   0    0   0     100    5000       0       0     TMP      2025-01-12_00:00:00   00          <br> 131   0    0   0     100    3000       0       0     TMP      2025-01-12_00:00:00   00          <br> 132   0    0   0     100    2000       0       0     TMP      2025-01-12_00:00:00   00          <br> 133   0    0   0     100    1000       0       0     TMP      2025-01-12_00:00:00   00          <br> 134   0    0   0     100     700       0       0     TMP      2025-01-12_00:00:00   00          <br> 135   0    0   0     100     500       0       0     TMP      2025-01-12_00:00:00   00          <br> 136   0    0   0     100     400       0       0     TMP      2025-01-12_00:00:00   00          <br> 137   0    0   0     100     300       0       0     TMP      2025-01-12_00:00:00   00          <br> 138   0    0   0     100     200       0       0     TMP      2025-01-12_00:00:00   00          <br> 139   0    0   0     100     150       0       0     TMP      2025-01-12_00:00:00   00          <br> 140   0    0   0     100     100       0       0     TMP      2025-01-12_00:00:00   00          <br> 141   0    0   0     100      50       0       0     TMP      2025-01-12_00:00:00   00          <br> 142   0    0   0     100      20       0       0     TMP      2025-01-12_00:00:00   00          <br> 143   0    0   0     100      10       0       0     TMP      2025-01-12_00:00:00   00 <br> ......<br> 852   0   19   0       1       0       0       0     VIS      2025-01-12_00:00:00   00          <br> 853   0   19 224       1       0       0       0     UNKNOWN  2025-01-12_00:00:00   00          <br> 854   0   19 225       1       0       0       0     UNKNOWN  2025-01-12_00:00:00   00          <br> 855   0    2  22     103      10       0       0     GUST     2025-01-12_00:00:00   00          <br> 856   0    1  19       1       0       0       0     UNKNOWN  2025-01-12_00:00:00   00          <br> 857   0    6  12       1       0       0       0     UNKNOWN  2025-01-12_00:00:00   00          <br> 858   0    6  11       1       0       0       0     UNKNOWN  2025-01-12_00:00:00   00          <br> 859   0    6  13       1       0       0       0     CEIL     2025-01-12_00:00:00   00          <br> 860   0    4 228       1       0       0       0     UNKNOWN  2025-01-12_00:00:00   00          <br> 861   0    4 227       1       0       0       0     UNKNOWN  2025-01-12_00:00:00   00          <br>   Successful completion of g2print  <br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<h2 id="pressure-level">Pressure level</h2>
<p>There are <strong>40</strong> pressure levels, <strong>1000hPa up to 0.1hPa (~30km)</strong></p>
<h2 id="land-sea-mask">Land sea mask</h2>
<ul>
<li><code>./g2print.exe final_cma_lsm.grib2</code> &lt;--- <strong>Land sea mask</strong></li>
</ul>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-9c51fa20" role="button" aria-expanded="false" aria-controls="collapse-9c51fa20">
        <div class="fold-arrow">▶</div>Land sea mask
      </div>
      <div class="fold-collapse collapse" id="collapse-9c51fa20">
        <div class="fold-content">
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs log"> ungrib - grib edition num           2<br> reading from grib file = final_cma_lsm.grib2                                                                                                    <br>      unknown model and orig center   <br>---------------------------------------------------------------------------------------<br> rec Prod Cat Param  Lvl    Lvl      Lvl     Prod    Name            Time          Fcst<br> num Disc     num    code   one      two     Templ                                 hour<br>---------------------------------------------------------------------------------------<br>   1   2    0   0       1       0       0       0     LAND     2025-01-12_00:00:00   00          <br>  <br>  <br>   Successful completion of g2print  <br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<h1 id="ungrib">ungrib</h1>
<ul>
<li><del>re-compile <strong>WPS</strong> (<strong>WRFv450-CMA-GFS</strong>)</del></li>
</ul>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs tap">-rw-rw-r--<span class="hljs-number"> 1 </span>wpsze wpsze 3.2G Apr <span class="hljs-number"> 2 </span>16:56 CMA:2025-01-12_00<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>wpsze wpsze  <span class="hljs-number"> 62 </span>Apr <span class="hljs-number"> 2 </span>16:50 GRIBFILE.AAA -&gt; Z_NAFP_C_BABJ_20250112000000_P_NWPC-GRAPES-GFS-GLB-00000.grib2<br>-rw-rw-r--<span class="hljs-number"> 1 </span>wpsze wpsze <span class="hljs-number"> 272 </span>Apr <span class="hljs-number"> 2 </span>16:50 namelist.wps<br>-rwxrwxr-x<span class="hljs-number"> 1 </span>wpsze wpsze 1.7K Apr <span class="hljs-number"> 2 </span>16:51 run_ungrid.sh*<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>wpsze wpsze  <span class="hljs-number"> 67 </span>Apr <span class="hljs-number"> 2 </span>16:51 ungrib.exe -&gt; /home/wpsze/WRF/WRFv450-CMA-GFS/wrf_install/WPS-4.5/ungrib/ungrib.exe*<br>-rw-rw-r--<span class="hljs-number"> 1 </span>wpsze wpsze  30K Apr <span class="hljs-number"> 2 </span>16:57 ungrib.log<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>wpsze wpsze  <span class="hljs-number"> 14 </span>Apr <span class="hljs-number"> 2 </span>16:51 Vtable -&gt; Vtable.CMA_GFS<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>wpsze wpsze  <span class="hljs-number"> 87 </span>Apr <span class="hljs-number"> 2 </span>16:49 Vtable.CMA_GFS -&gt; /home/wpsze/WRF/WRFv450-CMA-GFS/wrf_install/WPS-4.5/ungrib/Variable_Tables/Vtable.CMA_GFS<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>wpsze wpsze  <span class="hljs-number"> 81 </span>Apr <span class="hljs-number"> 2 </span>16:49 Z_NAFP_C_BABJ_20250112000000_P_NWPC-GRAPES-GFS-GLB-00000.grib2 -&gt; ../202501/20250112/Z_NAFP_C_BABJ_20250112000000_P_NWPC-GRAPES-GFS-GLB-00000.grib2<br></code></pre></td></tr></table></figure>
<p><em>[2025-04-09]</em> After create a land-sea mask field for CMA_GFS (see below section), <strong>GRIBFILE.AAB</strong>,</p>
<ul>
<li>re-compile <strong>WPS</strong> (<strong>WRFv450-CMA-GFS</strong>)</li>
</ul>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs tap">-rw-rw-r--<span class="hljs-number"> 1 </span>wpsze wpsze 3.2G Apr <span class="hljs-number"> 2 </span>16:56 CMA:2025-01-12_00<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>wpsze wpsze  <span class="hljs-number"> 62 </span>Apr <span class="hljs-number"> 2 </span>16:50 GRIBFILE.AAA -&gt; Z_NAFP_C_BABJ_20250112000000_P_NWPC-GRAPES-GFS-GLB-00000.grib2<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>wpsze wpsze  <span class="hljs-number"> 20 </span>Apr <span class="hljs-number"> 8 </span>18:01 GRIBFILE.AAB -&gt; final_cma_lsm.grib2<br>-rw-rw-r--<span class="hljs-number"> 1 </span>wpsze wpsze <span class="hljs-number"> 272 </span>Apr <span class="hljs-number"> 2 </span>16:50 namelist.wps<br>-rwxrwxr-x<span class="hljs-number"> 1 </span>wpsze wpsze 1.7K Apr <span class="hljs-number"> 2 </span>16:51 run_ungrid.sh*<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>wpsze wpsze  <span class="hljs-number"> 67 </span>Apr <span class="hljs-number"> 2 </span>16:51 ungrib.exe -&gt; /home/wpsze/WRF/WRFv450-CMA-GFS/wrf_install/WPS-4.5/ungrib/ungrib.exe*<br>-rw-rw-r--<span class="hljs-number"> 1 </span>wpsze wpsze  30K Apr <span class="hljs-number"> 2 </span>16:57 ungrib.log<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>wpsze wpsze  <span class="hljs-number"> 14 </span>Apr <span class="hljs-number"> 2 </span>16:51 Vtable -&gt; Vtable.CMA_GFS<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>wpsze wpsze  <span class="hljs-number"> 87 </span>Apr <span class="hljs-number"> 2 </span>16:49 Vtable.CMA_GFS -&gt; /home/wpsze/WRF/WRFv450-CMA-GFS/wrf_install/WPS-4.5/ungrib/Variable_Tables/Vtable.CMA_GFS<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>wpsze wpsze  <span class="hljs-number"> 81 </span>Apr <span class="hljs-number"> 2 </span>16:49 Z_NAFP_C_BABJ_20250112000000_P_NWPC-GRAPES-GFS-GLB-00000.grib2 -&gt; ../202501/20250112/Z_NAFP_C_BABJ_20250112000000_P_NWPC-GRAPES-GFS-GLB-00000.grib2<br></code></pre></td></tr></table></figure>
<h1 id="wrf">WRF</h1>
<ul>
<li>geogrid
<ul>
<li><code>LANDMASK</code> is added here. <figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs console">  float LANDMASK(Time, south_north, west_east) ;<br>LANDMASK:FieldType = 104 ;<br>LANDMASK:MemoryOrder = &quot;XY &quot; ;<br>LANDMASK:units = &quot;none&quot; ;<br>LANDMASK:description = &quot;Landmask : 1=land, 0=water&quot; ;<br>LANDMASK:stagger = &quot;M&quot; ;<br>LANDMASK:sr_x = 1 ;<br>LANDMASK:sr_y = 1 ;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li>ungrib.exe
<ul>
<li>We have to update the <strong>LANDMASK</strong> for CMA_GFS (see below section)</li>
<li><strong>final_cma_lsm.grib2</strong>
<ul>
<li>ungrib this grib2 individually and generate a intermediate file <strong>CMA_GFS_landmask</strong></li>
<li>CMA_GFS_landmask is <strong>constant field</strong>.</li>
</ul></li>
</ul></li>
<li>metgrib.exe
<ul>
<li>namelist.wps <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs namelist.wps">&amp;metgrid<br>fg_name = &#x27;CMA_GFS&#x27;,<br>io_form_metgrid = 2, <br>constants_name = &#x27;CMA_GFS_landmask&#x27;,<br>opt_metgrid_tbl_path = &#x27;./&#x27;<br>/<br></code></pre></td></tr></table></figure></li>
<li><strong>! Successful completion of metgrid. !</strong> 
    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-5d5d193e" role="button" aria-expanded="false" aria-controls="collapse-5d5d193e">
        <div class="fold-arrow">▶</div>log
      </div>
      <div class="fold-collapse collapse" id="collapse-5d5d193e">
        <div class="fold-content">
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs log">Processing domain 1 of 2<br>    CMA_GFS_landmask<br>Processing 2025-01-12_00<br>    CMA_GFS<br>Processing 2025-01-12_03<br>    CMA_GFS<br>Processing 2025-01-12_06<br>    CMA_GFS<br>Processing domain 2 of 2<br>    CMA_GFS_landmask<br>Processing 2025-01-12_00<br>    CMA_GFS<br>Processing 2025-01-12_03<br>    CMA_GFS<br>Processing 2025-01-12_06<br>    CMA_GFS<br>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!<br>!  Successful completion of metgrid.  !<br>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div></li>
</ul></li>
<li>real.exe
<ul>
<li><strong>real_em: SUCCESS COMPLETE REAL_EM INIT</strong></li>
</ul></li>
<li>wrf.exe
<ul>
<li><strong>wrf: SUCCESS COMPLETE WRF</strong></li>
</ul></li>
</ul>
<h1 id="mpas">MPAS</h1>
<h2 id="mpasv7.3">MPASv7.3</h2>
<h3 id="init_atmosphere_model">init_atmosphere_model</h3>
<h4 id="error-1">Error 1</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs log">ERROR: ********************************************************************************<br>ERROR: LANDSEA field not found in meteorological data file CMA:2025-01-12_00<br>CRITICAL ERROR: ********************************************************************************<br></code></pre></td></tr></table></figure>
<ul>
<li>seems CMA_GFS doesn't contain <code>LANDSEA</code></li>
</ul>
<p>But, in <strong>static.nc</strong>, landmask is included. So, why does init_atmosphere_model have to check <strong>LANDSEA</strong>?</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs console">int landmask(nCells) ;<br>	landmask:units = &quot;unitless&quot; ;<br>	landmask:long_name = &quot;land-ocean mask (1=land ; 0=ocean)&quot; ;<br></code></pre></td></tr></table></figure>
<ul>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/error-while-running-ungrib-exe-with-ifs-global-data.14439/#post-38395">Error while running ungrib.exe with IFS global data | Oct 28, 2023</a>
<ul>
<li>I tried removing all the fields that do not work with the new namelist record. <strong>However, MPAS needs the LANDSEA mask to work but I don't know how to add it in the Intermediate Files</strong>.</li>
<li>Landsea mask values in ECMWF data lie between 0 and 1, which is different to WRF static data that have values of either 0 (grid box is fully covered by water) or 1 (grid box is fully covered with land). Please see the website below that describes landsea mask in ECMWRF: <a target="_blank" rel="noopener" href="https://confluence.ecmwf.int/display/FUG/Section+2.1.3.1+Land-Sea+Mask" class="uri">https://confluence.ecmwf.int/display/FUG/Section+2.1.3.1+Land-Sea+Mask</a></li>
<li><strong>I am suspicious that Landsea mask values in IFS global data follow the rule of ECMWF data, i.e., its values could be between 0 and 1. This might give rise to troubles when we run MPAS initialization</strong>.</li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/generating-initial-files-in-2-separate-stages.20522/">generating initial files in 2 separate stages | Jan 2025</a>
<ul>
<li>for instance, I found that landsea mask is a necessary parameter for processing pressure level data.</li>
</ul></li>
</ul>
<h5 id="take-ifss-land-sea-mask-wrong">Take IFS's land sea mask (Wrong!!)</h5>
<ul>
<li><code>./extract_landseamask.sh</code></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash</span><br><br>cdo selname,lsm 20250401000000-0h-oper-fc.grib2 lsm_nan.nc<br><br>cdo setmissval,-999 lsm_nan.nc lsm.nc<br><br>cdo -f grb2 copy lsm.nc lsm.grib<br><br>cdo showname lsm.grib<br><br>grib_set -s centre=babj,dataDate=20250112,dataTime=0000,shortName=lsm,typeOfLevel=surface,level=0 lsm.grib lsm_final.grib<br><br>cdo showname lsm_final.grib<br><br><span class="hljs-built_in">rm</span> lsm_nan.nc lsm.nc <br></code></pre></td></tr></table></figure>
<ul>
<li>ungrib step
<ul>
<li><code>ln -s lsm.grib GRIBFILE.AAB</code> # the CMA_GFS.grib2 is GRIBFILE.AAA
<ul>
<li>Error: <code>gb_info: can only decode GRIB edition 2.</code>
<ul>
<li>check: <code>$ grib_ls lsm.grib</code> <figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs console">edition      centre       typeOfLevel  level        dataDate     stepRange    shortName    packingType  gridType     <br>1         ecmf         surface      0            20250401     0            unknown      grid_simple  regular_ll  <br></code></pre></td></tr></table></figure></li>
<li>check: <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ wgrib2 -var lsm.grib <br>1:0:LAND<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li>Solution: <code>cdo -f grb2 copy lsm.nc lsm.grib</code> on <code>extract_landseamask.sh</code>
<ul>
<li>check: <code>$ grib_ls lsm.grib</code> <figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs console">edition      centre       date         dataType     gridType     stepRange    typeOfLevel  level        shortName    packingType  <br>2            ecmf         20250401     fc           regular_ll   0            surface      0            lsm          grid_simple <br></code></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
<li>But <code>init_atmosphere_model</code> still exists: <code>ERROR: LANDSEA field not found in meteorological data file CMA:2025-01-12_00</code></li>
<li>[not yet] Done and check: <code>$ ncl plotfmt.ncl 'filename="CMA:2025-01-12_00"'</code></li>
</ul></li>
</ul>
<h4 id="error-2">Error 2</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs log">CRITICAL ERROR: Error in interpolation of st_fg to MPAS grid: num_st = 18<br></code></pre></td></tr></table></figure>
<ul>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/error-creating-initial-conditions-with-ncep-fnl-ds083-2.17113/">Error creating initial conditions with NCEP FNL ds083.2 | May 8, 2024</a>
<ul>
<li>I'm trying to create the initial conditions file for MPAS (v8.1) using data obtained from the NCEP FNL ds083.2</li>
<li>Just had to change <code>config_nfgsoillevels</code> to <strong>2</strong> and <code>config_extrap_airtemp</code> to <strong>linear</strong> in <code>namelist.init_atmosphere</code>. Once those two modifications were made <code>init_atmosphere_model</code> and <code>atmosphere_model</code> ran without issues.</li>
<li>Note that <strong>FNL data only contains 2-level of soil information</strong>, which is why we need to set <strong>config_nfgsoillevels=2</strong>. <strong>The top of the FNL data is 10 hpa, and therefore extrapolation is needed if MPAS top level is above 10 hpa</strong>.</li>
<li>For the option of <code>config_extrap_airtemp</code>, would you please let me know what is the model top of your MPAS run? Thanks.</li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/initial-condition-critical-error-error-in-interpolation-of-st_fg-to-mpas.15807/">Initial condition CRITICAL ERROR: Error in interpolation of st_fg to MPAS | Feb 16, 2024</a></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/error-in-interpolation-of-st_fg-to-mpas-grid-with-variable-resolution-mesh-simulation.9387/">'Error in interpolation of st_fg to MPAS grid' with variable-resolution mesh simulation | Jul 23, 2020</a>
<ul>
<li><strong>The error message generally indicates that there are grid cells that have a soil temperature value less than or equal to zero.</strong></li>
<li>I solved the problem by downloading the "Vtable from the RDR page/WRF" and using WPS version 4.0 or higher.</li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/critical-error-error-in-interpolation-of-st_fg-to-mpas-grid.5382/">CRITICAL ERROR: Error in interpolation of st_fg to MPAS grid | Start dateMay 3, 2019</a>
<ul>
<li>This error message is an indication that there were one or more points in the MPAS mesh that received a zero or negative value for soil temperature.</li>
<li>Can you also verify that there are soil moisture and soil temperature fields in your WPS intermediate file, and that the number of soil levels in your intermediate files matches the value of the config_nfgsoillevels in your namelist.init_atmosphere file?</li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/critical-error-error-in-interpolation-of-st_fg-to-mpas-grid-num_st-18642.12857/">CRITICAL ERROR: Error in interpolation of st_fg to MPAS grid: num_st = 18642 | Apr 12, 2023</a>
<ul>
<li><strong>MPAS can only process soil data at specific levels with specific field names. If your input soil data are on levels or with names unrecognized by MPAS, then it won't work</strong>.</li>
<li>Please take a look at the code <strong>"mpas_init_atm_cases.F"</strong>, and the lines 3908 - 4118 process soil temperature data. This might give you some idea how MPAS works.</li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/trying-to-use-rap-as-ic-bc.5549/">Trying to Use RAP as IC/BC | Start dateJun 26, 2019</a>
<ul>
<li>The message "Error in interpolation of st_fg to MPAS grid: num_st = XXXX" is <strong>generally indicative of an issue with the soil temperature</strong>. Would it be possible to use some of the utilities that come with the WRF Pre-processing System (WPS) to check that there are valid soil temperature data in your intermediate file? Specifically, you could use the "<code>rd_intermediate</code>" utility to check that there are fields named, e.g., ST000010, and you could use the "<code>int2nc</code>" utility to convert the intermediate file to netCDF format, where it would be easier to view the soil fields with, e.g., <code>ncview</code>.</li>
</ul></li>
</ul>
<h5 id="check-grib2-file">check grib2 file</h5>
<p>In general, <strong>GFS/ERA5/IFS 0.25 deg grib files</strong> show</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs log"># Earth assumed spherical with radius of 6 371 229.0 m  (grib2/tables/25/3.2.table)                 <br>shapeOfTheEarth = 6;                                                                                <br>Ni = 1440;                                                                                          <br>Nj = 721;                                                                                        <br></code></pre></td></tr></table></figure>
<p>But, in CMA_GFS grib file, it has shown</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs log">#==============   MESSAGE 1 ( length=205 )                 ==============  <br>GRIB &#123;                                                                     <br>  # Meteorological products (grib2/tables/4/0.0.table)                     <br>  discipline = 0;                                                          <br>  editionNumber = 2;                                                       <br>  # Beijing  (RSMC)  (common/c-11.table)                                   <br>  centre = 38;                                                             <br>  subCentre = 0;                                                           <br>  # Analysis (grib2/tables/4/1.2.table)                                    <br>  significanceOfReferenceTime = 0;                                         <br>  dataDate = 20250112;                                                     <br>  dataTime = 0;    <br>......<br># Earth assumed spherical with radius of 6,371,229.0 m (grib2/tables/4/3.2.table)                  <br>shapeOfTheEarth = 6;                                                                               <br>Ni = 2880;                                                                                         <br>Nj = 1440;<br></code></pre></td></tr></table></figure>
<p>which <strong>is not 0.25 deg but 0.125 deg</strong>. Therefore, <code>LANDSEA</code> of IFS can not be used for CMA_GFS.</p>
<h4 id="take-gfss-land-sea-mask-wrong">Take GFS's land sea mask (Wrong!!)</h4>
<div class="note note-primary">
            <p>The GFS land mask is not suitable for use with CMA_GFS.</p>
          </div>
<h4 id="solution-successful">Solution (Successful)</h4>
<p>Move to next section <strong>"CMA_GFS Land Sea Mask"</strong></p>
<p>For MPASv7.3, it is <strong>Successful</strong>.</p>
<ul>
<li><strong>Successful completion of program ungrib.exe</strong></li>
<li><strong>Finished running the init_atmosphere core</strong></li>
<li><strong>Finished running the atmosphere core</strong></li>
</ul>
<div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/pdB6QnM.png" srcset="/img/loading.gif" lazyload /></div><div class="group-image-wrap"><img src="https://i.imgur.com/f4xvs04.png" srcset="/img/loading.gif" lazyload /></div><div class="group-image-wrap"><img src="https://i.imgur.com/lyWsoLX.png" srcset="/img/loading.gif" lazyload /></div></div><div class="group-image-row"></div></div>
<h3 id="atmosphere_model">atmosphere_model</h3>
<ul>
<li><strong>Finished running the atmosphere core</strong></li>
</ul>
<h1 id="cma_gfs-land-sea-mask">CMA_GFS Land Sea Mask</h1>
<div class="note note-primary">
            <p>If the GFS land mask is not suitable for use with CMA_GFS, the presence of 0K values could lead to problems. Is it possible for us to utilize this information to create a land-sea mask specifically for CMA_GFS from CMA_GFS?</p>
          </div>
<h2 id="check-grib2s-soil-temperature">check grib2's soil temperature</h2>
<div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/So0DDy5.png" srcset="/img/loading.gif" lazyload /></div><div class="group-image-wrap"><img src="https://i.imgur.com/JuV2vgI.png" srcset="/img/loading.gif" lazyload /></div><div class="group-image-wrap"><img src="https://i.imgur.com/GbUafcp.png" srcset="/img/loading.gif" lazyload /></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/ZVtQcM4.png" srcset="/img/loading.gif" lazyload /></div></div></div>
<h2 id="solution">Solution</h2>
<ul>
<li>We are required to <strong>create a land mask using the same source data as CMA_GFS to ensure consistency in our results</strong>. In this case, I will utilize the soil temperature data at depths of 1-2 meters, as this data shows a value of 0 in ocean areas.</li>
</ul>
<h3 id="wgrib2">wgrib2</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs log">$ wgrib2 Z_NAFP_C_BABJ_20250112000000_P_NWPC-GRAPES-GFS-GLB-00000.grib2<br><br>464:416263005:d=2025011200:TMP:0-0.1 m below ground:anl:<br>465:418796241:d=2025011200:TMP:0.1-0.4 m below ground:anl:<br>466:421201726:d=2025011200:TMP:0.4-1 m below ground:anl:<br>467:423468299:d=2025011200:TMP:1-2 m below ground:anl:<br>468:424559640:d=2025011200:SPFH:0-0.1 m below ground:anl:<br>469:426189296:d=2025011200:SPFH:0.1-0.4 m below ground:anl:<br>470:427793124:d=2025011200:SPFH:0.4-1 m below ground:anl:<br>471:429405783:d=2025011200:SPFH:1-2 m below ground:anl:<br></code></pre></td></tr></table></figure>
<ul>
<li><code>467:423468299:d=2025011200:TMP:1-2 m below ground:anl:</code> is our target.</li>
</ul>
<h3 id="extract-and-generate-new-grib2-for-landmask">extract and generate new grib2 for landmask</h3>
<ol type="1">
<li>convert grib2 to nc file,</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">wgrib2 Z_NAFP_C_BABJ_20250112000000_P_NWPC-GRAPES-GFS-GLB-00000.grib2 -match <span class="hljs-string">&#x27;:TMP:1-2 m below ground:&#x27;</span> -grib TMP_1_2m.grib2<br><br>grib_to_netcdf TMP_1_2m.grib2 -o TMP_1_2m.nc<br></code></pre></td></tr></table></figure>
<ol start="2" type="1">
<li>modify/create landmask field for CMA_GFS,</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> xarray <span class="hljs-keyword">as</span> xr<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br>TMP_1_2m_file = <span class="hljs-string">&quot;/home/wpsze/mpas/CMA_GFS/test/ungrib/TMP_1_2m.nc&quot;</span><br>TMP_1_2m_nc = xr.open_dataset(TMP_1_2m_file)<br><br><span class="hljs-comment"># plt.imshow(TMP_1_2m_nc[&#x27;t&#x27;][0,:,:])</span><br><br><span class="hljs-comment"># Check for non-zero values and assign them to 1</span><br>TMP_1_2m_nc[<span class="hljs-string">&#x27;t&#x27;</span>] = TMP_1_2m_nc[<span class="hljs-string">&#x27;t&#x27;</span>].where(TMP_1_2m_nc[<span class="hljs-string">&#x27;t&#x27;</span>] == <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># plt.imshow(TMP_1_2m_nc[&#x27;t&#x27;][0,:,:])</span><br><br>TMP_1_2m_nc = TMP_1_2m_nc.rename(&#123;<span class="hljs-string">&#x27;t&#x27;</span>: <span class="hljs-string">&#x27;lsm&#x27;</span>&#125;)<br>TMP_1_2m_nc[<span class="hljs-string">&#x27;lsm&#x27;</span>] = TMP_1_2m_nc[<span class="hljs-string">&#x27;lsm&#x27;</span>].assign_attrs(<br>                standard_name = <span class="hljs-string">&quot;land_binary_mask&quot;</span>,<br>        		long_name = <span class="hljs-string">&quot;Land-sea mask&quot;</span>,<br>        		units = <span class="hljs-string">&quot;(0 - 1)&quot;</span>)<br><br><span class="hljs-comment">#================== Save =================================================</span><br><span class="hljs-comment"># Save the result to a new NetCDF file</span><br>TMP_1_2m_nc.to_netcdf(<span class="hljs-string">f&#x27;/home/wpsze/mpas/CMA_GFS/test/ungrib/new_TMP_1_2m.nc&#x27;</span>, <span class="hljs-built_in">format</span>=<span class="hljs-string">&#x27;NETCDF4&#x27;</span>)<br></code></pre></td></tr></table></figure>
<ul>
<li>Left: original soil temperature; Right: our created Land sea mask field for CMA_GFS</li>
</ul>
<div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/5O95DVb.png" srcset="/img/loading.gif" lazyload /></div><div class="group-image-wrap"><img src="https://i.imgur.com/r01Obgx.png" srcset="/img/loading.gif" lazyload /></div></div><div class="group-image-row"></div></div>
<ol start="3" type="1">
<li>convert landmask nc file to grib2</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh">cdo -f grb2 copy new_TMP_1_2m.nc new_TMP_1_2m.grib2<br><br><span class="hljs-comment"># check</span><br>grib_ls new_TMP_1_2m.grib2<br>wgrib2 new_TMP_1_2m.grib2<br><br>grib_set -r -w packingType=grid_ieee -s centre=babj,shortName=lsm,typeOfLevel=surface,level=0,dataType=an,packingType=grid_jpeg new_TMP_1_2m.grib2 final_TMP_1_2m.grib2<br><br><span class="hljs-built_in">mv</span> final_TMP_1_2m.grib2 final_cma_lsm.grib2<br></code></pre></td></tr></table></figure>
<ul>
<li>Make sure the <strong>datetime is updated with your run</strong>.</li>
</ul>
<blockquote>
<p><strong>grib_set -r -w packingType=grid_ieee -s centre=babj,shortName=lsm,typeOfLevel=surface,level=0,dataType=an,packingType=grid_jpeg,dataDate=20250416,dataTime=0000 new_TMP_1_2m.grib2 final_TMP_1_2m.grib2</strong></p>
</blockquote>
<ul>
<li><code>./g2print.exe final_cma_lsm.grib2</code></li>
<li><code>2 0 0 1</code> here correpsonds to <code>Vtable.CMA_GFS</code>
<ul>
<li><strong>LANDSEA</strong></li>
<li><code>| LANDSEA  | proprtn | Land/Sea flag (1=land, 0 or 2=sea)      |  2  |  0  |  0  |   1 |</code></li>
</ul></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs log"> ungrib - grib edition num           2<br> reading from grib file = final_cma_lsm.grib2                                                                                                    <br>      unknown model and orig center   <br>---------------------------------------------------------------------------------------<br> rec Prod Cat Param  Lvl    Lvl      Lvl     Prod    Name            Time          Fcst<br> num Disc     num    code   one      two     Templ                                 hour<br>---------------------------------------------------------------------------------------<br>   1   2    0   0       1       0       0       0     LAND     2025-01-12_00:00:00   00          <br>  <br>  <br>   Successful completion of g2print  <br></code></pre></td></tr></table></figure>
<h1 id="cronjob">cronjob</h1>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-639614a5" role="button" aria-expanded="false" aria-controls="collapse-639614a5">
        <div class="fold-arrow">▶</div>wpsze_download_CMA_GFS-cronjob-00z.sh
      </div>
      <div class="fold-collapse collapse" id="collapse-639614a5">
        <div class="fold-content">
          <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-comment">#################################################################</span><br><span class="hljs-comment"># http://data.wis.cma.cn/DCPC_WMC_BJ/open/nwp/gmf_gra/t0000/f0_f240_6h/Z_NAFP_C_BABJ_20250401000000_P_NWPC-GRAPES-GFS-GLB-00000.grib2</span><br><span class="hljs-comment">#################################################################</span><br><span class="hljs-built_in">source</span> /home/wpsze/micromamba/etc/profile.d/micromamba.sh<br>micromamba activate venv<br><br>BASE_DIR=$(<span class="hljs-built_in">pwd</span>)<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Base Dir = <span class="hljs-variable">$&#123;BASE_DIR&#125;</span>&quot;</span><br><br><span class="hljs-keyword">for</span> ifsday <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">seq</span> 0 1 1); <span class="hljs-keyword">do</span> <span class="hljs-comment"># day-shift = 0, 1</span><br><br>    YYYYMMDDHH=$(<span class="hljs-built_in">date</span> -d <span class="hljs-string">&quot;today - <span class="hljs-variable">$&#123;ifsday&#125;</span> day&quot;</span> +%Y%m%d00)<br><br>    yyyy=<span class="hljs-variable">$&#123;YYYYMMDDHH:0:4&#125;</span><br>    mm=<span class="hljs-variable">$&#123;YYYYMMDDHH:4:2&#125;</span><br>    <span class="hljs-built_in">dd</span>=<span class="hljs-variable">$&#123;YYYYMMDDHH:6:2&#125;</span><br>    hh=<span class="hljs-variable">$&#123;YYYYMMDDHH:8:2&#125;</span><br><br>    yyyymm=<span class="hljs-variable">$&#123;yyyy&#125;</span><span class="hljs-variable">$&#123;mm&#125;</span><br>    yyyymmdd=<span class="hljs-variable">$&#123;yyyy&#125;</span><span class="hljs-variable">$&#123;mm&#125;</span><span class="hljs-variable">$&#123;dd&#125;</span><br><br>    tmp_dir=<span class="hljs-string">&quot;./<span class="hljs-variable">$&#123;yyyy&#125;</span><span class="hljs-variable">$&#123;mm&#125;</span>/<span class="hljs-variable">$&#123;yyyy&#125;</span><span class="hljs-variable">$&#123;mm&#125;</span><span class="hljs-variable">$&#123;dd&#125;</span>&quot;</span><br>    <span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$&#123;tmp_dir&#125;</span><br>    <span class="hljs-built_in">cd</span> <span class="hljs-variable">$&#123;tmp_dir&#125;</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Current Dir: <span class="hljs-subst">$(pwd)</span>&quot;</span><br><br>    limit_cpu_core=15<br>    count_cpu_core=1<br><br>    <span class="hljs-comment">#============== 00z ===================================</span><br>    tmp_cma_gfs_fname=<span class="hljs-string">&quot;Z_NAFP_C_BABJ_<span class="hljs-variable">$&#123;YYYYMMDDHH&#125;</span>0000_P_NWPC-GRAPES-GFS-GLB-00000.grib2&quot;</span><br><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Now, <span class="hljs-variable">$&#123;tmp_cma_gfs_fname&#125;</span> ... &quot;</span><br><br>    <span class="hljs-keyword">if</span> [[ ! -f <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;tmp_cma_gfs_fname&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>	<br>	    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Downloading ... <span class="hljs-variable">$&#123;tmp_cma_gfs_fname&#125;</span>&quot;</span><br>	    <span class="hljs-comment">#wget --no-check-certificate http://data.wis.cma.cn/DCPC_WMC_BJ/open/nwp/gmf_gra/t0000/f0_f240_6h/Z_NAFP_C_BABJ_20250401000000_P_NWPC-GRAPES-GFS-GLB-00000.grib2</span><br>	    wget --no-check-certificate http://data.wis.cma.cn/DCPC_WMC_BJ/open/nwp/gmf_gra/t0000/f0_f240_6h/<span class="hljs-variable">$&#123;tmp_cma_gfs_fname&#125;</span><br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;tmp_cma_gfs_fname&#125;</span> exists ... &quot;</span><br>    <span class="hljs-keyword">fi</span><br><br>    res=$(( <span class="hljs-variable">$&#123;count_cpu_core&#125;</span> % <span class="hljs-variable">$&#123;limit_cpu_core&#125;</span> ))<br>    <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$&#123;res&#125;</span> == 0 ]]; <span class="hljs-keyword">then</span><br>	    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;please wait <span class="hljs-variable">$&#123;tmp_cma_gfs_fname&#125;</span>, <span class="hljs-variable">$&#123;count_cpu_core&#125;</span>, <span class="hljs-variable">$&#123;res&#125;</span>.&quot;</span><br>	    <span class="hljs-built_in">wait</span><br>    <span class="hljs-keyword">fi</span><br>    <br>    <span class="hljs-built_in">cd</span> <span class="hljs-variable">$&#123;BASE_DIR&#125;</span><br><span class="hljs-keyword">done</span>    <br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<ul>
<li><strong>HKT = UTC + 8</strong></li>
<li>How to set the crontab: <code>$ crontab -e</code></li>
</ul>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">crontab -l</span><br>00 16 * * * cd /home/wpsze/mpas/CMA_GFS; sh wpsze_download_CMA_GFS-cronjob-00z.sh<br>00 16 * * * cd /home/wpsze/mpas/CMA_GFS; sh wpsze_download_CMA_GFS-cronjob-12z.sh<br></code></pre></td></tr></table></figure>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/NWP/" class="category-chain-item">NWP</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/NWP/" class="print-no-link">#NWP</a>
      
        <a href="/tags/MPAS/" class="print-no-link">#MPAS</a>
      
        <a href="/tags/WRF/" class="print-no-link">#WRF</a>
      
        <a href="/tags/CMA/" class="print-no-link">#CMA</a>
      
        <a href="/tags/CMA-GFS/" class="print-no-link">#CMA_GFS</a>
      
        <a href="/tags/Land-sea-mask/" class="print-no-link">#Land-sea mask</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>NWP | CMA | CMA_GFS real time data</div>
      <div>https://waipangsze.github.io/2025/04/02/NWP-CMA-CMA_GFS-real-time-data/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>wpsze</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>April 2, 2025</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Updated on</div>
          <div>April 23, 2025</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/04/08/Eddy-Dissipation-Rate-EDR/" title="NWP | Eddy Dissipation Rate (EDR)">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">NWP | Eddy Dissipation Rate (EDR)</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/04/02/NWP-DA-Kalman-Filter/" title="NWP | DA | Kalman Filter">
                        <span class="hidden-mobile">NWP | DA | Kalman Filter</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9HL36SZ28R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9HL36SZ28R');
</script>

    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">

  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  

  <span id="sitetime"></span>
  <script language=javascript>
    function siteTime(){
      window.setTimeout("siteTime()", 1000);
      var seconds = 1000;
      var minutes = seconds * 60;
      var hours = minutes * 60;
      var days = hours * 24;
      var years = days * 365;
      var today = new Date();
      var todayYear = today.getFullYear();
      var todayMonth = today.getMonth()+1;
      var todayDate = today.getDate();
      var todayHour = today.getHours();
      var todayMinute = today.getMinutes();
      var todaySecond = today.getSeconds();
      /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
      year - 作为date对象的年份，为4位年份值
      month - 0-11之间的整数，做为date对象的月份
      day - 1-31之间的整数，做为date对象的天数
      hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
      minutes - 0-59之间的整数，做为date对象的分钟数
      seconds - 0-59之间的整数，做为date对象的秒数
      microseconds - 0-999之间的整数，做为date对象的毫秒数 */
      var t1 = Date.UTC(2023,04,23,00,00,00); //北京时间2018-2-13 00:00:00
      var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
      var diff = t2-t1;
      var diffYears = Math.floor(diff/years);
      var diffDays = Math.floor((diff/days)-diffYears*365);
      var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
      var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
      var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
      /*document.getElementById("sitetime").innerHTML=" 已运行"+/*diffYears+" 年 "+*/diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
      document.getElementById("sitetime").innerHTML=" 已運行"+diffYears+" 年 "+diffDays+" 天 ";
    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
  </script>
  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
