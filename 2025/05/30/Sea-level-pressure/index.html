

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="wpsze">
  <meta name="keywords" content="">
  
    <meta name="description" content="Detailed Mathematical Formulations of Mean Sea Level Pressure (MSLP)  1. Fundamental Physical Basis Hydrostatic Equation &#x2F; 流體靜力平衡方程 The vertical variation of atmospheric pressure is governed by the hy">
<meta property="og:type" content="article">
<meta property="og:title" content="Mean sea level pressure | 平均海平面氣壓">
<meta property="og:url" content="https://waipangsze.github.io/2025/05/30/Sea-level-pressure/index.html">
<meta property="og:site_name" content="wpsze">
<meta property="og:description" content="Detailed Mathematical Formulations of Mean Sea Level Pressure (MSLP)  1. Fundamental Physical Basis Hydrostatic Equation &#x2F; 流體靜力平衡方程 The vertical variation of atmospheric pressure is governed by the hy">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.imgur.com/qJAq2VG.png">
<meta property="article:published_time" content="2025-05-30T03:19:00.000Z">
<meta property="article:modified_time" content="2025-05-30T08:03:17.044Z">
<meta property="article:author" content="wpsze">
<meta property="article:tag" content="NWP">
<meta property="article:tag" content="WRF">
<meta property="article:tag" content="MPAS">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.imgur.com/qJAq2VG.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Mean sea level pressure | 平均海平面氣壓 - wpsze</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"waipangsze.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":"F7MK-FcxSomhtc1N3hIUDA"},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=F7MK-FcxSomhtc1N3hIUDA", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', 'F7MK-FcxSomhtc1N3hIUDA');
        });
      }
    </script>
  

  

  

  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>wpsze</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>Links</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/bookmark/" target="_self">
                <i class="iconfont icon-bookmark"></i>
                <span>Bookmarks</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                <span>Docs</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Physics/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Physics</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Maths/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Maths</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/CFD/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>CFD</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/ML/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>ML</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Meteorology/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Meteorology</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/MPAS/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>MPAS</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/monitor/" target="_self">
                    
                    <span>Real Time Monitoring</span>
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About Me</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://i.imgur.com/qJAq2VG.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Mean sea level pressure | 平均海平面氣壓"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-05-30 11:19" pubdate>
          May 30, 2025 am
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.1k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          18 mins
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> views
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Mean sea level pressure | 平均海平面氣壓</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="detailed-mathematical-formulations-of-mean-sea-level-pressure-mslp">Detailed Mathematical Formulations of Mean Sea Level Pressure (MSLP)</h1>
<hr />
<h2 id="fundamental-physical-basis">1. Fundamental Physical Basis</h2>
<h3 id="hydrostatic-equation-流體靜力平衡方程">Hydrostatic Equation / 流體靜力平衡方程</h3>
<p>The vertical variation of atmospheric pressure is governed by the hydrostatic balance:<br />
大氣壓力隨高度變化遵循流體靜力平衡方程：</p>
<p><span class="math display">\[
\frac{dP}{dz} = -\rho g
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(P\)</span> = atmospheric pressure (Pa)</li>
<li><span class="math inline">\(z\)</span> = geometric height (m)</li>
<li><span class="math inline">\(\rho\)</span> = air density (kg/m³)</li>
<li><span class="math inline">\(g\)</span> = gravitational acceleration (9.80665 <span class="math inline">\(m/s^2\)</span>)</li>
</ul>
<hr />
<h3 id="ideal-gas-law">Ideal Gas Law</h3>
<p>Air density relates to pressure and temperature as:</p>
<p><span class="math display">\[
P = \rho R_d T_v
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(R_d\)</span> = specific gas constant for dry air (~287.05 J/(kg·K)) / 乾空氣氣體常數<br />
</li>
<li><span class="math inline">\(T_v\)</span> = virtual temperature (K), accounts for moisture / 虛溫，考慮濕度影響</li>
</ul>
<p>The <strong>specific gas constant of a gas</strong> (dry gas) or a mixture of gases (<span class="math inline">\(R_d\)</span>) is given by the molar gas constant divided by <strong>the molar mass (<span class="math inline">\(M\)</span>)</strong> of the gas or mixture:</p>
<p><span class="math display">\[
R_d = \dfrac{R}{M}
\]</span></p>
<p>where</p>
<ul>
<li>molar mass of air (dry) <span class="math inline">\(M\)</span> = <span class="math inline">\(28.964917\)</span> g/mol</li>
<li><span class="math inline">\(R\)</span> = <span class="math inline">\(8.314\)</span> J/(K mol).</li>
</ul>
<hr />
<h2 id="derivation-of-mean-sea-level-pressure-equation">2. Derivation of Mean Sea Level Pressure Equation</h2>
<p>Substituting <span class="math inline">\(\rho\)</span> into the hydrostatic equation:</p>
<p><span class="math display">\[
\frac{dP}{dz} = -\frac{P}{R_d T_v} g
\]</span></p>
<p>Rearranged differential form:</p>
<p><span class="math display">\[
\frac{dP}{P} = -\frac{g}{R_d T_v} dz
\]</span></p>
<hr />
<h3 id="assuming-a-linear-temperature-lapse-rate">Assuming a linear temperature lapse rate</h3>
<p>If virtual temperature decreases linearly with height:</p>
<p><span class="math display">\[
T_v(z) = T_0 - \gamma z
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(T_0\)</span> = virtual temperature at surface (K) / 表面虛溫<br />
</li>
<li><span class="math inline">\(\gamma\)</span> = lapse rate (K/m), typically 0.0065 K/m / 溫度遞減率（約 <span class="math inline">\(0.0065\)</span> K/m）</li>
</ul>
<hr />
<h3 id="integrating-from-station-height-z-to-sea-level0-從測站高度積分至海平面">Integrating from station height <span class="math inline">\(z\)</span> to sea level<span class="math inline">\(0\)</span>/ 從測站高度積分至海平面</h3>
<p>Integrate pressure from station pressure <span class="math inline">\(P\)</span> at height<span class="math inline">\(z\)</span>down to sea level pressure <span class="math inline">\(P_0\)</span>:</p>
<p><span class="math display">\[
\int_{P}^{P_0} \frac{dP&#39;}{P&#39;} = -\int_{z}^{0} \frac{g}{R_d (T_0 - \gamma z&#39;)} dz&#39;
\]</span></p>
<p>Solving the integral:<br />
<span class="math display">\[
\ln \left(\frac{P_0}{P}\right) = \frac{g}{R_d \gamma} \ln \left( \frac{T_0}{T_0 - \gamma z} \right)
\]</span></p>
<p>Exponentiating both sides:</p>
<p><span class="math display">\[
P_0 = P \left( \frac{T_0}{T_0 - \gamma z} \right)^{\frac{g}{R_d \gamma}}
\]</span></p>
<p>This is the <strong>standard formula</strong> to reduce station pressure to mean sea level pressure. (此為標準海平面氣壓換算公式。)</p>
<hr />
<h2 id="virtual-temperature-calculation-虛溫計算">3. Virtual Temperature Calculation / 虛溫計算</h2>
<p>Virtual temperature accounts for moisture:<br />
虛溫考慮濕度影響：</p>
<p><span class="math display">\[
T_v = T (1 + 0.608 q)
\]</span><br />
where:</p>
<ul>
<li><span class="math inline">\(T\)</span> = actual air temperature (K) / 實際氣溫<br />
</li>
<li><span class="math inline">\(q\)</span> = specific humidity (kg/kg) / 比濕</li>
</ul>
<hr />
<h2 id="simplified-approximate-form-簡化近似形式">4. Simplified Approximate Form / 簡化近似形式</h2>
<p>For small heights (less than ~1000 m), a linear approximation is often used:<br />
對低海拔（&lt;1000米），可用線性近似：</p>
<p><span class="math display">\[
P_0 \approx P + \rho g z
\]</span></p>
<p>Using ideal gas law:</p>
<p><span class="math display">\[
P_0 \approx P + \frac{P}{R_d T_v} g z
\]</span></p>
<hr />
<h2 id="other-important-equations-其他重要方程">5. Other Important Equations / 其他重要方程</h2>
<h3 id="pressure-height-equation-氣壓高度方程">Pressure Height Equation / 氣壓高度方程</h3>
<p>Given pressure difference, height difference can be calculated as:</p>
<p><span class="math display">\[
h = \frac{R_d \overline{T_v}}{g} \ln \left(\frac{P_1}{P_2}\right)
\]</span></p>
<p>where <span class="math inline">\(\overline{T_v}\)</span> is the mean virtual temperature between two pressure levels.</p>
<hr />
<h3 id="qnh-aviation-mean-sea-level-pressure-航空用qnh計算">QNH (Aviation Mean Sea Level Pressure) / 航空用QNH計算</h3>
<p>QNH is the local mean sea level pressure used to calibrate altimeters:</p>
<p><span class="math display">\[
\text{QNH} = P \times \left(1 - \frac{L \cdot z}{T_0}\right)^{\frac{g}{R_d L}}
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(L\)</span>= lapse rate (0.0065 K/m)<br />
</li>
<li><span class="math inline">\(z\)</span>= station elevation (m)<br />
</li>
<li><span class="math inline">\(T_0\)</span>= standard temperature at sea level (288.15 K)</li>
</ul>
<hr />
<h2 id="summary-table-of-key-variables-主要變數總結">6. Summary Table of Key Variables / 主要變數總結</h2>
<table>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Meaning</th>
<th>Typical Value / Range</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(P\)</span></td>
<td>Pressure at station (Pa)</td>
<td>Variable</td>
</tr>
<tr class="even">
<td><span class="math inline">\(P_0\)</span></td>
<td>Mean sea level pressure (Pa)</td>
<td>~101325 Pa (standard)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(z\)</span></td>
<td>Station elevation (m)</td>
<td>0 - several thousand meters</td>
</tr>
<tr class="even">
<td><span class="math inline">\(T\)</span></td>
<td>Air temperature (K)</td>
<td>~250 - 320 K</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(T_v\)</span></td>
<td>Virtual temperature (K)</td>
<td>Slightly higher than <span class="math inline">\(T\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\gamma\)</span></td>
<td>Lapse rate (K/m)</td>
<td>~0.0065 K/m</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(g\)</span></td>
<td>Gravity acceleration (m/s²)</td>
<td>9.80665</td>
</tr>
<tr class="even">
<td><span class="math inline">\(R_d\)</span></td>
<td>Gas constant for dry air (J/kg·K)</td>
<td>287.05</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(q\)</span></td>
<td>Specific humidity (kg/kg)</td>
<td>0 - 0.03</td>
</tr>
</tbody>
</table>
<hr />
<h1 id="correcting-the-sea-level-pressure-equation">Correcting the Sea Level Pressure Equation</h1>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.cma.gov.cn/2011xwzx/2011xqxxw/2011xqxyw/201410/t20141026_264967.html">【科学漫谈】关于气压订正技术的尘封往事</a>
<ul>
<li>那麼，韋中達是如何修訂氣壓訂正公式的呢？</li>
<li>其實，他提供的方法簡單又合理：<strong>氣壓訂正時要用到當時的測站溫度，他提出，改用最近24小時的平均溫度（這在無形中消除了溫度的日變化）代替觀測時的溫度，再做訂正計算就可以了</strong>。西北地區溫度的日變化很大。</li>
<li><strong>世界氣象組織建議的計算方法，對於海拔不高、溫度日變化不大的情況是適用的</strong>。但是遇到氣象站海拔高而溫度日變化又大的情況時，即便本站氣壓變化不大，但是溫度的日變化就可以導致訂正過的海平面氣壓有很大的虛假的日變化。而韋中達的辦法巧妙地消除了這個不合理因素。</li>
</ul></li>
</ul>
<h1 id="wrf">WRF</h1>
<ul>
<li>phys/module_diag_trad_fields.F</li>
</ul>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs fortran"><span class="hljs-comment">! Mean sea level pressure</span><br>sealevelp(i,j) =   MSLP ( ht(i,j), pressure(i,kms,j), geoheight(i,kms,j) , &amp;<br>                            qv(i,kms,j), temperature(i,kms,j) )<br></code></pre></td></tr></table></figure>
<ul>
<li>phys/module_diag_functions.F</li>
</ul>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-dcdac752" role="button" aria-expanded="false" aria-controls="collapse-dcdac752">
        <div class="fold-arrow">▶</div>MSLP
      </div>
      <div class="fold-collapse collapse" id="collapse-dcdac752">
        <div class="fold-content">
          <figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs fortran">  <span class="hljs-function"><span class="hljs-keyword">FUNCTION</span></span> MSLP ( zsfc, psfc, zlev1, qlev1, tlev1 )<br><br>      <span class="hljs-keyword">implicit</span> <span class="hljs-keyword">none</span><br>     <br>     <br><span class="hljs-comment">!     DECLARE VARIABLES</span><br><br>      <span class="hljs-keyword">REAL</span>,    <span class="hljs-keyword">INTENT</span> ( <span class="hljs-keyword">IN</span> )  :: zsfc         <span class="hljs-comment">!~ Surface height ( m )</span><br>      <span class="hljs-keyword">REAL</span>,    <span class="hljs-keyword">INTENT</span> ( <span class="hljs-keyword">IN</span> )  :: psfc         <span class="hljs-comment">!~ Surface height ( m )</span><br>      <span class="hljs-keyword">REAL</span>,    <span class="hljs-keyword">INTENT</span> ( <span class="hljs-keyword">IN</span> )  :: zlev1        <span class="hljs-comment">!~ Level 1 height ( m )</span><br>      <span class="hljs-keyword">REAL</span>,    <span class="hljs-keyword">INTENT</span> ( <span class="hljs-keyword">IN</span> )  :: qlev1        <span class="hljs-comment">!~ Level 1 mixing ratio ( kg/kg )</span><br>      <span class="hljs-keyword">REAL</span>,    <span class="hljs-keyword">INTENT</span> ( <span class="hljs-keyword">IN</span> )  :: tlev1        <span class="hljs-comment">!~ Level 1 temperature ( K )</span><br>      <span class="hljs-keyword">real</span>,<span class="hljs-keyword">PARAMETER</span> :: G=<span class="hljs-number">9.81</span><br>      <span class="hljs-keyword">real</span>,<span class="hljs-keyword">PARAMETER</span> :: GI=<span class="hljs-number">1.</span>/G<br>      <span class="hljs-keyword">real</span>,<span class="hljs-keyword">PARAMETER</span> :: RD=<span class="hljs-number">287.0</span><br>      <span class="hljs-keyword">real</span>,<span class="hljs-keyword">PARAMETER</span> :: ZSL=<span class="hljs-number">0.0</span><br>      <span class="hljs-keyword">real</span>,<span class="hljs-keyword">PARAMETER</span> :: TAUCR=RD*GI*<span class="hljs-number">290.66</span>,CONST=<span class="hljs-number">0.005</span>*G/RD<br>      <span class="hljs-keyword">real</span>,<span class="hljs-keyword">PARAMETER</span> :: GORD=G/RD,DP=<span class="hljs-number">60.E2</span><br>      <span class="hljs-keyword">real</span>,<span class="hljs-keyword">PARAMETER</span> :: <span class="hljs-built_in">GAMMA</span>=<span class="hljs-number">6.5E-3</span><br><br>      <span class="hljs-keyword">real</span> MSLP,TVRT,TVRSFC,TAUSFC,TVRSL,TAUSL,TAUAVG<br><span class="hljs-comment">!    </span><br><span class="hljs-comment">!**********************************************************************</span><br><span class="hljs-comment">!     START NGMSLP HERE.</span><br><span class="hljs-comment">!</span><br>         MSLP = PSFC<br><span class="hljs-comment">!</span><br><span class="hljs-comment">!        COMPUTE LAYER TAU (VIRTUAL TEMP*RD/G).</span><br>         TVRT = TLEV1*(<span class="hljs-number">1.0</span>+<span class="hljs-number">0.608</span>*QLEV1)<br>         <span class="hljs-comment">!TAU  = TVRT*RD*GI</span><br><span class="hljs-comment">!    </span><br><span class="hljs-comment">!        COMPUTE TAU AT THE GROUND (Z=ZSFC) AND SEA LEVEL (Z=0)</span><br><span class="hljs-comment">!        ASSUMING A CONSTANT LAPSE RATE OF GAMMA=6.5DEG/KM.</span><br>         TVRSFC = TVRT + (ZLEV1 - ZSFC)*<span class="hljs-built_in">GAMMA</span><br>         TAUSFC = TVRSFC*RD*GI<br>         TVRSL  = TVRT + (ZLEV1 - ZSL)*<span class="hljs-built_in">GAMMA</span><br>         TAUSL  = TVRSL*RD*GI<br><span class="hljs-comment">!    </span><br><span class="hljs-comment">!        IF NEED BE APPLY SHEULL CORRECTION.</span><br>         <span class="hljs-keyword">IF</span> ((TAUSL<span class="hljs-keyword">.GT.</span>TAUCR)<span class="hljs-keyword">.AND.</span>(TAUSFC<span class="hljs-keyword">.LE.</span>TAUCR)) <span class="hljs-keyword">THEN</span><br>            TAUSL=TAUCR<br>         ELSEIF ((TAUSL<span class="hljs-keyword">.GT.</span>TAUCR)<span class="hljs-keyword">.AND.</span>(TAUSFC<span class="hljs-keyword">.GT.</span>TAUCR)) <span class="hljs-keyword">THEN</span><br>            TAUSL = TAUCR-CONST*(TAUSFC-TAUCR)**<span class="hljs-number">2</span><br>         <span class="hljs-keyword">ENDIF</span><br><span class="hljs-comment">!    </span><br><span class="hljs-comment">!        COMPUTE MEAN TAU.</span><br>         TAUAVG = <span class="hljs-number">0.5</span>*(TAUSL+TAUSFC)<br><span class="hljs-comment">!    </span><br><span class="hljs-comment">!        COMPUTE SEA LEVEL PRESSURE.</span><br>         MSLP = PSFC*<span class="hljs-built_in">EXP</span>(ZSFC/TAUAVG)<br><br>  <span class="hljs-keyword">END</span> <span class="hljs-function"><span class="hljs-keyword">FUNCTION</span></span> MSLP<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<h1 id="mpas-a">MPAS-A</h1>
<ul>
<li>src/core_atmosphere/diagnostics/mpas_isobaric_diagnostics.F</li>
</ul>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-6ae3e036" role="button" aria-expanded="false" aria-controls="collapse-6ae3e036">
        <div class="fold-arrow">▶</div>mpas_isobaric_diagnostics.F
      </div>
      <div class="fold-collapse collapse" id="collapse-6ae3e036">
        <div class="fold-content">
          <figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs fortran"><span class="hljs-keyword">logical</span> :: need_mslp, &amp;<br><br>    need_mslp = MPAS_field_will_be_written(<span class="hljs-string">&#x27;mslp&#x27;</span>)<br>    need_any_diags = need_any_diags <span class="hljs-keyword">.or.</span> need_mslp<br>    <span class="hljs-keyword">real</span> (<span class="hljs-keyword">kind</span>=RKIND), <span class="hljs-keyword">dimension</span>(:), <span class="hljs-keyword">pointer</span> :: mslp<br>    <span class="hljs-keyword">call</span> mpas_pool_get_array(diag, <span class="hljs-string">&#x27;mslp&#x27;</span>, mslp)<br>    <span class="hljs-keyword">if</span> (NEED_TEMP <span class="hljs-keyword">.or.</span> NEED_RELHUM <span class="hljs-keyword">.or.</span> NEED_DEWPOINT <span class="hljs-keyword">.or.</span> need_mslp) <span class="hljs-keyword">then</span><br>    <br>    <span class="hljs-keyword">if</span> (need_mslp) <span class="hljs-keyword">then</span><br>        <span class="hljs-comment">!... compute SLP (requires temp, height, pressure, qvapor)</span><br>            <span class="hljs-keyword">call</span> compute_slp(nCells, nVertLevels, num_scalars, temperature, height, pressure, index_qv, scalars, mslp)<br>            mslp(:) = mslp(:) * <span class="hljs-number">100.0</span>   <span class="hljs-comment">! Convert from hPa to Pa</span><br>        <span class="hljs-comment">!   mslp(iCell) = diag % surface_pressure % array(iCell) + 11.38*height(1,iCell)</span><br>        <span class="hljs-comment">!   mslp(iCell) = mslp(iCell)/100.</span><br>            <span class="hljs-keyword">call</span> mpas_log_write(<span class="hljs-string">&#x27;*** MSLP field will not be computed&#x27;</span>)<br>            <span class="hljs-keyword">call</span> mpas_log_write(<span class="hljs-string">&#x27;*** MSLP field will not be computed&#x27;</span>)<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-9c51fa20" role="button" aria-expanded="false" aria-controls="collapse-9c51fa20">
        <div class="fold-arrow">▶</div>compute_slp
      </div>
      <div class="fold-collapse collapse" id="collapse-9c51fa20">
        <div class="fold-content">
          <figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><code class="hljs fortran"><br><span class="hljs-function"><span class="hljs-keyword">subroutine</span></span> compute_slp(ncol,nlev_in,nscalars,t,height,p,index_qv,scalars,slp)<br>   <br>   <span class="hljs-keyword">implicit</span> <span class="hljs-keyword">none</span><br>   <br>  <span class="hljs-comment">!input arguments:</span><br>   <span class="hljs-keyword">integer</span>, <span class="hljs-keyword">intent</span>(<span class="hljs-keyword">in</span>) :: ncol, nlev_in, nscalars<br>  <br>  <span class="hljs-comment">!p: in mb</span><br>  <span class="hljs-comment">!t: in K</span><br>  <span class="hljs-comment">!scalars: in kg/kg</span><br>  <span class="hljs-comment">!height: in m</span><br>   <span class="hljs-keyword">real</span>(<span class="hljs-keyword">kind</span>=RKIND), <span class="hljs-keyword">intent</span>(<span class="hljs-keyword">in</span>), <span class="hljs-keyword">dimension</span>(nlev_in,ncol) :: p,t<br>   <span class="hljs-keyword">real</span>(<span class="hljs-keyword">kind</span>=RKIND), <span class="hljs-keyword">intent</span>(<span class="hljs-keyword">in</span>), <span class="hljs-keyword">dimension</span>(nlev_in+<span class="hljs-number">1</span>,ncol) :: height<br>   <span class="hljs-keyword">integer</span>, <span class="hljs-keyword">intent</span>(<span class="hljs-keyword">in</span>) :: index_qv<br>   <span class="hljs-keyword">real</span>(<span class="hljs-keyword">kind</span>=RKIND), <span class="hljs-keyword">intent</span>(<span class="hljs-keyword">in</span>), <span class="hljs-keyword">dimension</span>(nscalars,nlev_in,ncol) :: scalars<br>  <br>  <span class="hljs-comment">!output arguments:</span><br>   <span class="hljs-keyword">real</span>(<span class="hljs-keyword">kind</span>=RKIND), <span class="hljs-keyword">intent</span>(<span class="hljs-keyword">out</span>), <span class="hljs-keyword">dimension</span>(ncol) :: slp<br>  <br>  <span class="hljs-comment">!local variables:</span><br>   <span class="hljs-keyword">integer</span> :: icol, k, kcount<br>   <span class="hljs-keyword">integer</span> :: klo, khi<br>  <br>   <span class="hljs-keyword">real</span>(<span class="hljs-keyword">kind</span>=RKIND) :: <span class="hljs-built_in">gamma</span>, rr, grav<br>   <span class="hljs-keyword">parameter</span> (rr=<span class="hljs-number">287.0</span>, grav=<span class="hljs-number">9.80616</span>, <span class="hljs-built_in">gamma</span>=<span class="hljs-number">0.0065</span>)<br>  <br>   <span class="hljs-keyword">real</span>(<span class="hljs-keyword">kind</span>=RKIND) :: tc, pconst<br>   <span class="hljs-keyword">parameter</span> (tc=<span class="hljs-number">273.16</span>+<span class="hljs-number">17.5</span>, pconst=<span class="hljs-number">100.</span>)<br>  <br>   <span class="hljs-keyword">logical</span> mm5_test<br>   <span class="hljs-keyword">parameter</span> (mm5_test=<span class="hljs-literal">.true.</span>)<br>  <br>   <span class="hljs-keyword">integer</span>, <span class="hljs-keyword">dimension</span>(:), <span class="hljs-keyword">allocatable</span> :: level<br>   <span class="hljs-keyword">real</span>(<span class="hljs-keyword">kind</span>=RKIND), <span class="hljs-keyword">dimension</span>(:), <span class="hljs-keyword">allocatable</span> :: t_surf, t_msl<br>   <span class="hljs-keyword">real</span>(<span class="hljs-keyword">kind</span>=RKIND) :: plo , phi , tlo, thi , zlo , zhi<br>   <span class="hljs-keyword">real</span>(<span class="hljs-keyword">kind</span>=RKIND) :: p_at_pconst , t_at_pconst , z_at_pconst, z_half_lowest<br>  <br>   <span class="hljs-keyword">logical</span> :: l1, l2, l3, found<br>  <br>  <span class="hljs-comment">! Find least zeta level that is PCONST Pa above the surface.  We later use this</span><br>  <span class="hljs-comment">! level to extrapolate a surface pressure and temperature, which is supposed</span><br>  <span class="hljs-comment">! to reduce the effect of the diurnal heating cycle in the pressure field.</span><br>  <br>   <span class="hljs-keyword">if</span> (<span class="hljs-keyword">.not.</span><span class="hljs-built_in">allocated</span>(level))  <span class="hljs-built_in">allocate</span>(level(ncol))<br>   <span class="hljs-keyword">if</span> (<span class="hljs-keyword">.not.</span><span class="hljs-built_in">allocated</span>(t_surf)) <span class="hljs-built_in">allocate</span>(t_surf(ncol))<br>   <span class="hljs-keyword">if</span> (<span class="hljs-keyword">.not.</span><span class="hljs-built_in">allocated</span>(t_msl))  <span class="hljs-built_in">allocate</span>(t_msl(ncol))<br>  <br>   <span class="hljs-keyword">do</span> icol = <span class="hljs-number">1</span> , ncol<br>      level(icol) = -<span class="hljs-number">1</span><br>  <br>      k = <span class="hljs-number">1</span><br>      found = <span class="hljs-literal">.false.</span><br>      <span class="hljs-keyword">do</span> <span class="hljs-keyword">while</span> ( (<span class="hljs-keyword">.not.</span> found) <span class="hljs-keyword">.and.</span> (k<span class="hljs-keyword">.le.</span>nlev_in))<br>            <span class="hljs-keyword">if</span> ( p(k,icol) <span class="hljs-keyword">.lt.</span> p(<span class="hljs-number">1</span>,icol)-pconst ) <span class="hljs-keyword">then</span><br>               level(icol) = k<br>               found = <span class="hljs-literal">.true.</span><br>            <span class="hljs-keyword">end</span> <span class="hljs-keyword">if</span><br>            k = k+<span class="hljs-number">1</span><br>      <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br>  <br>      <span class="hljs-keyword">if</span> ( level(icol) <span class="hljs-keyword">.eq.</span> -<span class="hljs-number">1</span> ) <span class="hljs-keyword">then</span><br>         <span class="hljs-keyword">call</span> mpas_log_write(<span class="hljs-string">&#x27;Troubles finding level $r above ground.&#x27;</span>, realArgs=(/pconst/))<br>         <span class="hljs-keyword">call</span> mpas_log_write(<span class="hljs-string">&#x27;Problems first occur at ($i)&#x27;</span>, intArgs=(/icol/))<br>         <span class="hljs-keyword">call</span> mpas_log_write(<span class="hljs-string">&#x27;Surface pressure = $r hPa.&#x27;</span>, realArgs=(/p(<span class="hljs-number">1</span>,icol)/))<br>         <span class="hljs-keyword">call</span> mpas_log_write(<span class="hljs-string">&#x27;*** MSLP field will not be computed&#x27;</span>)<br>         slp(:) = <span class="hljs-number">0.0</span><br>         <span class="hljs-keyword">return</span><br>      <span class="hljs-keyword">end</span> <span class="hljs-keyword">if</span><br>  <br>   <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br>  <br>  <span class="hljs-comment">! Get temperature PCONST hPa above surface.  Use this to extrapolate</span><br>  <span class="hljs-comment">! the temperature at the surface and down to sea level.</span><br>  <br>   <span class="hljs-keyword">do</span> icol = <span class="hljs-number">1</span> , ncol<br>  <br>      klo = <span class="hljs-built_in">max</span> ( level(icol) - <span class="hljs-number">1</span> , <span class="hljs-number">1</span>      )<br>      khi = <span class="hljs-built_in">min</span> ( klo + <span class="hljs-number">1</span>        , nlev_in - <span class="hljs-number">1</span> )<br>  <br>      <span class="hljs-keyword">if</span> ( klo <span class="hljs-keyword">.eq.</span> khi ) <span class="hljs-keyword">then</span><br>         <span class="hljs-keyword">call</span> mpas_log_write(<span class="hljs-string">&#x27;Trapping levels are weird.&#x27;</span>)<br>         <span class="hljs-keyword">call</span> mpas_log_write(<span class="hljs-string">&#x27;icol = $i&#x27;</span>, intArgs=(/icol/))<br>         <span class="hljs-keyword">call</span> mpas_log_write(<span class="hljs-string">&#x27;klo = $i, khi = $i: and they should not be equal.&#x27;</span>, intArgs=(/klo,khi/))<br>         <span class="hljs-keyword">call</span> mpas_log_write(<span class="hljs-string">&#x27;*** MSLP field will not be computed&#x27;</span>)<br>         slp(:) = <span class="hljs-number">0.0</span><br>         <span class="hljs-keyword">return</span><br>      <span class="hljs-keyword">end</span> <span class="hljs-keyword">if</span><br>  <br>      plo = p(klo,icol)<br>      phi = p(khi,icol)<br>      tlo = t(klo,icol) * (<span class="hljs-number">1.</span> + <span class="hljs-number">0.608</span> * scalars(index_qv,klo,icol))<br>      thi = t(khi,icol) * (<span class="hljs-number">1.</span> + <span class="hljs-number">0.608</span> * scalars(index_qv,khi,icol))<br>      zlo = <span class="hljs-number">0.5</span>*(height(klo,icol)+height(klo+<span class="hljs-number">1</span>,icol))<br>      zhi = <span class="hljs-number">0.5</span>*(height(khi,icol)+height(khi+<span class="hljs-number">1</span>,icol))<br>  <br>      p_at_pconst = p(<span class="hljs-number">1</span>,icol) - pconst<br>      t_at_pconst = thi-(thi-tlo)*<span class="hljs-built_in">log</span>(p_at_pconst/phi)*<span class="hljs-built_in">log</span>(plo/phi)<br>      z_at_pconst = zhi-(zhi-zlo)*<span class="hljs-built_in">log</span>(p_at_pconst/phi)*<span class="hljs-built_in">log</span>(plo/phi)<br>  <br>      t_surf(icol) = t_at_pconst*(p(<span class="hljs-number">1</span>,icol)/p_at_pconst)**(<span class="hljs-built_in">gamma</span>*rr/grav)<br>      t_msl(icol) = t_at_pconst+<span class="hljs-built_in">gamma</span>*z_at_pconst<br>  <br>   <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br>  <br>  <span class="hljs-comment">! If we follow a traditional computation, there is a correction to the sea level</span><br>  <span class="hljs-comment">! temperature if both the surface and sea level temnperatures are *too* hot.</span><br>  <br>   <span class="hljs-keyword">if</span> ( mm5_test ) <span class="hljs-keyword">then</span><br>      kcount = <span class="hljs-number">0</span><br>      <span class="hljs-keyword">do</span> icol = <span class="hljs-number">1</span> , ncol<br>            l1 = t_msl(icol) <span class="hljs-keyword">.lt.</span> tc<br>            l2 = t_surf(icol) <span class="hljs-keyword">.le.</span> tc<br>            l3 = <span class="hljs-keyword">.not.</span> l1<br>            <span class="hljs-keyword">if</span> ( l2 <span class="hljs-keyword">.and.</span> l3 ) <span class="hljs-keyword">then</span><br>               t_msl(icol) = tc<br>            <span class="hljs-keyword">else</span><br>               t_msl(icol) = tc - <span class="hljs-number">0.005</span>*(t_surf(icol)-tc)**<span class="hljs-number">2</span><br>               kcount = kcount+<span class="hljs-number">1</span><br>            <span class="hljs-keyword">end</span> <span class="hljs-keyword">if</span><br>      <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br>  <span class="hljs-comment">!   call mpas_log_write(&#x27;These number of points had t_msl adjusted $i&#x27;, intArgs=(/kcount/))</span><br>   <span class="hljs-keyword">end</span> <span class="hljs-keyword">if</span><br>  <br>   <span class="hljs-keyword">do</span> icol = <span class="hljs-number">1</span> , ncol<br>      z_half_lowest=<span class="hljs-number">0.5</span>*(height(<span class="hljs-number">1</span>,icol)+height(<span class="hljs-number">2</span>,icol))<br>      slp(icol) = p(<span class="hljs-number">1</span>,icol) * <span class="hljs-built_in">exp</span>((<span class="hljs-number">2.</span>*grav*z_half_lowest)/ &amp;<br>                                (rr*(t_msl(icol)+t_surf(icol))))<br>   <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br>  <br>   <span class="hljs-keyword">if</span> (<span class="hljs-built_in">allocated</span>(level))  <span class="hljs-built_in">deallocate</span>(level)<br>   <span class="hljs-keyword">if</span> (<span class="hljs-built_in">allocated</span>(t_surf)) <span class="hljs-built_in">deallocate</span>(t_surf)<br>   <span class="hljs-keyword">if</span> (<span class="hljs-built_in">allocated</span>(t_msl))  <span class="hljs-built_in">deallocate</span>(t_msl)<br>   <br><span class="hljs-keyword">end</span> <span class="hljs-function"><span class="hljs-keyword">subroutine</span></span> compute_slp<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<h1 id="全球多年平均海平面氣壓圖">全球多年平均海平面氣壓圖</h1>
<ul>
<li><a target="_blank" rel="noopener" href="https://psl.noaa.gov/mddb2/makePlot.html?variableID=158395&amp;fileID=1449936" class="uri">https://psl.noaa.gov/mddb2/makePlot.html?variableID=158395&amp;fileID=1449936</a>
<ul>
<li>從NOAA官網上直接用了再分析數據在線上匯出了一月與七月的全球多年平均海平面氣壓圖</li>
</ul></li>
</ul>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-05eef982" role="button" aria-expanded="false" aria-controls="collapse-05eef982">
        <div class="fold-arrow">▶</div>全球多年平均海平面氣壓圖
      </div>
      <div class="fold-collapse collapse" id="collapse-05eef982">
        <div class="fold-content">
          <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#</span><br><span class="hljs-comment"># for mslp, long term monthly mean</span><br><span class="hljs-comment">#</span><br><br><span class="hljs-keyword">if</span> [[ 1 ]]; <span class="hljs-keyword">then</span><br>    <span class="hljs-keyword">for</span> MM <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">seq</span> 1 1 12); <span class="hljs-keyword">do</span><br>        tmp_MM=$(<span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%02d&quot;</span> <span class="hljs-variable">$&#123;MM&#125;</span>)<br>        wget <span class="hljs-string">&quot;https://psl.noaa.gov/cgi-bin/mddb2/plot.pl?doplot=1&amp;varID=158395&amp;fileID=1449936&amp;itype=2&amp;variable=slp&amp;levelType=Sea%20Level&amp;level_units=&amp;level=Sea%20Level&amp;timetype=mon&amp;fileTimetype=mon&amp;year1=3810&amp;month1=<span class="hljs-variable">$&#123;MM&#125;</span>&amp;day1=2&amp;hr1=00%20Z&amp;year2=3810&amp;month2=1&amp;day2=2&amp;hr2=00%20Z&amp;vectorPlot=0&amp;contourLevel=auto&amp;cint=4&amp;lowr=0&amp;highr=200&amp;colormap=default&amp;reverseColormap=no&amp;contourlines=1&amp;colorlines=1&amp;contourfill=1&amp;contourlabels=1&amp;removezonal=0&amp;boundary=Geophysical&amp;projection=CylindricalEquidistant&amp;region=All&amp;area_north=90&amp;area_west=0&amp;area_east=360&amp;area_south=-90&amp;centerLat=0.0&amp;centerLon=270.0&amp;mapfill=0&quot;</span> -O mslp_MM<span class="hljs-variable">$&#123;tmp_MM&#125;</span>.png<br>    <span class="hljs-keyword">done</span><br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<p><img src="https://i.imgur.com/kFvyZQr.png" srcset="/img/loading.gif" lazyload /> <img src="https://i.imgur.com/qJAq2VG.png" srcset="/img/loading.gif" lazyload /></p>
<ul>
<li>可以看到，南極地區並不是低壓而是一直處於<strong>相對高壓</strong>之中，這跟高中課本上講的極地高壓也是吻合的！</li>
<li>不過從這兩張圖裡面，我們也可以看到南北半球的一些區別，比如說南半球靠近極地的地區氣壓梯度非常大，這是由於南半球靠近極地的地方海陸的緯向分佈非常均一。</li>
<li><strong>簡單的三圈環流模型是建立在地球下墊面均一的基礎上的</strong>，在這種情況下我們可以得到與維圈平行的各個風帶、氣壓帶。但是在現實中，<strong>海陸分佈的不均一性進而引起下墊面熱力性質的差異</strong>，導致在理想的氣壓帶分佈的基礎上，夏季時陸地氣壓更低、海洋氣壓更高；冬季時陸地氣壓更高、海洋氣壓更低。</li>
<li>海陸的緯向分佈如果不均勻到一定程度，甚至會導致原來的平行氣壓帶根本就不太明顯（如北半球）。但是在南半球靠近極地的地方，基本上同一個緯度基本上呢不是海洋（南太平洋、南印度洋、南大西洋）就是大塊的陸地（南極大陸），這種分佈有利於不同緯度形成穩定的平均氣壓差，所以我們就可以看到60°S那一塊基本上就是副極地低壓，而南極基本上就是高壓。而在七月（南半球冬季），60°S的海洋加劇了副極地低壓、南極大陸加劇了極地高壓，<strong>氣壓梯度就更加明顯，甚至形成了非常強的風帶－（南極）極渦</strong>。</li>
</ul>
<h1 id="references">References</h1>
<ol type="1">
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/285571457/answer/963558274">为什么南极的海平面气压值低于其他地方？ - mosekyo的回答 - 知乎</a></li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Meteorology/" class="category-chain-item">Meteorology</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/NWP/" class="print-no-link">#NWP</a>
      
        <a href="/tags/WRF/" class="print-no-link">#WRF</a>
      
        <a href="/tags/MPAS/" class="print-no-link">#MPAS</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Mean sea level pressure | 平均海平面氣壓</div>
      <div>https://waipangsze.github.io/2025/05/30/Sea-level-pressure/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>wpsze</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>May 30, 2025</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Updated on</div>
          <div>May 30, 2025</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/05/31/Tephigram/" title="Tephigram | 溫熵圖">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Tephigram | 溫熵圖</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/05/28/NWP-MPAS-WRF-Land-Use-Land-Cover-and-Soil-Type/" title="NWP | MPAS | WRF| Land Use/Land Cover and Soil Type">
                        <span class="hidden-mobile">NWP | MPAS | WRF| Land Use/Land Cover and Soil Type</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9HL36SZ28R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9HL36SZ28R');
</script>

    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">

  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  

  <span id="sitetime"></span>
  <script language=javascript>
    function siteTime(){
      window.setTimeout("siteTime()", 1000);
      var seconds = 1000;
      var minutes = seconds * 60;
      var hours = minutes * 60;
      var days = hours * 24;
      var years = days * 365;
      var today = new Date();
      var todayYear = today.getFullYear();
      var todayMonth = today.getMonth()+1;
      var todayDate = today.getDate();
      var todayHour = today.getHours();
      var todayMinute = today.getMinutes();
      var todaySecond = today.getSeconds();
      /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
      year - 作为date对象的年份，为4位年份值
      month - 0-11之间的整数，做为date对象的月份
      day - 1-31之间的整数，做为date对象的天数
      hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
      minutes - 0-59之间的整数，做为date对象的分钟数
      seconds - 0-59之间的整数，做为date对象的秒数
      microseconds - 0-999之间的整数，做为date对象的毫秒数 */
      var t1 = Date.UTC(2023,04,23,00,00,00); //北京时间2018-2-13 00:00:00
      var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
      var diff = t2-t1;
      var diffYears = Math.floor(diff/years);
      var diffDays = Math.floor((diff/days)-diffYears*365);
      var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
      var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
      var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
      /*document.getElementById("sitetime").innerHTML=" 已运行"+/*diffYears+" 年 "+*/diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
      document.getElementById("sitetime").innerHTML=" 已運行"+diffYears+" 年 "+diffDays+" 天 ";
    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
  </script>
  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
