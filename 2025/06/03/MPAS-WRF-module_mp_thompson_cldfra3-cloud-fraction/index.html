

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="wpsze">
  <meta name="keywords" content="">
  
    <meta name="description" content="Cloud fraction Cloud fraction is an important variable in numerical weather prediction (NWP) models that help to improve the accuracy of weather forecasts. It is a measure of the fraction of the sky t">
<meta property="og:type" content="article">
<meta property="og:title" content="MPAS | WRF | cloud fraction | module_mp_thompson_cldfra3">
<meta property="og:url" content="https://waipangsze.github.io/2025/06/03/MPAS-WRF-module_mp_thompson_cldfra3-cloud-fraction/index.html">
<meta property="og:site_name" content="wpsze">
<meta property="og:description" content="Cloud fraction Cloud fraction is an important variable in numerical weather prediction (NWP) models that help to improve the accuracy of weather forecasts. It is a measure of the fraction of the sky t">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.imgur.com/yfZReoj.png">
<meta property="article:published_time" content="2025-06-03T00:04:00.000Z">
<meta property="article:modified_time" content="2025-06-03T06:27:07.644Z">
<meta property="article:author" content="wpsze">
<meta property="article:tag" content="NWP">
<meta property="article:tag" content="MPAS">
<meta property="article:tag" content="WRF">
<meta property="article:tag" content="cloud fraction">
<meta property="article:tag" content="icloud">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.imgur.com/yfZReoj.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>MPAS | WRF | cloud fraction | module_mp_thompson_cldfra3 - wpsze</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"waipangsze.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":"F7MK-FcxSomhtc1N3hIUDA"},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=F7MK-FcxSomhtc1N3hIUDA", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', 'F7MK-FcxSomhtc1N3hIUDA');
        });
      }
    </script>
  

  

  

  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>wpsze</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>Links</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/bookmark/" target="_self">
                <i class="iconfont icon-bookmark"></i>
                <span>Bookmarks</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                <span>Docs</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Physics/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Physics</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Maths/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Maths</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/CFD/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>CFD</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/ML/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>ML</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Meteorology/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Meteorology</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/MPAS/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>MPAS</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/PALM/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>PALM</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/monitor/" target="_self">
                    
                    <span>Real Time Monitoring</span>
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About Me</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://i.imgur.com/yfZReoj.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="MPAS | WRF | cloud fraction | module_mp_thompson_cldfra3"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-06-03 08:04" pubdate>
          June 3, 2025 am
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          459 words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          4 mins
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> views
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">MPAS | WRF | cloud fraction | module_mp_thompson_cldfra3</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="cloud-fraction">Cloud fraction</h1>
<p>Cloud fraction is an important variable in numerical weather prediction (NWP) models that help to improve the accuracy of weather forecasts. It is a measure of the fraction of the sky that is covered by clouds and is typically used to describe the amount of cloud cover at a given location and time. Accurate estimates of cloud fraction are essential for a wide range of applications in meteorology and climate science, including weather forecasting, climate modeling, and aviation safety.</p>
<ul>
<li>In NWP models, cloud fraction is typically calculated using output from the model's microphysics parameterization schemes. These schemes simulate the formation and evolution of cloud droplets and ice crystals and produce output variables that can be used to estimate cloud cover. The model output may include variables such as cloud water content, cloud ice content, and cloud optical thickness, which can be used to calculate cloud fraction using various algorithms and assumptions.</li>
<li>In general, accurate estimates of cloud fraction are essential for improving the accuracy of weather forecasts and for understanding the complex interactions between clouds, radiation, and the atmosphere.</li>
</ul>
<h2 id="impact-of-cloud-fraction-on-short-wave-radition">Impact of cloud fraction on short wave radition</h2>
<p><strong>Clouds have a significant impact on the amount of shortwave radiation that reaches the Earth's surface.</strong> When there are no clouds, most of the incoming solar radiation reaches the surface, causing it to warm up. However, when there are clouds, they reflect some of the incoming solar radiation back into space, reducing the amount of shortwave radiation that reaches the Earth's surface. The amount of shortwave radiation that is reflected by clouds depends on the cloud fraction, as a higher cloud fraction means more incoming solar radiation is reflected back into space.</p>
<figure>
<img src="https://i.imgur.com/bKcnSYR.png" srcset="/img/loading.gif" lazyload alt="https://visibleearth.nasa.gov/images/54219/cloud-effects-on-earths-radiation" width="400" /><figcaption>https://visibleearth.nasa.gov/images/54219/cloud-effects-on-earths-radiation</figcaption>
</figure>
<h1 id="the-formulation-cloud-fraction-options-in-wrf-and-mpas">The formulation cloud fraction options in WRF and MPAS</h1>
<h2 id="wrf">WRF</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs namelist">icloud = 1,	! cloud effect to the optical depth in radiation<br>            (only works for ra_sw_physics = 1,4 and ra_lw_physics = 1,4)<br>            Since 3.6, this also controls the cloud fraction options<br>            1 = with cloud effect, and use cloud fraction option 1<br>                (Xu-Randall method) <br>            0 = without cloud effect<br>            2 = with cloud effect, and use cloud fraction option 2 (0/1 based<br>                on threshold<br>            3 = with cloud effect, and use cloud fraction option 3, based on<br>                Sundqvist et al. (1989) (since 3.7)<br></code></pre></td></tr></table></figure>
<h2 id="mpas">MPAS</h2>
<ul>
<li><strong>core_atmosphere/Registry.xml</strong> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">nml_option</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;config_radt_cld_scheme&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;character&quot;</span> <span class="hljs-attr">default_value</span>=<span class="hljs-string">&quot;suite&quot;</span> <span class="hljs-attr">in_defaults</span>=<span class="hljs-string">&quot;false&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">units</span>=<span class="hljs-string">&quot;-&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">description</span>=<span class="hljs-string">&quot;configuration for calculation of horizontal cloud fraction&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">possible_values</span>=<span class="hljs-string">&quot;`suite&#x27;,`cld_fraction&#x27;,`cld_incidence&#x27;&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<figure>
<img src="https://i.imgur.com/jHwvS5d.png" srcset="/img/loading.gif" lazyload alt="src/core_atmosphere/physics/mpas_atmphys_control.F" width="400" /><figcaption>src/core_atmosphere/physics/mpas_atmphys_control.F</figcaption>
</figure>
<ul>
<li>core_atmosphere/physics/<strong>mpas_atmphys_driver_cloudiness.F</strong></li>
</ul>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs fortran"><span class="hljs-comment">! * since we removed the local variable radt_cld_scheme from mpas_atmphys_vars.F, now defines radt_cld_scheme</span><br><span class="hljs-comment">!   as a pointer to config_radt_cld_scheme.</span><br><span class="hljs-comment">!   Laura D. Fowler (laura@ucar.edu) / 2017-02-16.</span><br> <span class="hljs-keyword">call</span> mpas_pool_get_config(configs,<span class="hljs-string">&#x27;config_radt_cld_scheme&#x27;</span>,radt_cld_scheme)<br></code></pre></td></tr></table></figure>
<figure>
<img src="https://i.imgur.com/rPDQZGx.png" srcset="/img/loading.gif" lazyload alt="MPAS-Model/src/core_atmosphere/physics/mpas_atmphys_driver_cloudiness.F" width="400" /><figcaption>MPAS-Model/src/core_atmosphere/physics/mpas_atmphys_driver_cloudiness.F</figcaption>
</figure>
<div class="note note-primary">
            <ul><li><strong>call <code>calc_cldfraction</code></strong></li><li><strong>call <code>cal_cldfra3</code></strong></li></ul>
          </div>
<h1 id="icloud13">icloud=1/3</h1>
<div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/s0YY0UF.png" srcset="/img/loading.gif" lazyload /></div><div class="group-image-wrap"><img src="https://i.imgur.com/yfZReoj.png" srcset="/img/loading.gif" lazyload /></div></div><div class="group-image-row"></div></div>
<h2 id="icloud1"><strong>icloud=1</strong></h2>
<div class="note note-primary">
            <p><strong>subroutine <code>calc_cldfraction</code>(cldfrac,t_p,pres_p,qv,qc,qi,qs,its,ite)</strong></p>
          </div>
<ul>
<li><a target="_blank" rel="noopener" href="https://journals.ametsoc.org/view/journals/apme/6/1/1520-0450_1967_006_0203_otcosv_2_0_co_2.xml">Murray, F. W., 1967: <strong>On the Computation of Saturation Vapor Pressure</strong>. J. Appl. Meteor. Climatol., 6, 203–204, https://doi.org/10.1175/1520-0450(1967)006&lt;0203:OTCOSV&gt;2.0.CO;2.</a>
<ul>
<li><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/jvJfyhN.png" srcset="/img/loading.gif" lazyload /></div><div class="group-image-wrap"><img src="https://i.imgur.com/EnbLy9X.png" srcset="/img/loading.gif" lazyload /></div><div class="group-image-wrap"><img src="https://i.imgur.com/z26qu5e.png" srcset="/img/loading.gif" lazyload /></div></div></div></li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://hogback.atmos.colostate.edu/pubs/XuandRandall-semiempirical-1996.pdf">Xu, Kuan-Man, and Randall, D A. 1996. "<strong>A semiempirical cloudiness parameterization for use in climate models</strong>". United States. https://doi.org/10.1175/1520-0469(1996)053&lt;3084:ASCPFU&gt;2.0.CO;2.</a>
<ul>
<li>Xu and Krueger (1991) further divided the total cloud amount into <strong>convective</strong> (<span class="math inline">\(C_c\)</span>) and <strong>stratiform components</strong> (<span class="math inline">\(C_s\)</span>) using the cloud mass flux deviation at a given level as the criterion.</li>
<li><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/iinWHIz.png" srcset="/img/loading.gif" lazyload /></div><div class="group-image-wrap"><img src="https://i.imgur.com/cQ7niLL.png" srcset="/img/loading.gif" lazyload /></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/0iotWVj.png" srcset="/img/loading.gif" lazyload /></div><div class="group-image-wrap"><img src="https://i.imgur.com/SCXM2No.png" srcset="/img/loading.gif" lazyload /></div></div></div></li>
</ul></li>
</ul>
<h2 id="icloud3"><strong>icloud=3</strong></h2>
<div class="note note-primary">
            <p><strong>call <code>cal_cldfra3</code></strong>( &amp; cldfra = cldfrac_p , qv = qvrad_p , qc = qcrad_p , qi = qirad_p , &amp; qs = qsrad_p , p = pres_hyd_p , t = t_p , rho = rho_p , &amp; xland = xland_p , gridkm = dx_p , &amp; ids = ids , ide = ide , jds = jds , jde = jde , kds = kds , kde = kde , &amp; ims = ims , ime = ime , jms = jms , jme = jme , kms = kds , kme = kme , &amp; its = its , ite = ite , jts = jts , jte = jte , kts = kts , kte = kte &amp; )</p>
          </div>
<div class="note note-primary">
            <p>!+---+-----------------------------------------------------------------+<br />!.. Cloud fraction scheme by G. Thompson (NCAR-RAL), not intended for<br />!.. combining with any cumulus or shallow cumulus parameterization<br />!.. scheme cloud fractions. This is intended as a stand-alone for<br />!.. cloud fraction and is relatively good at getting widespread stratus<br />!.. and stratoCu without caring whether any deep/shallow Cu param schemes<br />!.. is making sub-grid-spacing clouds/precip. Under the hood, this<br />!.. scheme follows <strong>Mocko and Cotton (1995)</strong> in applicaiton of the<br />!.. <strong>Sundqvist et al (1989)</strong> scheme but using a grid-scale dependent<br />!.. RH threshold, one each for land v. ocean points based on<br />!.. experiences with HWRF testing.<br /></p><ul><li>using a <strong>grid-scale dependent</strong> RH threshold</li></ul>
          </div>
<ul>
<li><a target="_blank" rel="noopener" href="https://rams.atmos.colostate.edu/cotton/vita/90.pdf">Mocko, David M., and William R. Cotton. "<strong>Evaluation of fractional cloudiness parameterizations for use in a mesoscale model</strong>." Journal of Atmospheric Sciences 52.16 (1995): 2884-2901.</a>
<ul>
<li>For purposes of examining the feasibility of diagnosing <strong>fractional cloudiness (FC)</strong>, <em>many different FC schemes readily found</em> in the atmospheric science literature were evaluated.</li>
<li><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/nhUcUvk.png" srcset="/img/loading.gif" lazyload /></div><div class="group-image-wrap"><img src="https://i.imgur.com/Ww5cGSp.png" srcset="/img/loading.gif" lazyload /></div></div><div class="group-image-row"></div></div></li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://doi.org/10.1175/1520-0493(1989)117">Sundqvist, Hilding, Erik Berge, and Jón Egill Kristjánsson. "<strong>Condensation and Cloud Parameterization Studies with a Mesoscale Numerical Weather Prediction Model</strong>", Monthly Weather Review 117, 8 (1989): 1641-1657, doi: https://doi.org/10.1175/1520-0493(1989)117&lt;1641:CACPSW&gt;2.0.CO;2</a>
<ul>
<li><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/EI0RgnY.png" srcset="/img/loading.gif" lazyload /></div><div class="group-image-wrap"><img src="https://i.imgur.com/IuRNIwX.png" srcset="/img/loading.gif" lazyload /></div></div><div class="group-image-row"></div></div></li>
</ul></li>
</ul>
<h1 id="wrf-mpas-a-support-forum">WRF &amp; MPAS-A Support Forum</h1>
<ul>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/cloud-fraction-limit-to-0-9-in-module_mp_thompson_cldfra3.16847/">Cloud fraction limit to 0.9 in <strong>module_mp_thompson_cldfra3</strong> | Apr 23, 2024</a>
<ul>
<li>The routine <code>cal_cldfrac3</code> limits the <strong>maximum value of cloud fraction to 0.9 (see line 134)</strong>. Is there a plausible reason for that, or is this just a mistype?</li>
<li><strong>Ming Chen:</strong> Please see whether you can find information in the paper: <a target="_blank" rel="noopener" href="https://journals.ametsoc.org/doi/10.1175/2008MWR2387.1">hompson, Gregory, Paul R. Field, Roy M. Rasmussen, William D. Hall, 2008: Explicit Forecasts of Winter Precipitation Using an Improved Bulk Microphysics Scheme. Part II: Implementation of a New Snow Parameterization. Mon. Wea. Rev., 136, 5095–5115. doi:10.1175/2008MWR2387.1</a></li>
<li><strong>Ming Chen:</strong> I explore this issue a bit more. What I found is that,
<ul>
<li><strong>based on some NCEP-EMC tests, the icloud3 option made far too many clouds when compared to observations.</strong></li>
<li>I guess this could be the <strong>reason</strong> that <code>cal_cldfrac3</code> limits the maximum value of cloud fraction to 0.9.</li>
<li>However, I didn't find any publications that specifically address this issue.</li>
<li>I believe <strong>you can tune the model behavior by modifying the maximum value of cloud fraction</strong> at line 134. Hope this is helpful for you.</li>
</ul></li>
<li>I also found in <strong>my experiments that this formulation overestimates the cloud fraction</strong>, which results in poor energy balance on the surface in the Amazon basin.</li>
<li>When <code>cal_cldfrac3</code> limits the maximum value of cloud fraction from 0.9 to a Smaller values, WRF will overestimates the cloud fraction to a lesser extent ？</li>
<li><strong>Ming Chen:</strong> This is what is expected. However, I have to say that it may be case-dependent. <strong>if your case still shows large overestimation, you may need to further reduce the maximum cldfra value.</strong></li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/cldfrac_tot_upp-is-zero-at-the-first-time-step.20392/#post-49704">cldfrac_tot_UPP is zero at the first time step | Dec 26, 2024</a>
<ul>
<li>Yes this is an expected behavior. <strong><code>cldfrac_tot_UPP</code> is a diagnostic variable that is calculated based on <code>cldfrc</code></strong>.</li>
<li><strong>At the initial time, both are set to zero</strong>.</li>
<li><strong>MPAS doesn't calculate cldfra in the first time step</strong> because it is based on other physical variables like <strong>qc,qi, rh etc</strong>. <strong>Some of these variables are not available at the beginning of model run</strong>. For this reason, I don't think it is practical to diagnose cldfra at the initial time.</li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/cldfra-vs-qcloud-variables.15170/#post-38214">CLDFRA vs QCLOUD variables | Jan 6, 2024</a>
<ul>
<li><strong><code>CLDFRA</code> is calculated in radiation driver</strong>. Therefore, <strong>it is updated at the time of radiation calculation</strong>, which is determined by the namelist option radt. If you want to have this variable at every time step, you will need to set radt equal to time step. However, we won't recommend doing so because radiation schemes are computationally expensive.</li>
</ul></li>
</ul>
<h1 id="references">References</h1>
<ol type="1">
<li><a target="_blank" rel="noopener" href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2012GL054031">Alapaty, Kiran, et al. "<strong>Introducing subgrid‐scale cloud feedbacks to radiation for regional meteorological and climate modeling</strong>." Geophysical Research Letters 39.24 (2012).</a></li>
<li><a target="_blank" rel="noopener" href="https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/2000JD900415">Pal, Jeremy &amp; Small, Eric &amp; Eltahir, Elfatih. (2000). <strong>Simulation of regional-scale water and energy budgets: Representation of subgrid cloud and precipitation processes within RegCM</strong>. Journal of Geophysical Research. 105. 10.1029/2000JD900415.</a>
<ol type="1">
<li><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/wOOXq8g.png" srcset="/img/loading.gif" lazyload /></div><div class="group-image-wrap"><img src="https://i.imgur.com/5yyN5zM.png" srcset="/img/loading.gif" lazyload /></div></div><div class="group-image-row"></div></div></li>
</ol></li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/MPAS/" class="category-chain-item">MPAS</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/NWP/" class="print-no-link">#NWP</a>
      
        <a href="/tags/MPAS/" class="print-no-link">#MPAS</a>
      
        <a href="/tags/WRF/" class="print-no-link">#WRF</a>
      
        <a href="/tags/cloud-fraction/" class="print-no-link">#cloud fraction</a>
      
        <a href="/tags/icloud/" class="print-no-link">#icloud</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>MPAS | WRF | cloud fraction | module_mp_thompson_cldfra3</div>
      <div>https://waipangsze.github.io/2025/06/03/MPAS-WRF-module_mp_thompson_cldfra3-cloud-fraction/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>wpsze</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>June 3, 2025</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Updated on</div>
          <div>June 3, 2025</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/06/03/Somali-Jet/" title="Somali Jet | 索馬里急流">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Somali Jet | 索馬里急流</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/06/02/ENSO/" title="ENSO | El Niño and La Niña | 厄爾尼諾/拉尼娜">
                        <span class="hidden-mobile">ENSO | El Niño and La Niña | 厄爾尼諾/拉尼娜</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9HL36SZ28R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9HL36SZ28R');
</script>

    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">

  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  

  <span id="sitetime"></span>
  <script language=javascript>
    function siteTime(){
      window.setTimeout("siteTime()", 1000);
      var seconds = 1000;
      var minutes = seconds * 60;
      var hours = minutes * 60;
      var days = hours * 24;
      var years = days * 365;
      var today = new Date();
      var todayYear = today.getFullYear();
      var todayMonth = today.getMonth()+1;
      var todayDate = today.getDate();
      var todayHour = today.getHours();
      var todayMinute = today.getMinutes();
      var todaySecond = today.getSeconds();
      /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
      year - 作为date对象的年份，为4位年份值
      month - 0-11之间的整数，做为date对象的月份
      day - 1-31之间的整数，做为date对象的天数
      hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
      minutes - 0-59之间的整数，做为date对象的分钟数
      seconds - 0-59之间的整数，做为date对象的秒数
      microseconds - 0-999之间的整数，做为date对象的毫秒数 */
      var t1 = Date.UTC(2023,04,23,00,00,00); //北京时间2018-2-13 00:00:00
      var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
      var diff = t2-t1;
      var diffYears = Math.floor(diff/years);
      var diffDays = Math.floor((diff/days)-diffYears*365);
      var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
      var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
      var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
      /*document.getElementById("sitetime").innerHTML=" 已运行"+/*diffYears+" 年 "+*/diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
      document.getElementById("sitetime").innerHTML=" 已運行"+diffYears+" 年 "+diffDays+" 天 ";
    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
  </script>
  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
