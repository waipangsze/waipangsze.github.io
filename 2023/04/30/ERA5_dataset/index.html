

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="wpsze">
  <meta name="keywords" content="">
  
    <meta name="description" content="ERA5 dataset It is imperative to complete the registration process on the Copernicus Climate Data Store by creating an account. Some related links, WRF using ERA5 data  Climate Data Store - Copernicus">
<meta property="og:type" content="article">
<meta property="og:title" content="ERA5 dataset">
<meta property="og:url" content="https://waipangsze.github.io/2023/04/30/ERA5_dataset/index.html">
<meta property="og:site_name" content="wpsze">
<meta property="og:description" content="ERA5 dataset It is imperative to complete the registration process on the Copernicus Climate Data Store by creating an account. Some related links, WRF using ERA5 data  Climate Data Store - Copernicus">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://www.ecmwf.int/sites/default/files/flags-council-chamber-650px.jpg">
<meta property="article:published_time" content="2023-04-29T16:00:00.000Z">
<meta property="article:modified_time" content="2024-11-12T01:21:41.983Z">
<meta property="article:author" content="wpsze">
<meta property="article:tag" content="WRF">
<meta property="article:tag" content="WPS">
<meta property="article:tag" content="MPAS">
<meta property="article:tag" content="IC&#x2F;BC">
<meta property="article:tag" content="ERA5">
<meta property="article:tag" content="ECMWF">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://www.ecmwf.int/sites/default/files/flags-council-chamber-650px.jpg">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>ERA5 dataset - wpsze</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"waipangsze.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>wpsze</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>Links</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/bookmark/" target="_self">
                <i class="iconfont icon-bookmark"></i>
                <span>Bookmarks</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                <span>Docs</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Physics/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Physics</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Maths/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Maths</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/CFD/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>CFD</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/ML/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>ML</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Meteorology/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Meteorology</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/MPAS/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>MPAS</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/monitor/" target="_self">
                    
                    <span>Real Time Monitoring</span>
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About Me</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://www.ecmwf.int/sites/default/files/flags-council-chamber-650px.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="ERA5 dataset"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-04-30 00:00" pubdate>
          April 30, 2023 am
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          921 words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          8 mins
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> views
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">ERA5 dataset</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="era5-dataset">ERA5 dataset</h1>
<p>It is imperative to complete the registration process on the Copernicus Climate Data Store by creating an account.</p>
<p>Some related links,</p>
<p><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/wrf-using-era5-data.12116/">WRF using ERA5 data</a></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://cds.climate.copernicus.eu/">Climate Data Store - Copernicus</a></li>
<li><a target="_blank" rel="noopener" href="https://rda.ucar.edu/datasets/ds633.0/dataaccess/">ERA5 (UCAR) ERA5 Reanalysis (0.25 Degree Latitude-Longitude Grid) ds633.0 DOI: 10.5065/BH6N-5N20</a></li>
<li><a target="_blank" rel="noopener" href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-single-levels?tab=overview">ERA5 hourly data on single levels from 1940 to present</a></li>
<li><a target="_blank" rel="noopener" href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-pressure-levels?tab=overview">ERA5 hourly data on pressure levels from 1940 to present</a></li>
</ul>
<h2 id="required-meteorological-fields-for-running-wrf">Required Meteorological Fields for Running WRF</h2>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www2.mmm.ucar.edu/wrf/users/docs/user_guide_v4/v4.1/users_guide_chap3.html#_Required_Meteorological_Fields">user_guide_v4/v4.1/users_guide_chap3.html#_Required_Meteorological_Fields</a></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sh">3D Data (e.g. data on pressure levels)<br>	Temperature<br>	U and V components of Wind<br>	Geopotential Height<br>	Relative Humidity (the code can calculate RH <span class="hljs-keyword">if</span> Specific Humidity is available;this is controlled <span class="hljs-keyword">in</span> the Vtable)<br><br>2D Data<br>	Surface Pressure<br>	Mean Sea Level Pressure<br>	Skin Temperature/SST<br>	2-meter Temperature<br>	2-meter Relative or Specific Humidity<br>	10-meter U and V components of wind<br>	Soil data (temperature and moisture) and soil height	<br>If any masked field is ingested, <span class="hljs-keyword">then</span> a LANDSEA field is recommended<br>Water equivalent snow depth (SNOW) is a <span class="hljs-built_in">nice</span> field to have, but not required.<br>SEAICE is good to have <span class="hljs-keyword">for</span> a high latitude winter <span class="hljs-keyword">case</span>, but it is not required.<br></code></pre></td></tr></table></figure>
<h2 id="shell-script">Shell script</h2>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-comment"># source requried packages</span><br><span class="hljs-built_in">source</span> /home/wpsze/anaconda3/bin/activate venv<br><br>yyyy=<span class="hljs-string">&#x27;2022&#x27;</span><br>mm=<span class="hljs-string">&#x27;06&#x27;</span><br><span class="hljs-built_in">dd</span>=<span class="hljs-string">&#x27;26&#x27;</span><br>hh=<span class="hljs-string">&#x27;18&#x27;</span><br><br><span class="hljs-keyword">for</span> next_hh <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">seq</span> 0 3 36); <span class="hljs-keyword">do</span> <span class="hljs-comment"># Forecast time = 12, 24, 36, 48, 60, 72, 84, 96, 108, 130</span><br>	NEXT_DATE=$(TZ=UTC <span class="hljs-built_in">date</span> -d <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;yyyy&#125;</span>-<span class="hljs-variable">$&#123;mm&#125;</span>-<span class="hljs-variable">$&#123;dd&#125;</span>T<span class="hljs-variable">$&#123;hh&#125;</span>:00:00Z +<span class="hljs-variable">$next_hh</span> hour&quot;</span> +%Y%m%d%H)<br>	<span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;NEXT_DATE&#125;</span><br><br>	<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;downloading &quot;</span> <span class="hljs-variable">$&#123;NEXT_DATE&#125;</span><br>	SLoutfile=<span class="hljs-string">&quot;ERA5-0p25-SL-<span class="hljs-variable">$&#123;NEXT_DATE&#125;</span>.grib&quot;</span><br>	PLoutfile=<span class="hljs-string">&quot;ERA5-0p25-PL-<span class="hljs-variable">$&#123;NEXT_DATE&#125;</span>.grib&quot;</span><br>	resolution=<span class="hljs-string">&quot;0.25&quot;</span><br><br>	python ERA5-sl.py <span class="hljs-variable">$&#123;NEXT_DATE&#125;</span> <span class="hljs-variable">$&#123;SLoutfile&#125;</span> <span class="hljs-variable">$&#123;resolution&#125;</span><br>	python ERA5-pl.py <span class="hljs-variable">$&#123;NEXT_DATE&#125;</span> <span class="hljs-variable">$&#123;PLoutfile&#125;</span> <span class="hljs-variable">$&#123;resolution&#125;</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure>
<h2 id="era5-sl.py">ERA5-sl.py</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment"># Retrieve ERA5 data on single levels(sl)</span><br><span class="hljs-keyword">import</span> argparse<br>parser = argparse.ArgumentParser()<br>parser.add_argument(<span class="hljs-string">&quot;datetime_string&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Datetime string of the downloaded data in format YYYYMMDDHH&quot;</span>, <span class="hljs-built_in">type</span>=<span class="hljs-built_in">str</span>)<br>parser.add_argument(<span class="hljs-string">&quot;ofile&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Output file of the downloaded data, e.g. ERA5-SL-YYYYMMDDHH.grib&quot;</span>, <span class="hljs-built_in">type</span>=<span class="hljs-built_in">str</span>)<br>parser.add_argument(<span class="hljs-string">&quot;resoln&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Horizontal resolution of the downloaded data (in degree), e.g. 0.25&quot;</span>, <span class="hljs-built_in">type</span>=<span class="hljs-built_in">str</span>)<br>args = parser.parse_args()<br><br><span class="hljs-keyword">import</span> datetime<br>datetime_object = datetime.datetime.strptime(args.datetime_string, <span class="hljs-string">&quot;%Y%m%d%H&quot;</span>)<br>yyyy = datetime_object.strftime(<span class="hljs-string">&quot;%Y&quot;</span>)<br>mm = datetime_object.strftime(<span class="hljs-string">&quot;%m&quot;</span>)<br>dd = datetime_object.strftime(<span class="hljs-string">&quot;%d&quot;</span>)<br>hh = datetime_object.strftime(<span class="hljs-string">&quot;%H:00&quot;</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;================&quot;</span>, args)<br><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> logging<br><span class="hljs-keyword">import</span> cdsapi<br>c = cdsapi.Client()<br><span class="hljs-keyword">try</span>:<br>    c.retrieve(<br>        <span class="hljs-string">&quot;reanalysis-era5-single-levels&quot;</span>,<br>        &#123;<br>            <span class="hljs-string">&quot;product_type&quot;</span>: <span class="hljs-string">&quot;reanalysis&quot;</span>,<br>            <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;grib&quot;</span>,<br>            <span class="hljs-string">&quot;variable&quot;</span>: [<br>                <span class="hljs-string">&quot;10m_u_component_of_wind&quot;</span>,<br>                <span class="hljs-string">&quot;10m_v_component_of_wind&quot;</span>,<br>                <span class="hljs-string">&quot;2m_dewpoint_temperature&quot;</span>,<br>                <span class="hljs-string">&quot;2m_temperature&quot;</span>,<br>                <span class="hljs-string">&quot;land_sea_mask&quot;</span>,<br>                <span class="hljs-string">&quot;mean_sea_level_pressure&quot;</span>,<br>                <span class="hljs-string">&quot;sea_ice_cover&quot;</span>,<br>                <span class="hljs-string">&quot;sea_surface_temperature&quot;</span>,<br>                <span class="hljs-string">&quot;skin_temperature&quot;</span>,<br>                <span class="hljs-string">&quot;snow_density&quot;</span>,<br>                <span class="hljs-string">&quot;snow_depth&quot;</span>,<br>                <span class="hljs-string">&quot;soil_temperature_level_1&quot;</span>,<br>                <span class="hljs-string">&quot;soil_temperature_level_2&quot;</span>,<br>                <span class="hljs-string">&quot;soil_temperature_level_3&quot;</span>,<br>                <span class="hljs-string">&quot;soil_temperature_level_4&quot;</span>,<br>                <span class="hljs-string">&quot;surface_pressure&quot;</span>,<br>                <span class="hljs-string">&quot;volumetric_soil_water_layer_1&quot;</span>,<br>                <span class="hljs-string">&quot;volumetric_soil_water_layer_2&quot;</span>,<br>                <span class="hljs-string">&quot;volumetric_soil_water_layer_3&quot;</span>,<br>                <span class="hljs-string">&quot;volumetric_soil_water_layer_4&quot;</span>,<br>		<span class="hljs-string">&quot;geopotential&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;grid&quot;</span>: [args.resoln, args.resoln],<br>            <span class="hljs-string">&quot;year&quot;</span>: yyyy,<br>            <span class="hljs-string">&quot;month&quot;</span>: [<br>                mm<br>            ],<br>            <span class="hljs-string">&quot;day&quot;</span>: [<br>                dd<br>            ],<br>            <span class="hljs-string">&quot;time&quot;</span>: [<br>                hh<br>            ],<br>        <span class="hljs-comment">#    &quot;area&quot;:[15, 90, 10, 120], # North, West, South, East. Default: global</span><br>        &#125;,<br>        args.ofile)<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> err:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">str</span>(err) == <span class="hljs-string">&quot;no data is available within your requested subset. Request returned no data.&quot;</span>:<br>        logging.exception(err)<br>        sys.exit(<span class="hljs-number">96</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> err<br></code></pre></td></tr></table></figure>
<blockquote>
<p>Remark: + geopotential? Yes for SOILHGT field not found in intermediate file ERA5</p>
</blockquote>
<h2 id="era5-pl.py">ERA5-pl.py</h2>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/usr/bin/env python</span><br><span class="hljs-comment"># Retrieve ERA5 data on pressure level(pl)</span><br>import argparse<br>parser = argparse.ArgumentParser()<br>parser.add_argument(<span class="hljs-string">&quot;datetime_string&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Datetime string of the downloaded data in format YYYYMMDDHH&quot;</span>, <span class="hljs-built_in">type</span>=str)<br>parser.add_argument(<span class="hljs-string">&quot;ofile&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Output file of the downloaded data, e.g. ERA5-PL-YYYYMMDDHH.grib&quot;</span>, <span class="hljs-built_in">type</span>=str)<br>parser.add_argument(<span class="hljs-string">&quot;resoln&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Horizontal resolution of the downloaded data (in degree), e.g. 0.25&quot;</span>, <span class="hljs-built_in">type</span>=str)<br>args = parser.parse_args()<br><br>import datetime<br>datetime_object = datetime.datetime.strptime(args.datetime_string, <span class="hljs-string">&quot;%Y%m%d%H&quot;</span>)<br>yyyy = datetime_object.strftime(<span class="hljs-string">&quot;%Y&quot;</span>)<br>mm = datetime_object.strftime(<span class="hljs-string">&quot;%m&quot;</span>)<br><span class="hljs-built_in">dd</span> = datetime_object.strftime(<span class="hljs-string">&quot;%d&quot;</span>)<br>hh = datetime_object.strftime(<span class="hljs-string">&quot;%H:00&quot;</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;================&quot;</span>, args)<br><br>import sys<br>import logging<br>import cdsapi<br>c = cdsapi.Client()<br>try:<br>    c.retrieve(<br>        <span class="hljs-string">&quot;reanalysis-era5-pressure-levels&quot;</span>,<br>        &#123;<br>            <span class="hljs-string">&quot;product_type&quot;</span>: <span class="hljs-string">&quot;reanalysis&quot;</span>,<br>            <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;grib&quot;</span>,<br>            <span class="hljs-string">&quot;variable&quot;</span>: [<br>                <span class="hljs-string">&quot;geopotential&quot;</span>,<br>                <span class="hljs-string">&quot;relative_humidity&quot;</span>,<br>                <span class="hljs-string">&quot;specific_humidity&quot;</span>,<br>                <span class="hljs-string">&quot;temperature&quot;</span>,<br>                <span class="hljs-string">&quot;u_component_of_wind&quot;</span>,<br>                <span class="hljs-string">&quot;v_component_of_wind&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;pressure_level&quot;</span>: [<br>                <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-string">&#x27;3&#x27;</span>,<br>                <span class="hljs-string">&#x27;5&#x27;</span>, <span class="hljs-string">&#x27;7&#x27;</span>, <span class="hljs-string">&#x27;10&#x27;</span>,<br>                <span class="hljs-string">&#x27;20&#x27;</span>, <span class="hljs-string">&#x27;30&#x27;</span>, <span class="hljs-string">&#x27;50&#x27;</span>,<br>                <span class="hljs-string">&#x27;70&#x27;</span>, <span class="hljs-string">&#x27;100&#x27;</span>, <span class="hljs-string">&#x27;125&#x27;</span>,<br>                <span class="hljs-string">&#x27;150&#x27;</span>, <span class="hljs-string">&#x27;175&#x27;</span>, <span class="hljs-string">&#x27;200&#x27;</span>,<br>                <span class="hljs-string">&#x27;225&#x27;</span>, <span class="hljs-string">&#x27;250&#x27;</span>, <span class="hljs-string">&#x27;300&#x27;</span>,<br>                <span class="hljs-string">&#x27;350&#x27;</span>, <span class="hljs-string">&#x27;400&#x27;</span>, <span class="hljs-string">&#x27;450&#x27;</span>,<br>                <span class="hljs-string">&#x27;500&#x27;</span>, <span class="hljs-string">&#x27;550&#x27;</span>, <span class="hljs-string">&#x27;600&#x27;</span>,<br>                <span class="hljs-string">&#x27;650&#x27;</span>, <span class="hljs-string">&#x27;700&#x27;</span>, <span class="hljs-string">&#x27;750&#x27;</span>,<br>                <span class="hljs-string">&#x27;775&#x27;</span>, <span class="hljs-string">&#x27;800&#x27;</span>, <span class="hljs-string">&#x27;825&#x27;</span>,<br>                <span class="hljs-string">&#x27;850&#x27;</span>, <span class="hljs-string">&#x27;875&#x27;</span>, <span class="hljs-string">&#x27;900&#x27;</span>,<br>                <span class="hljs-string">&#x27;925&#x27;</span>, <span class="hljs-string">&#x27;950&#x27;</span>, <span class="hljs-string">&#x27;975&#x27;</span>,<br>                <span class="hljs-string">&#x27;1000&#x27;</span><br>            ],<br>            <span class="hljs-string">&quot;grid&quot;</span>: [args.resoln, args.resoln],<br>            <span class="hljs-string">&quot;year&quot;</span>: yyyy,<br>            <span class="hljs-string">&quot;month&quot;</span>: [<br>                mm<br>            ],<br>            <span class="hljs-string">&quot;day&quot;</span>: [<br>                <span class="hljs-built_in">dd</span><br>            ],<br>            <span class="hljs-string">&quot;time&quot;</span>: [<br>                hh<br>            ],<br>        <span class="hljs-comment">#    &quot;area&quot;:[15, 90, 10, 120], # North, West, South, East. Default: global</span><br>        &#125;,<br>        args.ofile)<br>except Exception as err:<br>    <span class="hljs-keyword">if</span> str(err) == <span class="hljs-string">&quot;no data is available within your requested subset. Request returned no data.&quot;</span>:<br>        logging.exception(err)<br>        sys.exit(96)<br>    <span class="hljs-keyword">else</span>:<br>        raise err<br><br><br></code></pre></td></tr></table></figure>
<h2 id="vtable">Vtable</h2>
<p>The Vtable that comes with WRF includes not only Vtable.ECMWF, but also Vtable.ERA-interim.pl and Vtable.ERA-interim.ml, where Vtable.ERA-interim.pl corresponds to the ERA-Interim data of the pressure level, Vtable.ERA-interim.ml corresponds to the ERA-Interim data of the model level.</p>
<h3 id="vtable.era-interim.pl">Vtable.ERA-interim.pl</h3>
<p><strong>Latest commit b5df64a on Apr 12, 2011</strong> For use with ERA-interim pressure-level output For ERA-interim data at NCAR, use the pl (sc and uv) and sfc sc files. &gt; <a target="_blank" rel="noopener" href="https://github.com/openwfm/wrf-fire/blob/master/WPS/ungrib/Variable_Tables/Vtable.ERA-interim.pl">Vtable.ERA-interim.pl</a></p>
<h3 id="vtable.ecmwf">Vtable.ECMWF</h3>
<p><strong>Latest commit 5c01f57 on Jun 12, 2010</strong> &gt; <a target="_blank" rel="noopener" href="https://github.com/openwfm/wrf-fire/blob/master/WPS/ungrib/Variable_Tables/Vtable.ECMWF">Vtable.ECMWF</a></p>
<h3 id="vtable.era-interim.ml">Vtable.ERA-interim.ml</h3>
<p><strong>Latest commit b5df64a on Apr 12, 2011</strong> For use with ERA-interim model-level output. For ERA-interim data at NCAR, use the ml (sc and uv) and sfc sc files. &gt; <a target="_blank" rel="noopener" href="https://github.com/openwfm/wrf-fire/blob/master/WPS/ungrib/Variable_Tables/Vtable.ERA-interim.ml">Vtable.ERA-interim.ml</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">ln</span> -s /xxx/ERA-interim.pl Vtable<br><br><span class="hljs-comment"># If Vtable.ERA-interim.pl works for you, I don&#x27;t think you need to switch to Vtable.ECMWRF.</span><br><span class="hljs-comment"># If not, Please use Vtable.ECMWF to ungrib ERA5 data. </span><br><span class="hljs-built_in">ln</span> -s /xxx/Vtable.ECMWF Vtable<br></code></pre></td></tr></table></figure>
<h2 id="link_grib.csh">./link_grib.csh</h2>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ ./link_grib.csh ../DATA/ERA5/*.grib<br></code></pre></td></tr></table></figure>
<h2 id="namelist.wps-setup-ungrib">namelist.wps, setup &amp;ungrib</h2>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">&amp;ungrib<br> out_format = <span class="hljs-string">&#x27;WPS&#x27;</span>,<br> prefix = <span class="hljs-string">&#x27;FILE&#x27;</span>,<br>/<br></code></pre></td></tr></table></figure>
<h2 id="ungrib.exe">./ungrib.exe</h2>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ ./ungrib.exe<br></code></pre></td></tr></table></figure>
<p>Outputs are format of <strong>FILE:2022-06-27_15</strong> that is intermediate file that are ready for WRF metgrid or MPAS init.</p>
<h2 id="error-missingincomplete-configuration-file-homexx.cdsapirc">Error: Missing/incomplete configuration file: /home/xx/.cdsapirc??</h2>
<p>The reason is that the .cdsapirc file under /home/xx/ is missing. This file contains the downloaded Key. We go to this link (https://cds.climate.copernicus.eu/api-how-to) to get it as required To our Key, if there is no registration, the key will appear directly on the right after registration. At this time, we will copy the things on the right Copy the code shown next to the file $HOME/.cdsapirc (in your Unix/Linux environment).</p>
<p>check, &gt; ll -a /home/wpsze/.cdsapirc</p>
<h2 id="soilhgt-field-not-found-in-intermediate-file-era5">SOILHGT field not found in intermediate file ERA5</h2>
<p>Besides processing the time-dependent atmospheric and land-surface ERA5 fields, I think you will also need to use ungrib to process the ERA5 invariant fields, including SOILHGT. Once you've created an intermediate file with invariant fields, you can concatenate the contents of that file to each of your time-varying intermediate files. <a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/error-while-interpolating-regional-initial-conditions-using-era-5-grib-data.12532/">link</a></p>
<p>The HGT_M value from geogrid comes from the static topographic data. The met_em files contain both that HGT_M value, which is identical to the value from geogrid, and <strong>SOILHGT, which is the terrain information coming from the input/first-guess data (e.g., GFS)</strong>. During real.exe, both are used again. The HGT value in the wrfinput* files comes from the HGT_M value and should still be the same at that time (if using the default namelist setting surface_input_source=3). <strong>real.exe also checks for SOILHGT, which is used for smoothing the coarse grid topography on domain 1 during the wrf process.</strong> <a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/soilhgt.11582/">link</a></p>
<p>Smooth_cg_topo and ERA-5 / ERA-Interim data? &gt; For ECMWF and ERA, the Vtable says it uses grib code 129 level 0 for both SOILGEO and SOILHGT. Please download ERA5 terrain data from /FS/DECS/DS630.0/e5.oper.invariant/201601/e5.oper.invariant.128_129_z.regn320sc.2016010100_2016010100.grb ERA-I terrain can be found in https://rda.ucar.edu/datasets/ds627.0/, where if you download any sfc dataset, you can find terrain data in it.<a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/smooth_cg_topo-and-era-5-era-interim-data.9323/">link</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/NWP/" class="category-chain-item">NWP</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/WRF/" class="print-no-link">#WRF</a>
      
        <a href="/tags/WPS/" class="print-no-link">#WPS</a>
      
        <a href="/tags/MPAS/" class="print-no-link">#MPAS</a>
      
        <a href="/tags/IC-BC/" class="print-no-link">#IC/BC</a>
      
        <a href="/tags/ERA5/" class="print-no-link">#ERA5</a>
      
        <a href="/tags/ECMWF/" class="print-no-link">#ECMWF</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>ERA5 dataset</div>
      <div>https://waipangsze.github.io/2023/04/30/ERA5_dataset/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>wpsze</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>April 30, 2023</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Updated on</div>
          <div>November 12, 2024</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/05/01/neovim/" title="neovim">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">neovim</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/04/30/WPS_namelist_wps_examples/" title="WRF | WPS namelist.wps Examples">
                        <span class="hidden-mobile">WRF | WPS namelist.wps Examples</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">

  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  

  <span id="sitetime"></span>
  <script language=javascript>
    function siteTime(){
      window.setTimeout("siteTime()", 1000);
      var seconds = 1000;
      var minutes = seconds * 60;
      var hours = minutes * 60;
      var days = hours * 24;
      var years = days * 365;
      var today = new Date();
      var todayYear = today.getFullYear();
      var todayMonth = today.getMonth()+1;
      var todayDate = today.getDate();
      var todayHour = today.getHours();
      var todayMinute = today.getMinutes();
      var todaySecond = today.getSeconds();
      /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
      year - 作为date对象的年份，为4位年份值
      month - 0-11之间的整数，做为date对象的月份
      day - 1-31之间的整数，做为date对象的天数
      hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
      minutes - 0-59之间的整数，做为date对象的分钟数
      seconds - 0-59之间的整数，做为date对象的秒数
      microseconds - 0-999之间的整数，做为date对象的毫秒数 */
      var t1 = Date.UTC(2023,04,23,00,00,00); //北京时间2018-2-13 00:00:00
      var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
      var diff = t2-t1;
      var diffYears = Math.floor(diff/years);
      var diffDays = Math.floor((diff/days)-diffYears*365);
      var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
      var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
      var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
      /*document.getElementById("sitetime").innerHTML=" 已运行"+/*diffYears+" 年 "+*/diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
      document.getElementById("sitetime").innerHTML=" 已運行"+diffYears+" 年 "+diffDays+" 天 ";
    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
  </script>
  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
