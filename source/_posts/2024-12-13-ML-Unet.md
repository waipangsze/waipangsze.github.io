---
layout: post
title: ML | U-Net
categories: [ML]
tags: [ML, AI, pytorch, U-Net]
author: wpsze
date: 2024-12-13 15:01:00
math: true
mathjax: true
mathjax_autoNumber: true
mermaid: true
index_img: 
banner_img: 
---

# U-Net

The `U-Net` architecture follows an **encoder-decoder cascade structure**, where the encoder gradually compresses information into a **lower-dimensional representation**. Then the decoder decodes this information back to the original image dimension. Owing to this, the architecture gets an overall U-shape, which leads to the name U-Net.

**U-Net is a convolutional neural network that was developed for image segmentation**. The network is based on a [fully convolutional neural network](https://openaccess.thecvf.com/content_cvpr_2015/papers/Long_Fully_Convolutional_Networks_2015_CVPR_paper.pdf) whose architecture was modified and extended to work with fewer training images and to yield more precise segmentation.

![](https://i.imgur.com/eKOoRN9.png){width=600}

U-Net is a prominent deep learning architecture primarily used for **semantic segmentation** in computer vision tasks, particularly in the biomedical field. Developed by [Olaf Ronneberger and colleagues in 2015](https://www.academia.edu/download/80140288/1505.pdf), U-Net was designed to perform well even with limited training data, making it particularly useful in medical imaging where annotated datasets are scarce.

![Fig. 1. U-net architecture (example for 32x32 pixels in the lowest resolution). Each blue box corresponds to a multi-channel feature map. The number of channels is denoted on top of the box. The x-y-size is provided at the lower left edge of the box. White boxes represent copied feature maps. The arrows denote the different operations. ( Source: Ronneberger, O., Fischer, P., & Brox, T. (2015). U-net: Convolutional networks for biomedical image segmentation.](https://i.imgur.com/l2LtVgl.png){width=600}

## Architecture Overview

U-Net features a distinctive **U-shaped architecture** that consists of two main paths: the **contracting path** (encoder) and the **expansive path** (decoder).

- **Contracting Path (Encoder)**: This part of the network captures context from the input image. It consists of several convolutional layers followed by max pooling operations, which progressively reduce the spatial dimensions while increasing the depth of feature maps. The encoder extracts high-level features from the input image, similar to other convolutional networks.

- **Expansive Path (Decoder)**: The decoder's role is to upsample the feature maps obtained from the encoder back to the original image size. This is achieved through transposed convolutions (deconvolutions) and concatenation with corresponding feature maps from the encoder via **skip connections**. These skip connections help preserve spatial information that might be lost during downsampling, allowing for more precise localization of features in the output segmentation map.

### Key Features

- **Skip Connections**: These connections between corresponding layers in the encoder and decoder allow the model to retain spatial information, which is crucial for accurate segmentation.
- **Fully Convolutional Network**: U-Net is a fully convolutional network, meaning it does not rely on fully connected layers, making it more efficient for image processing tasks.
- **Effective with Limited Data**: U-Net's design enables it to perform well even when trained on small datasets, which is a significant advantage in fields like medical imaging where data acquisition can be challenging.

## Applications

U-Net has been widely adopted for various applications beyond biomedical image segmentation, including:

- **Medical Imaging**: Segmenting organs or tumors in MRI and CT scans.
- **Satellite Image Analysis**: Identifying land use or changes in land cover.
- **Autonomous Vehicles**: Assisting in scene understanding by segmenting objects within images.

In summary, U-Net's innovative architecture and effective use of skip connections have made it a foundational model in semantic segmentation tasks across various domains, particularly where data scarcity poses challenges.

# References

1. [Long, J., Shelhamer, E., & Darrell, T. (2015). **Fully convolutional networks for semantic segmentation**. In Proceedings of the IEEE conference on computer vision and pattern recognition (pp. 3431-3440).](https://openaccess.thecvf.com/content_cvpr_2015/papers/Long_Fully_Convolutional_Networks_2015_CVPR_paper.pdf)
2. [Ronneberger, O., Fischer, P., & Brox, T. (2015). **U-net: Convolutional networks for biomedical image segmentation**. In Medical image computing and computer-assisted intervention–MICCAI 2015: 18th international conference, Munich, Germany, October 5-9, 2015, proceedings, part III 18 (pp. 234-241). Springer International Publishing.](https://www.academia.edu/download/80140288/1505.pdf)
3. [3D Unet 小簡介：架構(1) — 從2D開始](https://martin12345m.medium.com/3d-unet-%E5%B0%8F%E7%B0%A1%E4%BB%8B-%E6%9E%B6%E6%A7%8B-1-%E5%BE%9E2d%E9%96%8B%E5%A7%8B-669cacd2f813)
4. [U-Net: Training Image Segmentation Models in PyTorch](https://pyimagesearch.com/2021/11/08/u-net-training-image-segmentation-models-in-pytorch/)
