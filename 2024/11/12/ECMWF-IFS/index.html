

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="wpsze">
  <meta name="keywords" content="">
  
    <meta name="description" content="Open Dataset  ECMWF to achieve fully open data status in 2025 | 17 March 2025  ECMWF is bringing forward the full transition to open data by an entire year, to 1 October 2025, marking a significant mi">
<meta property="og:type" content="article">
<meta property="og:title" content="NWP | ECMWF | IFS | Open data">
<meta property="og:url" content="https://waipangsze.github.io/2024/11/12/ECMWF-IFS/index.html">
<meta property="og:site_name" content="wpsze">
<meta property="og:description" content="Open Dataset  ECMWF to achieve fully open data status in 2025 | 17 March 2025  ECMWF is bringing forward the full transition to open data by an entire year, to 1 October 2025, marking a significant mi">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://www.ecmwf.int/sites/default/files/flags-council-chamber-650px.jpg">
<meta property="article:published_time" content="2024-11-12T02:00:00.000Z">
<meta property="article:modified_time" content="2026-01-15T01:17:17.403Z">
<meta property="article:author" content="wpsze">
<meta property="article:tag" content="WRF">
<meta property="article:tag" content="MPAS">
<meta property="article:tag" content="WPS">
<meta property="article:tag" content="IC&#x2F;BC">
<meta property="article:tag" content="ECMWF">
<meta property="article:tag" content="IFS">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://www.ecmwf.int/sites/default/files/flags-council-chamber-650px.jpg">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>NWP | ECMWF | IFS | Open data - wpsze</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"waipangsze.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":"F7MK-FcxSomhtc1N3hIUDA"},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=F7MK-FcxSomhtc1N3hIUDA", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', 'F7MK-FcxSomhtc1N3hIUDA');
        });
      }
    </script>
  

  

  

  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>wpsze</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>Links</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/bookmark/" target="_self">
                <i class="iconfont icon-bookmark"></i>
                <span>Bookmarks</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                <span>Docs</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Physics/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Physics</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Maths/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Maths</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/CFD/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>CFD</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/ML/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>ML</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Meteorology/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Meteorology</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/MPAS/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>MPAS</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/PALM/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>PALM</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/monitor/" target="_self">
                    
                    <span>Real Time Monitoring</span>
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About Me</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://www.ecmwf.int/sites/default/files/flags-council-chamber-650px.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="NWP | ECMWF | IFS | Open data"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-11-12 10:00" pubdate>
          November 12, 2024 am
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          3.4k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          29 mins
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> views
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">NWP | ECMWF | IFS | Open data</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="open-dataset">Open Dataset</h1>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ecmwf.int/en/about/media-centre/news/2025/ecmwf-achieve-fully-open-data-status-2025">ECMWF to achieve fully open data status in 2025 | 17 March 2025</a>
<ul>
<li><strong>ECMWF is bringing forward the full transition to open data by an entire year, to 1 October 2025</strong>, marking a significant milestone in its commitment to making weather data more accessible and impactful.</li>
</ul></li>
</ul>
<p>ECMWF now provides a much larger open dataset to the public, representing weather forecasts at a higher resolution and a reduction in some release times, after a <a target="_blank" rel="noopener" href="https://www.ecmwf.int/en/about/media-centre/news/2022/ecmwf-makes-wide-range-data-openly-available">first set of data was made available in early 2022</a>.</p>
<p>The changes can be summarised as follows:</p>
<ul>
<li>Medium-range data of the <strong>Integrated Forecasting System (IFS)</strong> are provided at a resolution of <strong>0.25 x 0.25 degrees (28 x 28 km)</strong>, compared to 0.4 x 0.4 degrees before, and some additional parameters will be added.</li>
<li>Medium-range data of the latest beta version of the <strong>Artificial Intelligence/Integrated Forecasting System (AIFS)</strong> are also available at a <strong>resolution of 0.25 x 0.25 degrees</strong>.</li>
<li>ECMWF’s contribution to the sub-seasonal to seasonal (S2S) dataset, which is part of a global scheme, is now available with a 48-hour delay rather than the previous three-week delay.</li>
<li>All parameters of the EU’s Copernicus Atmosphere Monitoring Service (CAMS) that used to a have a six-day embargo are now available in real time.</li>
</ul>
<p>An <a target="_blank" rel="noopener" href="https://www.ecmwf.int/en/forecasts/datasets/open-data">overview of open data</a> is given on the ECMWF website.</p>
<p>歐洲中期天氣預報中心 (ECMWF) 的 IFS 模式現在可以作為 0.25 度解析度的開放資料取得。從 2024 年 2 月 1 日 開始，IFS 開放資料分佈的解析度從 0.4 度提高到 0.25 度。這項改進顯著提高了數據精度，尤其是在沿海地區和山區。改進後的分辨率受到了廣泛歡迎，因為之前的 0.4 度分辨率對於許多應用來說太粗糙。</p>
<p>資料下載連結： <div class="note note-warning">
            <p><a target="_blank" rel="noopener" href="https://data.ecmwf.int/forecasts/" class="uri">https://data.ecmwf.int/forecasts/</a></p>
          </div></p>
<p>規格如下：</p>
<ul>
<li>解析度從 0.4° 提升至 <strong>0.25°</strong></li>
<li>0.25° x 0.25° lat/lon grid or any multiple thereof (global or sub-area)</li>
<li>On model (Reduced Gaussian) n320 grid</li>
<li>地表變因：2 公尺氣溫、地表溫度、降水量、氣壓、10 公尺風速</li>
<li>9 個大氣壓力層位提供溫度、濕度或風速數據</li>
<li><strong>10 天預報，時間間隔 3 小時</strong></li>
<li>15 天集合預報，包含 51 個集合成員</li>
<li><strong>每天更新 4 次</strong> (00/06/12/18)</li>
<li>最新測試版的人工智慧/綜合預測系統（<strong>AIFS</strong>）的中尺度資料也可提供0.25 x 0.25度的解析度</li>
<li>歐洲中期天氣預報中心（ECMWF）對次季節到季節尺度（<strong>S2S</strong>）資料集的貢獻，作為全球計劃的一部分，<strong>現在可以在48小時延遲後獲取，而不是之前的三週延遲</strong>
<ul>
<li>歐洲中期天氣預報中心(ECMWF)在由世界氣象研究計畫(WWRP)和世界氣候研究計畫(WCRP)組織的預測計畫中，對次季節到季節尺度天氣預報也進行了大大減少的延遲。 ECMWF是此計畫的眾多預報中心之一。我們的預報現在只有48小時的延遲，而不是以前的三週延遲。計劃是鼓勵所有次季節性到季節尺度資料提供者同意減少他們的貢獻延遲。更多資訊可以在次季節性到季節尺度存檔頁面上找到（<a target="_blank" rel="noopener" href="https://confluence.ecmwf.int/display/S2S/S2S+archive" class="uri">https://confluence.ecmwf.int/display/S2S/S2S+archive</a>）</li>
</ul></li>
<li>歐盟的哥白尼大氣監測服務（CAMS）的所有參數，原本需要六天的禁止發布期，現在都可以即時取得
<ul>
<li>ECMWF每天提供全球大氣組成的預報，作為其CAMS產品組合的一部分。這些預報包括0.4 x 0.4度的所有氣象變數。這些預報的壓力層資料和一些地表場資料以前只能在六天後才能獲得。現在它們可以即時獲取，就像大氣組成產品一樣。有關CAMS資料的更多詳細信息，請參閱全球大氣組成預報資料文件頁面（<a target="_blank" rel="noopener" href="https://confluence.ecmwf.int/display/CKB/CAMS%3A+Global+atmospheric+composition+forecast+data+documentation" class="uri">https://confluence.ecmwf.int/display/CKB/CAMS%3A+Global+atmospheric+composition+forecast+data+documentation</a>）。</li>
</ul></li>
<li>升級後的解析度已無縫整合到 Open-Meteo 天氣 API 中。現在您可以比較 18 個不同天氣模型的預報，評估預報的不確定性並選擇最符合您需求的模型。</li>
<li>0.25° 解析度的 51 個集合成員可以透過 Ensemble API 存取。有關 ECMWF IFS 開放資料計劃的更多詳細信息，請參閱 ECMWF 網站。</li>
</ul>
<p>憑藉 0.25° 的分辨率，新的 IFS 開放資料模型適用於 Google GraphCast <strong>機器學習模型</strong>的實際操作。先前，GraphCast 依賴歐洲地球觀測計畫的 <strong>ERA5 資料集，該資料集存在 5 天的延遲</strong>，使其不適用於即時預報應用。開放資料 IFS 0.25° 的發布現在允許您每 6 小時執行 GraphCast 並建立機器學習預報。唯一需要注意的是，高效運行 GraphCast 需要一個大型 GPU，但與超級電腦相比，這已經非常划算了。</p>
<ul>
<li>這些將實現有限區域建模和機器學習初始化。有關即時預測的文件可以在開放資料頁面找到。</li>
<li>最新測試版<strong>AIFS</strong>的中期數據也以0.25 x 0.25度的解析度提供。這是目前AIFS運作的解析度。有關AIFS的更多信息，包括訪問數據的鏈接，請參閱AIFS機器學習數據頁面（<a target="_blank" rel="noopener" href="https://www.ecmwf.int/en/forecasts/dataset/aifs-machine-learning-data" class="uri">https://www.ecmwf.int/en/forecasts/dataset/aifs-machine-learning-data</a>）。</li>
</ul>
<h1 id="snapshot">Snapshot</h1>
<p><img src="https://i.imgur.com/onPeaOO.png" srcset="/img/loading.gif" lazyload width="400" /></p>
<ul>
<li><strong>---Only few days Available---</strong> !!!</li>
<li>File format
<ul>
<li>The files are in GRIB edition 2 format, except for trajectories which are in BUFR edition 4 format.</li>
</ul></li>
</ul>
<table>
<thead>
<tr class="header">
<th>Grib Code</th>
<th>Mars Abbreviation</th>
<th>Long Name</th>
<th>Available model runs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1025</td>
<td>oper</td>
<td>Atmospheric model</td>
<td>00z, 12z</td>
</tr>
<tr class="even">
<td>1026</td>
<td>scda</td>
<td>Atmospheric model (short cutoff)</td>
<td>06z, 18z</td>
</tr>
<tr class="odd">
<td>1035</td>
<td>enfo</td>
<td>Ensemble prediction system</td>
<td>00z, 06z, 12z, 18z</td>
</tr>
<tr class="even">
<td>1045</td>
<td>wave</td>
<td>Wave model</td>
<td>00z, 12z</td>
</tr>
<tr class="odd">
<td>1081</td>
<td>waef</td>
<td>Wave ensemble forecast</td>
<td></td>
</tr>
</tbody>
</table>
<p>from <a target="_blank" rel="noopener" href="https://codes.ecmwf.int/grib/format/mars/stream/" class="uri">https://codes.ecmwf.int/grib/format/mars/stream/</a></p>
<figure>
<img src="https://i.imgur.com/j5aMuFL.png" srcset="/img/loading.gif" lazyload alt="Time available (UTC)" width="400" /><figcaption>Time available (UTC)</figcaption>
</figure>
<h2 id="ecmwf-open-data-real-time-forecasts-from-ifs-and-aifs-feb-26-2025">ECMWF open data: real-time forecasts from IFS and AIFS (Feb 26, 2025)</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://confluence.ecmwf.int/display/DAC/ECMWF+open+data%3A+real-time+forecasts+from+IFS+and+AIFS">ECMWF open data: real-time forecasts from IFS and AIFS (Feb 26, 2025)</a></li>
</ul>
<p>Currently, ECMWF open real-time data are available from these locations:</p>
<ul>
<li><strong>ECMWF</strong>: <a target="_blank" rel="noopener" href="https://data.ecmwf.int/forecasts" class="uri">https://data.ecmwf.int/forecasts</a></li>
<li><strong>Amazon's AWS</strong>: "<a target="_blank" rel="noopener" href="https://ecmwf-forecasts.s3.eu-central-1.amazonaws.com" class="uri">https://ecmwf-forecasts.s3.eu-central-1.amazonaws.com</a>"</li>
<li><strong>Google Cloud</strong>: "<a target="_blank" rel="noopener" href="https://console.cloud.google.com/marketplace/product/bigquery-public-data/open-data-ecmwf" class="uri">https://console.cloud.google.com/marketplace/product/bigquery-public-data/open-data-ecmwf</a>"</li>
<li><strong>Microsoft's Azure</strong>: "<a target="_blank" rel="noopener" href="https://ai4edataeuwest.blob.core.windows.net/ecmwf" class="uri">https://ai4edataeuwest.blob.core.windows.net/ecmwf</a>" (warning) see below for access notes</li>
<li><strong>Open-meteo.com</strong>: "<a target="_blank" rel="noopener" href="https://open-meteo.com/en/docs/ecmwf-api" class="uri">https://open-meteo.com/en/docs/ecmwf-api</a>"</li>
<li>ECMWF is happy to announce that IFS Open Data is now available from <strong>Oikolab</strong>!</li>
</ul>
<h3 id="file-format">File format</h3>
<p>The files are in <strong>GRIB edition 2 format</strong>, except for trajectories which are in BUFR edition 4 format. We recommend using ecCodes version 2.38.0 or newer to manipulate the GRIB and BUFR files.</p>
<h3 id="file-naming-convention">File-naming convention</h3>
<p>The files are provided with the following naming convention:</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs console">[ROOT]/[yyyymmdd]/[HH]z/[model]/[resol]/[stream]/[yyyymmdd][HH]0000-[step][U]-[stream]-[type].[format]<br></code></pre></td></tr></table></figure>
<ul>
<li>[ROOT] is the top-level URL of one of the sites hosting the data. See the above for possible values.</li>
<li>[yyyymmdd] is the reference date of the forecasts (base date).</li>
<li>[HH] is the reference time of the forecasts. Values are 00, 06 , 12 and 18.</li>
<li>[model] is the production model (IFS or AIFS). <strong>Note: IFS and AIFS have different options, so please be review dataset pages to see what is available.</strong></li>
<li>[resol] is the horizontal resolution of the data. <strong>Options include: 0p25</strong></li>
<li>[stream] is the forecasting system that produces the data. Values are:
<ul>
<li>oper - high-resolution forecast, atmospheric fields</li>
<li>enfo - ensemble forecast, atmospheric fields (not applicable for AIFS model)</li>
<li>waef - ensemble forecast, ocean wave fields, (not applicable for AIFS model)</li>
<li>wave - wave model, (not applicable for AIFS model)</li>
<li>scda - short cut-off high-resolution forecast, atmospheric fields (also known as "high-frequency products") (not applicable for AIFS model)</li>
<li>scwv - short cut-off high-resolution forecast, ocean wave fields (also known as "high-frequency products") (not applicable for AIFS model) and</li>
<li>mmsf - multi-model seasonal forecasts fields from the ECMWF model only (not applicable for AIFS model).<br />
</li>
</ul></li>
<li>[step] is the forecast time step expressed in units U<br />
</li>
<li>[U] is the unit used for the time step. Values are h for hours and m for month. The latter is only valid for seasonal forecasts (mmsf).</li>
<li>[type] is once of fc (forecast), ef (ensemble forecast), ep (ensemble probabilities) or tf (trajectory forecast for tropical cyclone tracks).</li>
<li>[format] is grib2 for all fields, and bufr for the trajectories.</li>
</ul>
<h3 id="the-valid-combinations-of-the-above-are">The valid combinations of the above are:</h3>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs text">format=bufr, type=tf <br>   HH=00/12 <br>  	  stream=enfo/oper, step=240h <br>   HH=06/18 <br>      stream=enfo, step=144h <br>      stream=scda, step=90h <br>format=grib2 <br>   HH=00/12 <br>      stream=enfo/waef <br>        type=ef, step=0h to 144h by 3h, 144h to 360h by 6h <br>        type=ep, step=240h/360h <br>      stream=oper, wave <br>        type=fc, step=0h to 144h by 3h, 144h to 240h by 6h <br>   HH=06/18 <br>      stream=enfo/waef <br>        type=ef, step=0h to 144h by 3h <br>      stream= scda /scwv <br>        type=fc, step=0h to 90h by 3h <br>   HH=00 <br>   	  stream=mmsf, type=fc, u=m, step=1m to 7m <br></code></pre></td></tr></table></figure>
<h3 id="via-herbie">via Herbie</h3>
<div class="note note-primary">
            <ul><li><a href="https://waipangsze.github.io/2025/04/10/NWP-Herbie-Download-NWP-model-output-MPAS-WRF/"><strong>NWP | Herbie | Download NWP model output (grib2) | MPAS | WRF</strong></a></li></ul>
          </div>
<h1 id="variables">Variables</h1>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ecmwf.int/en/forecasts/datasets/set-ix">Deterministic AIFS forecast (Set IX - AIFS)</a></li>
</ul>
<h2 id="single-level---forecast">Single level - forecast</h2>
<table>
<thead>
<tr class="header">
<th>Short Name</th>
<th>ID</th>
<th>Long Name</th>
<th>Units</th>
<th>Additional information</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>z</td>
<td>129</td>
<td>Geopotential</td>
<td>m^2 s^-2</td>
<td></td>
</tr>
<tr class="even">
<td>msl</td>
<td>151</td>
<td>Mean sea level pressure</td>
<td>Pa</td>
<td></td>
</tr>
<tr class="odd">
<td>sdor</td>
<td>160</td>
<td>Standard deviation of sub-gridscale orography</td>
<td>m</td>
<td></td>
</tr>
<tr class="even">
<td>slor</td>
<td>163</td>
<td>Slope of sub-gridscale orography</td>
<td>Numeric</td>
<td></td>
</tr>
<tr class="odd">
<td>10u</td>
<td>165</td>
<td>10 metre U wind component</td>
<td>m s^-1</td>
<td></td>
</tr>
<tr class="even">
<td>10v</td>
<td>166</td>
<td>10 metre V wind component</td>
<td>m s^-1</td>
<td></td>
</tr>
<tr class="odd">
<td>2t</td>
<td>167</td>
<td>2 metre temperature</td>
<td>K</td>
<td></td>
</tr>
<tr class="even">
<td>2d</td>
<td>168</td>
<td>2 metre dewpoint temperature</td>
<td>K</td>
<td></td>
</tr>
<tr class="odd">
<td>ssrd</td>
<td>169</td>
<td>Surface short-wave (solar) radiation downwards</td>
<td>J m^-2</td>
<td></td>
</tr>
<tr class="even">
<td>lsm</td>
<td>172</td>
<td>Land-sea mask</td>
<td>(0-1)</td>
<td></td>
</tr>
<tr class="odd">
<td>strd</td>
<td>175</td>
<td>Surface long-wave (thermal) radiation downwards</td>
<td>J m^-2</td>
<td></td>
</tr>
<tr class="even">
<td>lcc</td>
<td>3073</td>
<td>Low cloud cover</td>
<td>%</td>
<td></td>
</tr>
<tr class="odd">
<td>mcc</td>
<td>3074</td>
<td>Medium cloud cover</td>
<td>%</td>
<td></td>
</tr>
<tr class="even">
<td>hcc</td>
<td>3075</td>
<td>High cloud cover</td>
<td>%</td>
<td></td>
</tr>
<tr class="odd">
<td>rowe</td>
<td>231002</td>
<td>Runoff water equivalent (surface plus subsurface)</td>
<td>kg m^-2</td>
<td></td>
</tr>
<tr class="even">
<td>cp</td>
<td>228143</td>
<td>Convective precipitation</td>
<td>kg m^-2</td>
<td></td>
</tr>
<tr class="odd">
<td>sf</td>
<td>228144</td>
<td>Snowfall</td>
<td>kg m^-2</td>
<td></td>
</tr>
<tr class="even">
<td>tcc</td>
<td>228164</td>
<td>Total cloud cover</td>
<td>%</td>
<td></td>
</tr>
<tr class="odd">
<td>tp</td>
<td>228228</td>
<td>Total precipitation</td>
<td>kg m^-2</td>
<td></td>
</tr>
<tr class="even">
<td>100u</td>
<td>228246</td>
<td>100 metre U wind component</td>
<td>m s^-1</td>
<td></td>
</tr>
<tr class="odd">
<td>100v</td>
<td>228247</td>
<td>100 metre V wind component</td>
<td>m s^-1</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="pressure-level---forecast">Pressure level - forecast</h2>
<ul>
<li>All parameters are available at levels 1000, 925, 850, 700, 600, 500, 400, 300, 250, 200, 150, 100, 50 hPa</li>
</ul>
<table>
<thead>
<tr class="header">
<th>SHORT NAME</th>
<th>ID</th>
<th>LONG NAME</th>
<th>UNITS</th>
<th>ADDITIONAL INFORMATION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>z</td>
<td>129</td>
<td>Geopotential</td>
<td>m^2 s^-2</td>
<td></td>
</tr>
<tr class="even">
<td>t</td>
<td>130</td>
<td>Temperature</td>
<td>K</td>
<td></td>
</tr>
<tr class="odd">
<td>u</td>
<td>131</td>
<td>U component of wind</td>
<td>m s^-1</td>
<td></td>
</tr>
<tr class="even">
<td>v</td>
<td>132</td>
<td>V component of wind</td>
<td>m s^-1</td>
<td></td>
</tr>
<tr class="odd">
<td>q</td>
<td>133</td>
<td>Specific humidity</td>
<td>kg kg^-1</td>
<td></td>
</tr>
<tr class="even">
<td>w</td>
<td>135</td>
<td>Vertical velocity</td>
<td>Pa s^-1</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="soil-level---forecast">Soil level - forecast</h2>
<ul>
<li>All parameters are available at levels 1, 2</li>
</ul>
<table>
<thead>
<tr class="header">
<th>SHORT NAME</th>
<th>ID</th>
<th>LONG NAME</th>
<th>UNITS</th>
<th>ADDITIONAL INFORMATION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>vsw</td>
<td>260199</td>
<td>Volumetric soil moisture</td>
<td>m^3 m^-3</td>
<td></td>
</tr>
<tr class="even">
<td>sot</td>
<td>260360</td>
<td>Soil temperature</td>
<td>K</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="open-data-variables">open-data variables</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ecmwf.int/en/forecasts/datasets/open-data" class="uri">https://www.ecmwf.int/en/forecasts/datasets/open-data</a></li>
</ul>
<p>IFS data High-resolution products:</p>
<p>Steps:</p>
<ul>
<li>For times 00z &amp;12z: 0 to 144 by 3, 150 to 360 by 6.</li>
<li>For times 06z &amp; 18z: 0 to 144 by 3.</li>
<li>Type of level data:</li>
</ul>
<p>Surface (sfc), Surface Other level (sol) and Pressure Level (pl)</p>
<p>Pressure levels available (hPa): 1000, 925, 850, 700, 600, 500, 400, 300, 250, 200, 150, 100, 50</p>
<p>Only a single ID is used for Volumetric soil water and Soil Temperature with layer 1 having level=1, layer 2 having level=2 etc. Layers 1-4 are available.</p>
<table>

<thead>
<tr class="header">
<th>Short name</th>
<th>Long name</th>
<th>ID</th>
<th>Type of level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>z</td>
<td>Geopotential (step 0)</td>
<td>129</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>sdor</td>
<td>Standard deviation of sub-gridscale orography (step 0)</td>
<td>160</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>slor</td>
<td>Slope of sub-gridscale orography (step 0)</td>
<td>163</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>10u</td>
<td>10 metre U wind component</td>
<td>165</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>10v</td>
<td>10 metre V wind component</td>
<td>166</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>100u</td>
<td>100 metre U wind component</td>
<td>228246</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>100v</td>
<td>100 metre V wind component</td>
<td>228247</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>10fg</td>
<td>Maximum 10 metre wind gust since previous post-processing - (appears as 10fg3 for steps 3 to 144)</td>
<td>49 / 228028</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>2t</td>
<td>2 metre temperature</td>
<td>167</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>2d</td>
<td>2 metre dewpoint temperature</td>
<td>168</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>msl</td>
<td>Mean sea level pressure</td>
<td>151</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>mp2</td>
<td>Mean zero-crossing wave period</td>
<td>140221</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>mwd</td>
<td>Mean wave direction</td>
<td>140230</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>mwp</td>
<td>Mean wave period</td>
<td>140232</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>pp1d</td>
<td>Peak wave period</td>
<td>140231</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>swh</td>
<td>Significant height of combined wind waves and swell</td>
<td>140229</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>ro</td>
<td>Runoff</td>
<td>205</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>tp</td>
<td>Total Precipitation</td>
<td>228</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>sp</td>
<td>Surface pressure</td>
<td>134</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>st</td>
<td>Soil temperature</td>
<td>228139</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>tcwv</td>
<td>Total column vertically-integrated water vapour</td>
<td>137</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>lsm</td>
<td>Land Sea Mask</td>
<td>172</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>vsw</td>
<td>Volumetric soil water (layers 1-4)</td>
<td>260199</td>
<td>sol</td>
</tr>
<tr class="even">
<td>sot</td>
<td>Soil temperature (layers 1-4)</td>
<td>260360</td>
<td>sol</td>
</tr>
<tr class="odd">
<td>mucape</td>
<td>Most-unstable convective available potential energy</td>
<td>228235</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>asn</td>
<td>Snow albedo</td>
<td>32</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>mn2t3</td>
<td>Minimum temperature at 2 metres in the last 3 hours</td>
<td>228027</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>mx2t3</td>
<td>Maximum temperature at 2 metres in the last 3 hours</td>
<td>228026</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>mn2t6</td>
<td>Minimum temperature at 2 metres in the last 6 hours</td>
<td>122</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>mx2t6</td>
<td>Maximum temperature at 2 metres in the last 6 hours</td>
<td>121</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>tprate</td>
<td>Total precipitation rate</td>
<td>260048</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>ptype</td>
<td>Precipitation type</td>
<td>260015</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>ttr</td>
<td>Top net long-wave (thermal) radiation</td>
<td>179</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>str</td>
<td>Surface net long-wave (thermal) radiation</td>
<td>177</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>ssr</td>
<td>Surface net short-wave (solar) radiation</td>
<td>176</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>ssrd</td>
<td>Surface net short-wave (solar) radiation downwards</td>
<td>169</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>strd</td>
<td>Surface net long-wave (thermal) radiation downwards</td>
<td>175</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>nsss</td>
<td>Time-integrated northward turbulent surface stress</td>
<td>181</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>ewss</td>
<td>Time-integrated eastward turbulent surface stress</td>
<td>180</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>t20d</td>
<td>Depth of 20C isotherm - currently unavailable (11/03/2024)</td>
<td></td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>sav300</td>
<td>Average salinity in the upper 300m - currently unavailable (11/03/2024)</td>
<td></td>
<td>sfc</td>
</tr>
<tr class="even">
<td>ocu</td>
<td>Eastward sea water velocity - currently unavailable (11/03/2024)</td>
<td></td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>ocv</td>
<td>Northward sea water velocity - currently unavailable (11/03/2024)</td>
<td></td>
<td>sfc</td>
</tr>
<tr class="even">
<td>sithick</td>
<td>Sea ice thickness</td>
<td>262000</td>
<td>sfc</td>
</tr>
<tr class="odd">
<td>zos</td>
<td>Sea surface height</td>
<td>262124</td>
<td>sfc</td>
</tr>
<tr class="even">
<td>d</td>
<td>Divergence</td>
<td>155</td>
<td>pl</td>
</tr>
<tr class="odd">
<td>gh</td>
<td>Geopotential height</td>
<td>156</td>
<td>pl</td>
</tr>
<tr class="even">
<td>q</td>
<td>Specific humidity</td>
<td>133</td>
<td>pl</td>
</tr>
<tr class="odd">
<td>r</td>
<td>Relative humidity</td>
<td>157</td>
<td>pl</td>
</tr>
<tr class="even">
<td>t</td>
<td>Temperature</td>
<td>130</td>
<td>pl</td>
</tr>
<tr class="odd">
<td>u</td>
<td>U component of wind</td>
<td>131</td>
<td>pl</td>
</tr>
<tr class="even">
<td>v</td>
<td>V component of wind</td>
<td>132</td>
<td>pl</td>
</tr>
<tr class="odd">
<td>w</td>
<td>Vertical velocity</td>
<td>135</td>
<td>pl</td>
</tr>
<tr class="even">
<td>vo</td>
<td>Vorticity (relative)</td>
<td>138</td>
<td>pl</td>
</tr>
</tbody>
</table>
<h1 id="rda.ucar-ecmwf-ifs-high-resolution-operational-forecasts">rda.ucar: ECMWF IFS High-Resolution Operational Forecasts</h1>
<h2 id="from-rda.ucar-not-use">From rda.ucar (Not use)</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://rda.ucar.edu/datasets/d113001/#" class="uri">https://rda.ucar.edu/datasets/d113001/#</a>
<ul>
<li>ECMWF has implemented a significant resolution upgrade and methodology for high-resolution forecasts (HRES) and ensemble forecasts (ENS) beginning January of 2016. HRES is now performed via a transform grid with a nominal grid point spacing of 9 kilometers (0.08 degrees), and is carried out with IFS (Integrated Forecast System).</li>
<li><strong>ECMWF Operational 6-hourly atmospheric surface forecast</strong></li>
<li><strong>ECMWF Operational 6-hourly atmospheric isobaric analysis</strong></li>
</ul></li>
</ul>
<p><img src="https://i.imgur.com/GvUcfD5.png" srcset="/img/loading.gif" lazyload width="400" /></p>
<h1 id="herbie">Herbie</h1>
<p><a href="https://waipangsze.github.io/2025/04/10/NWP-Herbie-Download-NWP-model-output-MPAS-WRF/"><strong>NWP | Herbie | Download NWP model output (grib2) | MPAS | WRF</strong></a></p>
<h1 id="download-script">Download script</h1>
<ul>
<li><code>wget [ROOT]/20240301/00z/ifs/0p25/oper/20240301060000-24h-oper-fc.grib2</code></li>
<li><code>wget [ROOT]/20240301/06z/ifs/0p25/scda/20240301060000-24h-scda-fc.grib2</code></li>
<li><code>wget [ROOT]/20240301/12z/ifs/0p25/wave/20240301060000-12h-wave-fc.grib2</code></li>
<li><code>wget [ROOT]/20240301/06z/ifs/0p25/scwv/20240301060000-18h-scwv-fc.grib2</code></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-comment">#################################################################</span><br><span class="hljs-comment"># https://data.ecmwf.int/forecasts/20241117/00z/ifs/0p25/oper/</span><br><span class="hljs-comment"># https://data.ecmwf.int/forecasts/20241117/00z/ifs/0p25/oper/20241117000000-114h-oper-fc.grib2</span><br><span class="hljs-comment">#################################################################</span><br><br>yyyy=<span class="hljs-string">&#x27;2024&#x27;</span><br>mm=<span class="hljs-string">&#x27;11&#x27;</span><br><span class="hljs-built_in">dd</span>=<span class="hljs-string">&#x27;17&#x27;</span><br>hh=<span class="hljs-string">&#x27;00&#x27;</span><br>yyyymm=<span class="hljs-variable">$&#123;yyyy&#125;</span><span class="hljs-variable">$&#123;mm&#125;</span><br>yyyymmddhh=<span class="hljs-variable">$&#123;yyyy&#125;</span><span class="hljs-variable">$&#123;mm&#125;</span><span class="hljs-variable">$&#123;dd&#125;</span><span class="hljs-variable">$&#123;hh&#125;</span><br><br>tmp_dir=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;yyyy&#125;</span><span class="hljs-variable">$&#123;mm&#125;</span>/<span class="hljs-variable">$&#123;yyyy&#125;</span><span class="hljs-variable">$&#123;mm&#125;</span><span class="hljs-variable">$&#123;dd&#125;</span>&quot;</span><br><span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$&#123;tmp_dir&#125;</span><br><span class="hljs-built_in">cd</span> <span class="hljs-variable">$&#123;tmp_dir&#125;</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Current <span class="hljs-variable">$&#123;tmp_dir&#125;</span>&quot;</span><br><br>limit_cpu_core=15<br>count_cpu_core=1<br><br><span class="hljs-keyword">for</span> ifsfile <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">seq</span> 0 3 6); <span class="hljs-keyword">do</span> <span class="hljs-comment"># Forecast time = 12, 24, 36, 48, 60, 72, 84, 96, 108, 130, 142, 154</span><br><br>    tmp_ifs_fname=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;yyyymmddhh&#125;</span>0000-<span class="hljs-variable">$&#123;ifsfile&#125;</span>h-oper-fc.grib2&quot;</span><br>	<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Now, <span class="hljs-variable">$&#123;tmp_ifs_fname&#125;</span> ... &quot;</span><br>    <br>		<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Downloading ... <span class="hljs-variable">$&#123;tmp_ifs_fname&#125;</span>&quot;</span><br>		wget -c --no-check-certificate https://data.ecmwf.int/forecasts/<span class="hljs-variable">$&#123;yyyy&#125;</span><span class="hljs-variable">$&#123;mm&#125;</span><span class="hljs-variable">$&#123;dd&#125;</span>/<span class="hljs-variable">$&#123;hh&#125;</span>z/ifs/0p25/oper/<span class="hljs-variable">$&#123;tmp_ifs_fname&#125;</span><br>    <br>	res=$(( <span class="hljs-variable">$&#123;count_cpu_core&#125;</span> % <span class="hljs-variable">$&#123;limit_cpu_core&#125;</span> ))<br>	<span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$&#123;res&#125;</span> == 0 ]]; <span class="hljs-keyword">then</span><br>		<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;please wait <span class="hljs-variable">$&#123;tmp_ifs_fname&#125;</span>, <span class="hljs-variable">$&#123;count_cpu_core&#125;</span>, <span class="hljs-variable">$&#123;res&#125;</span>.&quot;</span><br>		<span class="hljs-built_in">wait</span><br>	<span class="hljs-keyword">fi</span><br>    <br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure>
<h2 id="read-grib2">read grib2</h2>
<p>read_grib2.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/bin/python</span><br><span class="hljs-keyword">import</span> pygrib<br><br>grib_file = <span class="hljs-string">&quot;/home/wpsze/IFS/202411/20241117/20241117000000-0h-oper-fc.grib2&quot;</span><br>grbs = pygrib.<span class="hljs-built_in">open</span>(grib_file)<br><span class="hljs-keyword">for</span> grb <span class="hljs-keyword">in</span> grbs:<br>    <span class="hljs-built_in">print</span>(grb) <span class="hljs-comment"># long list</span><br></code></pre></td></tr></table></figure>
<h2 id="zero-padding">zero-padding</h2>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment">#set -e # stop the shell on first error</span><br><span class="hljs-comment">#set -u # fail when using an undefined variable</span><br><span class="hljs-comment">#set -x # echo script lines as they are executed</span><br><span class="hljs-built_in">set</span> -o pipefail<br><br><span class="hljs-built_in">source</span> /home/wpsze/micromamba/bin/activate venv<br><span class="hljs-built_in">export</span> SCRIPT_DIR=<span class="hljs-string">&quot;<span class="hljs-subst">$( cd <span class="hljs-string">&quot;<span class="hljs-subst">$( dirname <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BASH_SOURCE[0]&#125;</span>&quot;</span> )</span>&quot;</span> &gt;/dev/null 2&gt;&amp;1 &amp;&amp; pwd )</span>&quot;</span><br><br><span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> *h-oper-fc.grib2; <span class="hljs-keyword">do</span><br>    <span class="hljs-comment"># Check if the filename matches the pattern (prefix-number-suffix)</span><br>    <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$file</span> =~ (.*-)([0-9]+)(h-.*) ]]; <span class="hljs-keyword">then</span><br>        prefix=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BASH_REMATCH[1]&#125;</span>&quot;</span><br>        hour=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BASH_REMATCH[2]&#125;</span>&quot;</span><br>        suffix=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BASH_REMATCH[3]&#125;</span>&quot;</span><br>        <br>        <span class="hljs-comment"># Format the hour to be 3 digits with leading zeros</span><br>        padded_hour=$(<span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%03d&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$hour</span>&quot;</span>)<br>        <br>        <span class="hljs-comment"># Rename the file</span><br>        <span class="hljs-built_in">mv</span> <span class="hljs-string">&quot;<span class="hljs-variable">$file</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;prefix&#125;</span><span class="hljs-variable">$&#123;padded_hour&#125;</span><span class="hljs-variable">$&#123;suffix&#125;</span>&quot;</span><br>    <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure>
<h1 id="run-as-icbc">Run as ICBC</h1>
<p>I recognised that the Vtable.ECMWF you have mentioned was not suitable for the IFS forecast data, due to the data form of the IFS was grib2. But the Vtable.ECMWF was for grib.</p>
<p><a target="_blank" rel="noopener" href="https://github.com/wrf-model/WPS/blob/master/ungrib/Variable_Tables/Vtable.ECMWF" class="uri">https://github.com/wrf-model/WPS/blob/master/ungrib/Variable_Tables/Vtable.ECMWF</a></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/ecmwf-open-data-0p25-grib2-vtable.16523/">ECMWF open data 0p25 grib2 Vtable?</a>
<ul>
<li>Do we have Vtable suitable for ungribbing this new dataset? <strong>https://data.ecmwf.int/forecasts/YYYYMMDD/00z/ifs/0p25/oper/</strong></li>
<li>I'm not sure if the existing Vtables (perhaps Vtable.ECMWF?) are suitable. If you'd like to test them out and let us know, that would be great! If they don't work, you can try contacting the input data support group to see if they are able to help. You can also use the utilities, such as g2print.exe and g1print.exe to look at the codes given in the new data type, which can help you to modify an existing Vtable. If you are able to find one that works, feel free to share it so that it may help other users who are trying to use these data.</li>
<li>Provided Vtable.ECMWF unfortunatelly doesn't work as it expects grib1 format. I tried to convert grib2 to grib1 with cnvgrib but it fails too. I hoped that someone already has new Vtable, but ok, it looks I will need to create new one using tools you mentioned. Thank you anyway. If I succeed I will post here working solution later.</li>
<li>if g2print cannot process this dataset, it implies that the ECPDS data cannot be recognized by WPS. You will have to explore this data, create Vtable for it, and I guess it may be necessary to modify codes like ungrib.F and rd_grib2.F, etc.</li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/error-while-running-ungrib-exe-with-ifs-global-data.14439/">Error while running ungrib.exe with IFS global data (not solved)</a>
<ul>
<li>I've downloaded the IFS analysis files from RDA ds113.1 dataset.</li>
<li><a target="_blank" rel="noopener" href="https://rda.ucar.edu/datasets/d113001/dataaccess/#" class="uri">https://rda.ucar.edu/datasets/d113001/dataaccess/#</a></li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/initializing-wrf-with-global-ecmwf.11131/">Initializing WRF with Global ECMWF (not solved)</a>
<ul>
<li>It is not possible to initialize the WRF with only these data available from the ECMWF because some important variables are missing, such as more levels of temperature and soil moisture;</li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://forum.ecmwf.int/t/wrf-vtable-for-ecmwf-10-days-open-data/1167/1">WRF Vtable for ECMWF 10-days open data (not solved)</a></li>
<li><a target="_blank" rel="noopener" href="https://forum.ecmwf.int/t/vtable-required-for-ecmwf-10-days-open-data/4438/1">Vtable required for ECMWF 10-days open data (not solved)</a></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/ecmwf-open-data-0p25-enfo-grib2-vtable.19236/">ECMWF open data 0p25 enfo grib2 Vtable?</a></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/help-with-ungrib-exe-when-applied-to-ecmwf-data-at-t1279-resolution.14475/#post-37949">help with ungrib.exe when applied to ecmwf data at T1279 resolution</a></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/error-when-ungrib-exe-the-ecmwf-ifs-0p25-dataset-257.18725/">Error when ungrib.exe the ECMWF IFS 0p25 dataset #257</a>
<ul>
<li>I agree that the ECPDS data may have unique GRIB structure that WPS/ungrib cannot recognize.</li>
</ul></li>
</ul>
<h2 id="mpaswrf">MPAS/WRF</h2>
<h3 id="ungrib">ungrib</h3>
<p><strong>Solution</strong>:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/using-newer-ecmwf-data.19307/">Using Newer ECMWF Data | kwerner | Sep 28, 2024</a>
<ul>
<li>The <strong>new EC grib2 data requires an additional step to convert from EC grib2 data to grib2 data WPS supports</strong>. The conversion can be done by using the convert command in the ecCodes library which is available from ECMWF. The conversion step follows the following format: <figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">grib_set -r -w packingType=grid_ccsds -s packingType=grid_simple input.grib2 output.grib2</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">grib_set -r -w packingType=grid_ccsds -s packingType=grid_simple 20250326000000-0h-oper-fc.grib2 ifs_20250326000000-0h-oper-fc.grib2</span><br></code></pre></td></tr></table></figure></li>
<li>The <a target="_blank" rel="noopener" href="https://github.com/wrf-model/WPS/blob/v4.6.0/ungrib/Variable_Tables/Vtable.ECMWF"><strong>updated Vtable.ECMWF in WPS v4.6</strong></a> should work with the converted grib2 data.</li>
<li>I think this could be related to CCSDS compression. You can change the packing type by using eccodes for instance.</li>
<li>Hi Everyone, <strong>One of the problems with the EC data is that it's not all standardized like GFS data</strong>. Depending on where/how the data are obtained, they can be different. We've found that, for e.g., for one user, ungrib is unable to recognize the soil fields. A possible solution for this is to use GFS soil data, in addition to the EC data. We expect the output to still be reasonable, especially because the WRF LSMs are more like that used by GFS. We hope to have a better solution for this issue in the future. For additional information, see this thread in our GitHub code repository (I believe one of you is the one who was having the discussion with my colleague).</li>
</ul></li>
</ul>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-738764b7" role="button" aria-expanded="false" aria-controls="collapse-738764b7">
        <div class="fold-arrow">▶</div>Vtable.ECMWF
      </div>
      <div class="fold-collapse collapse" id="collapse-738764b7">
        <div class="fold-content">
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs Vtable.ECMWF">GRIB1| Level| From |  To  | metgrid  | metgrid  | metgrid                                  |GRIB2|GRIB2|GRIB2|GRIB2|<br>Param| Type |Level1|Level2| Name     | Units    | Description                              |Discp|Catgy|Param|Level|<br>-----+------+------+------+----------+----------+------------------------------------------+-----------------------+<br> 129 | 100  |   *  |      | GEOPT    | m2 s-2   |                                          |  0  |  0  |     | 100 |<br> 156 | 100  |   *  |      | HGT      | m        | Height                                   |  0  |  3  |  5  | 100 |  <br> 130 | 100  |   *  |      | TT       | K        | Temperature                              |  0  |  0  |  0  | 100 |<br> 131 | 100  |   *  |      | UU       | m s-1    | U                                        |  0  |  2  |  2  | 100 |<br> 132 | 100  |   *  |      | VV       | m s-1    | V                                        |  0  |  2  |  3  | 100 |<br> 157 | 100  |   *  |      | RH       | %        | Relative Humidity                        |  0  |  1  |  1  | 100 |<br> 165 |  1   |   0  |      | UU       | m s-1    | U                    At 10 m             |  0  |  2  |  2  | 103 | <br> 166 |  1   |   0  |      | VV       | m s-1    | V                    At 10 m             |  0  |  2  |  3  | 103 | <br> 167 |  1   |   0  |      | TT       | K        | Temperature          At  2 m             |  0  |  0  |  0  | 103 |<br> 168 |  1   |   0  |      | DEWPT    | K        |                                          |  0  |  0  |  6  | 103 |<br>     |  1   |   0  |      | RH       | %        | Relative Humidity    At  2 m             |  0  |  0  |     | 103 | <br> 172 |  1   |   0  |      | LANDSEA  | 0/1 Flag | Land/Sea flag                            |  2  |  0  |  0  |  1  | <br> 129 |  1   |   0  |      | SOILGEO  | m2 s-2   |                                          |  0  |  0  |     | 103 | <br> 156 |  1   |   0  |      | SOILHGT  | m        | Terrain field of source analysis         |  0  |  0  |     | 106 | <br> 134 |  1   |   0  |      | PSFC     | Pa       | Surface Pressure                         |  0  |  3  |  0  |  1  |<br> 151 |  1   |   0  |      | PMSL     | Pa       | Sea-level Pressure                       |  0  |  3  |  0  | 101 |<br> 235 |  1   |   0  |      | SKINTEMP | K        | Sea-Surface Temperature                  |  0  |  3  |     | 101 |<br>  31 |  1   |   0  |      | SEAICE   | 0/1 Flag | Sea-Ice-Flag                             |  0  |  3  |     | 101 |<br>  34 |  1   |   0  |      | SST      | K        | Sea-Surface Temperature                  |  0  |  3  |     | 101 |<br> 141 |  1   |   0  |      | SNOW_EC  | m        |                                          |  0  |  3  |     | 101 |<br>     |  1   |   0  |      | SNOW     | kg m-2   |Water Equivalent of Accumulated Snow Depth|  0  |  3  |     | 101 |<br> 139 | 112  |   0  |   7  | ST000007 | K        | T of 0-7 cm ground layer                 |  2  |  0  |  2  | 106 | <br> 170 | 112  |   7  |  28  | ST007028 | K        | T of 7-28 cm ground layer                | 192 | 128 | 170 | 106 | <br> 183 | 112  |  28  | 100  | ST028100 | K        | T of 28-100 cm ground layer              | 192 | 128 | 183 | 106 | <br> 236 | 112  | 100  | 255  | ST100289 | K        | T of 100-289 cm ground layer             | 192 | 128 | 236 | 106 | <br>  39 | 112  |   0  |   7  | SM000007 | fraction | Soil moisture of 0-7 cm ground layer     | 192 | 128 | 39  | 106 | <br>  40 | 112  |   7  |  28  | SM007028 | fraction | Soil moisture of 7-28 cm ground layer    | 192 | 128 | 40  | 106 | <br>  41 | 112  |  28  | 100  | SM028100 | fraction | Soil moisture of 28-100 cm ground layer  | 192 | 128 | 41  | 106 | <br>  42 | 112  | 100  | 255  | SM100289 | fraction | Soil moisture of 100-289 cm ground layer | 192 | 128 | 42  | 106 | <br>-----+------+------+------+----------+----------+------------------------------------------+-----+-----+-----+-----+<br>#<br>#  Grib codes are from Table 128 <br>#  http://old.ecmwf.int/publications/manuals/d/gribapi/param/filter=grib1/order=paramId/order_type=asc/p=1/table=128/<br>#  <br>#  snow depth is converted to the proper units in rrpr.F<br>#<br>#  Tested on NCAR/RDA ds113.0 dataset. http://rda.ucar.edu/datasets/ds113.0/<br>#  Note that for ds113.0 there is one surface data file per day and 4 pressure-level files per day.<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/wrf-model/WPS/issues/263">Vtable error of ECMWF,pls update it | Oct 13, 2024</a>
<ul>
<li>Surface data including soil data may come from grib 1 data. You may need to use eccodes to separate out grib 2 and grib 1 data first before running ungrib. We are not supporting the new enfo data yet. Please post further issue on the Forum.</li>
<li>they are <strong>loss soil data</strong>.</li>
<li><strong>It looks like the grib code for soil data has been messed up somehow</strong>. For the time being, <strong>you can try to use GFS soil data together with the EC atmospheric data. If you need help doing so, try reading the WPS section of the User's Guide</strong>.</li>
<li>Please read carefully this section of the <a target="_blank" rel="noopener" href="https://www2.mmm.ucar.edu/wrf/users/wrf_users_guide/build/html/wps.html#using-multiple-meteorological-data-sources">User's Guide for using combined datasets</a>.</li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/change-in-soil-variables-from-ecmwf-cycle-49r1.19864/#post-48546">Change in soil variables from ECMWF Cycle 49r1 | Nov 14, 2024</a>
<ul>
<li>On <strong>Tuesday (November 12), ECMWF released the 49r1 version of the operational IFS</strong>. Despite all the improvements, they modified the soil variables (temperature and humidity) which stopped the ECMWF Vtable that had been released in the 4.6.0 version of the WPS.</li>
<li><strong>WPS still can't find the soil temperature and moisture variables</strong>.</li>
<li>I contacted the ECMWF team and they gave me this feedback. <strong>It is necessary to make a change within Ungrib</strong>, more specifically in the rd_grib2.F code so that it works with the <strong>new IFS soil variables</strong>.</li>
<li><em>[Jan 3, 2025]</em> Please take a look at <a target="_blank" rel="noopener" href="https://github.com/wrf-model/WPS/pull/266">this document-Change in soil variables from ECMWF Cycle 49r1</a> , which fixes the issues related to the ECMWF 49r1 version of the operational IFS. ECMWF 49r1 is newly released and we haven't done sufficient tests to make sure it works fine for WRF. Please post any issues you may have, which will be helpful for us to implement this data for WRF modeling study. Thanks in advance.</li>
<li><em>[Jan 4, 2025]</em> Please <strong>download</strong> the <strong>modified code "rd_grib2.F"</strong> from the website update <a target="_blank" rel="noopener" href="https://github.com/wrf-model/WPS/pull/266">era5/ifs soil field processing by jimbresch · Pull Request #266 · wrf-model/WPS</a>, <strong>recompile WPS, then rerun ungrib.exe</strong>.</li>
<li>IFS operational model data in the ECMWF open data repository are <strong>only available for the last 4 days.</strong></li>
<li><em>[Jan 15, 2025]</em> As requested, I am providing the corrected rd_grib2F file for WPS 4.5 and my Vtable.ECMWF_GRIB2 file. For the new WPS 4.6 version, I have not yet prepared a correction for the IFS model.</li>
<li><em>[Jan 16, 2025]</em> <strong>I run WPS using your rd_grib2.F and Vtable. All work fine</strong>. Thank you! The met-em file I generated only has 14 pressure levels in the vertical, --- is this what you got?</li>
<li><em>[Jan 16, 2025]</em> Yes, <strong>the IFS model provided by ECMWF has only 14 pressure levels</strong>. I made a simulation with the operational IFS model at 137 hybrid levels, which we have access to at the Institute of Meteorology and Water Management. The results are similar to the results from the IFS model, which is provided as open data. This is good news.</li>
<li><em>[14 Jan, 2025]</em> I have <strong>already tested this Vtable.ECMWF with the new operational IFS data and it doesn't work either</strong>. I reported this here.</li>
</ul></li>
</ul>
<div class="note note-primary">
            <p><strong>recompile WPS, then rerun ungrib.exe</strong></p>
          </div>
<ul>
<li>under <code>ungrib/src</code>,
<ul>
<li>rd_grib2.F</li>
</ul></li>
</ul>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-dfb167e8" role="button" aria-expanded="false" aria-controls="collapse-dfb167e8">
        <div class="fold-arrow">▶</div>Vtable.ECMWF_GRIB2
      </div>
      <div class="fold-collapse collapse" id="collapse-dfb167e8">
        <div class="fold-content">
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs Vtable.ECMWF_GRIB2">GRIB1| Level| From |  To  | metgrid  | metgrid  | metgrid                                  |GRIB2|GRIB2|GRIB2|GRIB2|<br>Param| Type |Level1|Level2| Name     | Units    | Description                              |Discp|Catgy|Param|Level|<br>-----+------+------+------+----------+----------+------------------------------------------+-----------------------+<br> 129 | 100  |   *  |      | HGT      | m        | Height                                   |  0  |  3  |  5  | 100 |<br> 130 | 100  |   *  |      | TT       | K        | Temperature                              |  0  |  0  |  0  | 100 |<br> 131 | 100  |   *  |      | UU       | m s-1    | U                                        |  0  |  2  |  2  | 100 |<br> 132 | 100  |   *  |      | VV       | m s-1    | V                                        |  0  |  2  |  3  | 100 |<br> 157 | 100  |   *  |      | RH       | %        | Relative Humidity                        |  0  |  1  |  1  | 100 |<br> 165 |  1   |   0  |      | UU       | m s-1    | U                 at 10 m                |  0  |  2  |  2  | 103 |<br> 166 |  1   |   0  |      | VV       | m s-1    | V                 at 10 m                |  0  |  2  |  3  | 103 |<br> 167 |  1   |   0  |      | TT       | K        | Temperature       at  2 m                |  0  |  0  |  0  | 103 |<br> 168 |  1   |   0  |      | DEWPT    | K        |                                          |  0  |  0  |  6  | 103 |<br>     |  1   |   0  |      | RH       | %        | Relative Humidity at 2 m                 |  0  |  1  |  1  | 103 |<br> 172 |  1   |   0  |      | LANDSEA  | 0/1 Flag | Land/Sea flag (1=land, 0 or 2=sea)       |  2  |  0  |  0  |   1 |<br> 134 |  1   |   0  |      | PSFC     | Pa       | Surface Pressure                         |  0  |  3  |  0  |   1 |<br> 151 |  1   |   0  |      | PMSL     | Pa       | Sea-level Pressure                       |  0  |  3  |  0  | 101 |<br> 235 |  1   |   0  |      | SKINTEMP | K        | Skin temperature                         |  0  |  0  | 17  |   1 |<br>  18 | 112  |   0  |   7  | ST000007 | K        | T of 0-7 cm  ground layer                |  2  |  3  |  18 | 151 | <br>  18 | 112  |   7  |  28  | ST007028 | K        | T of 7-28 cm ground layer                |  2  |  3  |  18 | 151 | <br>  18 | 112  |  28  | 100  | ST028100 | K        | T of 28-100 cm ground layer              |  2  |  3  |  18 | 151 | <br>  18 | 112  | 100  | 289  | ST100289 | K        | T of 100-289 cm ground layer             |  2  |  3  |  18 | 151 | <br>  25 | 112  |   0  |   7  | SM000007 | m3 m-3   | Soil moisture of 0-7 cm ground layer     |  2  |  0  |  25 | 151 | <br>  25 | 112  |   7  |  28  | SM007028 | m3 m-3   | Soil moisture of 7-28 cm ground layer    |  2  |  0  |  25 | 151 | <br>  25 | 112  |  28  | 100  | SM028100 | m3 m-3   | Soil moisture of 28-100 cm ground layer  |  2  |  0  |  25 | 151 | <br>  25 | 112  | 100  | 289  | SM100289 | m3 m-3   | Soil moisture of 100-289 cm ground layer |  2  |  0  |  25 | 151 | <br>-----+------+------+------+----------+---------+-----------------------------------------+-------------------------+<br>#<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<h4 id="vtable.ecmwf_grib2vtable.ecmwf">Vtable.ECMWF_GRIB2/Vtable.ECMWF</h4>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs console">-rw-rw-r-- 1 wpsze wpsze 321M Apr  1 16:27 ERA5:2025-03-26_00-ECMWF_GRIB2<br>-rw-rw-r-- 1 wpsze wpsze 286M Apr  1 14:26 ERA5:2025-03-26_00-Vtable.ECMWF<br></code></pre></td></tr></table></figure>
<ul>
<li>The intermediate file (ERA5.xxx) by Vtable.ECMWF_GRIB2 is larger file size than that of Vtable.ECMWF</li>
<li>ERA5.xxx by Vtable.ECMWF fails in init_atmosphere_model step.</li>
</ul>
<h2 id="updated-2025-12-15"><strong>Updated (2025-12-15)</strong></h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/wrf-model/WPS/pull/266" class="uri">https://github.com/wrf-model/WPS/pull/266</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/wrf-model/WPS/pull/266/files" class="uri">https://github.com/wrf-model/WPS/pull/266/files</a>
<ul>
<li>ungrib/Variable_Tables/Vtable.ECMWF.IFS.grib2</li>
<li>ungrib/src/ngl/g2/params.f</li>
<li>ungrib/src/rd_grib2.F</li>
<li>util/uncompress_ifs.csh</li>
</ul></li>
</ul>
<p><img src="https://i.imgur.com/EsTBs13.png" srcset="/img/loading.gif" lazyload /></p>
<blockquote>
<ul>
<li>download this commit</li>
<li><a target="_blank" rel="noopener" href="https://github.com/wrf-model/WPS/tree/88148d22afa04b9129cec5e8dcc6281150c4da34" class="uri">https://github.com/wrf-model/WPS/tree/88148d22afa04b9129cec5e8dcc6281150c4da34</a></li>
<li>compile this specific WPS</li>
</ul>
</blockquote>
<h3 id="init_atmosphere_model">init_atmosphere_model</h3>
<h4 id="error">Error</h4>
<ul>
<li>MPASv7.3 init_atmosphere_model</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs log">ERROR: extrap_type == 2 not implemented for target_z &gt;= zf(1,nz)<br>ERROR: *****************************************************************<br>ERROR: Error in interpolation of t(k,iCell) for k=  46, iCell=         1<br>CRITICAL ERROR: ********************************************************<br></code></pre></td></tr></table></figure>
<ul>
<li>set 'linear',</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs namelist">&amp;interpolation_control<br>    config_extrap_airtemp = &#x27;linear&#x27;<br>/<br></code></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs log">CRITICAL ERROR: Error in interpolation of st_fg to MPAS grid: num_st = 27244<br></code></pre></td></tr></table></figure>
<ul>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/error-creating-initial-conditions-with-ncep-fnl-ds083-2.17113/">Error creating initial conditions with NCEP FNL ds083.2 | May 8, 2024</a>
<ul>
<li>I'm trying to create the initial conditions file for MPAS (v8.1) using data obtained from the NCEP FNL ds083.2</li>
<li>Just had to change <code>config_nfgsoillevels</code> to <strong>2</strong> and <code>config_extrap_airtemp</code> to <strong>linear</strong> in <code>namelist.init_atmosphere</code>. Once those two modifications were made <code>init_atmosphere_model</code> and <code>atmosphere_model</code> ran without issues.</li>
<li>Note that <strong>FNL data only contains 2-level of soil information</strong>, which is why we need to set <strong>config_nfgsoillevels=2</strong>. <strong>The top of the FNL data is 10 hpa, and therefore extrapolation is needed if MPAS top level is above 10 hpa</strong>.</li>
<li>For the option of <code>config_extrap_airtemp</code>, would you please let me know what is the model top of your MPAS run? Thanks.</li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/initial-condition-critical-error-error-in-interpolation-of-st_fg-to-mpas.15807/">Initial condition CRITICAL ERROR: Error in interpolation of st_fg to MPAS | Feb 16, 2024</a></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/error-in-interpolation-of-st_fg-to-mpas-grid-with-variable-resolution-mesh-simulation.9387/">'Error in interpolation of st_fg to MPAS grid' with variable-resolution mesh simulation | Jul 23, 2020</a>
<ul>
<li>The error message generally indicates that there are grid cells that have a soil temperature value less than or equal to zero.</li>
<li>I solved the problem by downloading the "Vtable from the RDR page/WRF" and using WPS version 4.0 or higher.</li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/critical-error-error-in-interpolation-of-st_fg-to-mpas-grid.5382/">CRITICAL ERROR: Error in interpolation of st_fg to MPAS grid | Start dateMay 3, 2019</a>
<ul>
<li>This error message is an indication that there were one or more points in the MPAS mesh that received a zero or negative value for soil temperature.</li>
<li>Can you also verify that there are soil moisture and soil temperature fields in your WPS intermediate file, and that the number of soil levels in your intermediate files matches the value of the config_nfgsoillevels in your namelist.init_atmosphere file?</li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/critical-error-error-in-interpolation-of-st_fg-to-mpas-grid-num_st-18642.12857/">CRITICAL ERROR: Error in interpolation of st_fg to MPAS grid: num_st = 18642 | Apr 12, 2023</a>
<ul>
<li><strong>MPAS can only process soil data at specific levels with specific field names. If your input soil data are on levels or with names unrecognized by MPAS, then it won't work</strong>.</li>
<li>Please take a look at the code <strong>"mpas_init_atm_cases.F"</strong>, and the lines 3908 - 4118 process soil temperature data. This might give you some idea how MPAS works.</li>
</ul></li>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/trying-to-use-rap-as-ic-bc.5549/">Trying to Use RAP as IC/BC | Start dateJun 26, 2019</a>
<ul>
<li>The message "Error in interpolation of st_fg to MPAS grid: num_st = XXXX" is <strong>generally indicative of an issue with the soil temperature</strong>. Would it be possible to use some of the utilities that come with the WRF Pre-processing System (WPS) to check that there are valid soil temperature data in your intermediate file? Specifically, you could use the "<code>rd_intermediate</code>" utility to check that there are fields named, e.g., ST000010, and you could use the "<code>int2nc</code>" utility to convert the intermediate file to netCDF format, where it would be easier to view the soil fields with, e.g., <code>ncview</code>.</li>
</ul></li>
<li><strong>Use WPSv4.6 with above renewed Vtable and rd_grib2.F</strong></li>
</ul>
<h4 id="one-more-issue-資料集可用性-2024-11-12t120000z2025-04-16t120000z">One more issue, 資料集可用性 2024-11-12T12:00:00Z–2025-04-16T12:00:00Z</h4>
<ul>
<li><strong>資料集可用性 2024-11-12T12:00:00Z–2025-04-16T12:00:00Z</strong></li>
<li>The grib files from <code>ecmwf.ini</code> and from <code>aws</code> are different. It will make different/debug on the <code>ungrib</code> step and <code>init_atmosphere_model</code> step.
<ul>
<li>Not all different.</li>
</ul></li>
</ul>
<p>It is because,</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developers.google.com/earth-engine/datasets/catalog/ECMWF_NRT_FORECAST_IFS_OPER?hl=zh-TW">ECMWF Near-Realtime IFS Atmospheric Forecasts | Earth Engine Data Catalog</a>
<ul>
<li><strong>資料集可用性 2024-11-12T12:00:00Z–2025-04-16T12:00:00Z</strong></li>
<li><strong>自 2024/11/12 推出Cycle 49r1 以來</strong>，Earth Engine 就會提供產品；早期產品則不包含在內。
<ul>
<li>old one: 145 items</li>
<li>new one: 160 items</li>
</ul></li>
</ul></li>
<li><a href="https://waipangsze.github.io/2025/04/10/NWP-Herbie-Download-NWP-model-output-MPAS-WRF/#problem" class="uri">https://waipangsze.github.io/2025/04/10/NWP-Herbie-Download-NWP-model-output-MPAS-WRF/#problem</a></li>
</ul>
<h1 id="parameter-config_nfglevels">parameter "config_nfglevels"</h1>
<ul>
<li><a target="_blank" rel="noopener" href="https://forum.mmm.ucar.edu/threads/configuration-problem-for-parameter-config_nfglevels.10690/">configuration problem for parameter "config_nfglevels" | Sep 2, 2021</a>
<ul>
<li><strong>If you have 37 isobaric levels of atmospheric data, plus surface fields (u10, v10, t2, etc.), that would give a total of 38 levels</strong> from the perspective of the init_atmosphere_model program. As the error message states, config_nfglevels <strong>must therefore be set to at least 38</strong> -- so value of 38, 39, 40, 41, etc. should all work.</li>
<li>Internally, the 'config_nfglevels' namelist option is used by the init_atmosphere_model program to allocate 3-d arrays to hold the horizontally interpolated first-guess ("fg" in the config_nfglevels name) fields. Allocating too few vertical levels in these 3-d arrays is problematic, but allocating extra levels -- which will simply go unused -- isn't a problem, though it does waste memory.</li>
</ul></li>
</ul>
<h4 id="done">Done</h4>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs console">MPAS-120km_2022063000.init.nc<br></code></pre></td></tr></table></figure>
<p>and MPASv7.3 runs (./atmosphere_model) with IFS successfully as well (<strong>both with Vtable.ECMWF_GRIB2 above</strong>).</p>
<h1 id="cronjob">cronjob</h1>
<p>For <code>00z</code>,</p>

    <div class="fold">
      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-c21ca059" role="button" aria-expanded="false" aria-controls="collapse-c21ca059">
        <div class="fold-arrow">▶</div>wpsze_download_IFS-cronjob-00z.sh
      </div>
      <div class="fold-collapse collapse" id="collapse-c21ca059">
        <div class="fold-content">
          <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-comment">#################################################################</span><br><span class="hljs-comment"># https://data.ecmwf.int/ecpds/home/opendata/20250402/00z/ifs/0p25/oper/20250402000000-0h-oper-fc.grib2</span><br><span class="hljs-comment">#################################################################</span><br><span class="hljs-built_in">source</span> /home/wpsze/micromamba/etc/profile.d/micromamba.sh<br>micromamba activate venv<br><br>BASE_DIR=$(<span class="hljs-built_in">pwd</span>)<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Base Dir = <span class="hljs-variable">$&#123;BASE_DIR&#125;</span>&quot;</span><br><br><span class="hljs-keyword">for</span> ifsday <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">seq</span> 0 1 3); <span class="hljs-keyword">do</span> <span class="hljs-comment"># day-shift = 0, 1, 2, 3</span><br><br>    YYYYMMDDHH=$(<span class="hljs-built_in">date</span> -d <span class="hljs-string">&quot;today - <span class="hljs-variable">$&#123;ifsday&#125;</span> day&quot;</span> +%Y%m%d00)<br><br>    yyyy=<span class="hljs-variable">$&#123;YYYYMMDDHH:0:4&#125;</span><br>    mm=<span class="hljs-variable">$&#123;YYYYMMDDHH:4:2&#125;</span><br>    <span class="hljs-built_in">dd</span>=<span class="hljs-variable">$&#123;YYYYMMDDHH:6:2&#125;</span><br>    hh=<span class="hljs-variable">$&#123;YYYYMMDDHH:8:2&#125;</span><br><br>    yyyymm=<span class="hljs-variable">$&#123;yyyy&#125;</span><span class="hljs-variable">$&#123;mm&#125;</span><br>    yyyymmdd=<span class="hljs-variable">$&#123;yyyy&#125;</span><span class="hljs-variable">$&#123;mm&#125;</span><span class="hljs-variable">$&#123;dd&#125;</span><br><br>    tmp_dir=<span class="hljs-string">&quot;./<span class="hljs-variable">$&#123;yyyy&#125;</span><span class="hljs-variable">$&#123;mm&#125;</span>/<span class="hljs-variable">$&#123;yyyy&#125;</span><span class="hljs-variable">$&#123;mm&#125;</span><span class="hljs-variable">$&#123;dd&#125;</span>&quot;</span><br>    <span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$&#123;tmp_dir&#125;</span><br>    <span class="hljs-built_in">cd</span> <span class="hljs-variable">$&#123;tmp_dir&#125;</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Current Dir: <span class="hljs-subst">$(pwd)</span>&quot;</span><br><br>    limit_cpu_core=15<br>    count_cpu_core=1<br><br>    <span class="hljs-comment">#============== 00z ===================================</span><br>    tmp_ifs_fname=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;YYYYMMDDHH&#125;</span>0000-0h-oper-fc.grib2&quot;</span><br><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Now, <span class="hljs-variable">$&#123;tmp_ifs_fname&#125;</span> ... &quot;</span><br><br>	    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Downloading ... <span class="hljs-variable">$&#123;tmp_ifs_fname&#125;</span>&quot;</span><br>	    <span class="hljs-comment">#wget -c --no-check-certificate https://data.ecmwf.int/forecasts/$&#123;yyyy&#125;$&#123;mm&#125;$&#123;dd&#125;/00z/ifs/0p25/oper/$&#123;tmp_ifs_fname&#125;</span><br>	    wget -c --no-check-certificate https://data.ecmwf.int/ecpds/home/opendata/<span class="hljs-variable">$&#123;yyyy&#125;</span><span class="hljs-variable">$&#123;mm&#125;</span><span class="hljs-variable">$&#123;dd&#125;</span>/00z/ifs/0p25/oper/<span class="hljs-variable">$&#123;tmp_ifs_fname&#125;</span><br><br><br>    res=$(( <span class="hljs-variable">$&#123;count_cpu_core&#125;</span> % <span class="hljs-variable">$&#123;limit_cpu_core&#125;</span> ))<br>    <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$&#123;res&#125;</span> == 0 ]]; <span class="hljs-keyword">then</span><br>	    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;please wait <span class="hljs-variable">$&#123;tmp_ifs_fname&#125;</span>, <span class="hljs-variable">$&#123;count_cpu_core&#125;</span>, <span class="hljs-variable">$&#123;res&#125;</span>.&quot;</span><br>	    <span class="hljs-built_in">wait</span><br>    <span class="hljs-keyword">fi</span><br>    <br>    <span class="hljs-built_in">cd</span> <span class="hljs-variable">$&#123;BASE_DIR&#125;</span><br><span class="hljs-keyword">done</span>    <br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
<h2 id="dissemination-schedule">Dissemination schedule</h2>
<figure>
<img src="https://i.imgur.com/j5aMuFL.png" srcset="/img/loading.gif" lazyload alt="Time available (UTC)" width="400" /><figcaption>Time available (UTC)</figcaption>
</figure>
<ul>
<li><strong>HKT = UTC + 8</strong></li>
<li>How to set the crontab: <code>$ crontab -e</code></li>
</ul>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">crontab -l</span><br>30 17 * * * cd /home/wpsze/mpas/IFS; sh wpsze_download_IFS-cronjob-00z.sh <br></code></pre></td></tr></table></figure>
<h1 id="references">References</h1>
<ol type="1">
<li><a target="_blank" rel="noopener" href="https://www.ecmwf.int/en/about/media-centre/news/2024/ecmwf-releases-much-larger-open-dataset">ECMWF releases a much larger open dataset | 29 February 2024</a></li>
<li><a target="_blank" rel="noopener" href="https://www.ecmwf.int/en/forecasts/datasets/open-data">Open data | ECMWF real-time forecast data</a></li>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/Fgmgjk1_bJdmLWQfttuT0g">ECMWF IFS 免费开放预报升级到 0.25° 分辨率 | 2024年02月26日</a></li>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/keUhCa-y7xLj6I_xNfJcCw">重大升级！欧洲中期天气预报中心AI加持下免费开放了更高分辨率、更多参数的气象数据！| 2024年03月01日</a></li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/NWP/" class="category-chain-item">NWP</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/WRF/" class="print-no-link">#WRF</a>
      
        <a href="/tags/MPAS/" class="print-no-link">#MPAS</a>
      
        <a href="/tags/WPS/" class="print-no-link">#WPS</a>
      
        <a href="/tags/IC-BC/" class="print-no-link">#IC/BC</a>
      
        <a href="/tags/ECMWF/" class="print-no-link">#ECMWF</a>
      
        <a href="/tags/IFS/" class="print-no-link">#IFS</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>NWP | ECMWF | IFS | Open data</div>
      <div>https://waipangsze.github.io/2024/11/12/ECMWF-IFS/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>wpsze</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>November 12, 2024</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Updated on</div>
          <div>January 15, 2026</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/11/13/WRF-MPAS-as-ICBC/" title="WRF | MPAS Output for WRF IC/BC">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">WRF | MPAS Output for WRF IC/BC</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/11/02/wrf-topo-wind/" title="WRF | topo-wind">
                        <span class="hidden-mobile">WRF | topo-wind</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9HL36SZ28R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9HL36SZ28R');
</script>

    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">

  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  

  <span id="sitetime"></span>
  <script language=javascript>
    function siteTime(){
      window.setTimeout("siteTime()", 1000);
      var seconds = 1000;
      var minutes = seconds * 60;
      var hours = minutes * 60;
      var days = hours * 24;
      var years = days * 365;
      var today = new Date();
      var todayYear = today.getFullYear();
      var todayMonth = today.getMonth()+1;
      var todayDate = today.getDate();
      var todayHour = today.getHours();
      var todayMinute = today.getMinutes();
      var todaySecond = today.getSeconds();
      /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
      year - 作为date对象的年份，为4位年份值
      month - 0-11之间的整数，做为date对象的月份
      day - 1-31之间的整数，做为date对象的天数
      hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
      minutes - 0-59之间的整数，做为date对象的分钟数
      seconds - 0-59之间的整数，做为date对象的秒数
      microseconds - 0-999之间的整数，做为date对象的毫秒数 */
      var t1 = Date.UTC(2023,04,23,00,00,00); //北京时间2018-2-13 00:00:00
      var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
      var diff = t2-t1;
      var diffYears = Math.floor(diff/years);
      var diffDays = Math.floor((diff/days)-diffYears*365);
      var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
      var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
      var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
      /*document.getElementById("sitetime").innerHTML=" 已运行"+/*diffYears+" 年 "+*/diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
      document.getElementById("sitetime").innerHTML=" 已運行"+diffYears+" 年 "+diffDays+" 天 ";
    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
  </script>
  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
