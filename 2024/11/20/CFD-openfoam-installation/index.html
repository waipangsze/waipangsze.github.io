

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="wpsze">
  <meta name="keywords" content="">
  
    <meta name="description" content="OpenFOAM OpenFOAM是一個CFD軟體。它包括一系列應用程序，這些應用程式在CFD中執行一系列任務。應用程式主要分為兩類：link  求解器，用於執行CFD計算； 以及實現上述任務的其他程序；  在OpenFOAM-11之前，每個流動類型都需要呼叫特定的求解器。由於流動類型非常多，OpenFOAM層包含了近100個解算器。像simpleFoam和pimpleFoam這樣的求解器自上世紀">
<meta property="og:type" content="article">
<meta property="og:title" content="CFD | OpenFOAM Installation">
<meta property="og:url" content="https://waipangsze.github.io/2024/11/20/CFD-openfoam-installation/index.html">
<meta property="og:site_name" content="wpsze">
<meta property="og:description" content="OpenFOAM OpenFOAM是一個CFD軟體。它包括一系列應用程序，這些應用程式在CFD中執行一系列任務。應用程式主要分為兩類：link  求解器，用於執行CFD計算； 以及實現上述任務的其他程序；  在OpenFOAM-11之前，每個流動類型都需要呼叫特定的求解器。由於流動類型非常多，OpenFOAM層包含了近100個解算器。像simpleFoam和pimpleFoam這樣的求解器自上世紀">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.imgur.com/fFT42Yk.png">
<meta property="article:published_time" content="2024-11-20T08:21:00.000Z">
<meta property="article:modified_time" content="2024-12-03T07:14:27.201Z">
<meta property="article:author" content="wpsze">
<meta property="article:tag" content="HPC">
<meta property="article:tag" content="OpenFOAM">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.imgur.com/fFT42Yk.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>CFD | OpenFOAM Installation - wpsze</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"waipangsze.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>wpsze</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>Links</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/bookmark/" target="_self">
                <i class="iconfont icon-bookmark"></i>
                <span>Bookmarks</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About Me</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                <span>Docs</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Physics/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Physics</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Maths/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Maths</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/CFD/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>CFD</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Meteorology/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Meteorology</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/monitor/" target="_self">
                    
                    <span>Real Time Monitor</span>
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://i.imgur.com/fFT42Yk.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="CFD | OpenFOAM Installation"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-11-20 16:21" pubdate>
          November 20, 2024 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.5k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          22 mins
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> views
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">CFD | OpenFOAM Installation</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="openfoam">OpenFOAM</h1>
<p>OpenFOAM是一個CFD軟體。它包括一系列應用程序，這些應用程式在CFD中執行一系列任務。應用程式主要分為兩類：<a target="_blank" rel="noopener" href="http://www.dyfluid.com/openfoam11-1.html#id1">link</a></p>
<ul>
<li>求解器，用於執行CFD計算；</li>
<li>以及實現上述任務的其他程序；</li>
</ul>
<p>在OpenFOAM-11之前，每個流動類型都需要呼叫特定的求解器。由於流動類型非常多，OpenFOAM層包含了近100個解算器。像simpleFoam和pimpleFoam這樣的求解器自上世紀90年代初以來一直是OpenFOAM的主力。</p>
<p>然而<strong>OpenFOAM-11引進了模組化求解器，其為一個重大的改進</strong>。應用程式解算器被單一foamRun求解器取代，foamRun是一個框架性求解器。 foamRun可以載入一個求解器模組，該模組繼續呼叫對應的流動類型。例如之前simpleFoam以及pisoFoam的算例，都採用foamRun求解器來運作。在foamRun求解器程式碼中，會依據對應的演算法進行調整。這在程式碼層次的改動是相當大的。 OpenFOAM-11可以認為是一次徹底的改變。官方將這次改動的原因解釋為更加的貼近多物理場的特性，對於多物理場的耦合更加的成熟。當然這裡面也存在商業上的原因。</p>
<p>特別的，OpenFOAM-11還有一個foamMultiRun求解器，它可以接受兩個或更多域區域，並為每個區域應用不同的求解器模組。例如，它可以將一個或多個流體和固體的模組耦合起來，典型的引用就是多區域傳熱流動。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://cfd-china.com/topic/6484/openfoam-11-openfoam-v2306">OpenFOAM-11，OpenFOAM-v2306 | Jul 13, 2023 | CFD中文网</a>, <a target="_blank" rel="noopener" href="https://cfd-china.com/topic/7189/openfoam-11">openFoam-11 | CFD中文网</a>
<ul>
<li>ESI以及基金会纷纷推出OpenFOAM-v2306以及OpenFOAM-v11。后者改动尤其巨大。求解器模块化，比如之前的icoFoam是个求解器，但目前被处理成了一个库。OpenFOAM-v11比之前，在多物理场耦合方面，更加友好。但更加增加了使用难度。</li>
<li>尤其是对于OpenFOAM-11这面。OpenFOAM这面几个大改动，一个是OpenFOAM-3.0，一个是OpenFOAM-11。这个OpenFOAM-11改的，改的相当大。</li>
<li>是。。。OpeNFOAM11改动很大.. 我开始用了都发蒙</li>
<li>你就用paraFoam -buildin也行，我自己也用这个（如果不看做拉格朗日粒子的话）</li>
</ul></li>
</ul>
<h1 id="binarysource-package">Binary/Source Package</h1>
<ul>
<li><a target="_blank" rel="noopener" href="https://dl.openfoam.org/">OpenFOAM Binary/Source Package Repository</a>
<ul>
<li>source/ Source Code Packs for Compiling OpenFOAM (v1.7.0-12) on Linux</li>
<li>third-party/ Source Code Packs of Third Party Software supporting OpenFOAM (v1.7.0-12) on Linux</li>
</ul></li>
</ul>
<h1 id="software-for-compilation"><a target="_blank" rel="noopener" href="https://openfoam.org/download/source/software-for-compilation/">Software for Compilation</a></h1>
<div class="note note-primary">
            <p><a href="https://waipangsze.github.io/2023/05/06/Intel_OneAPI/">Intel OneAPI installation</a></p>
          </div>
<p>原理：OpenFOAM編譯需要一些軟體和函式庫，像是 <code>flex</code>, <code>zlib</code> 之類</p>
<p>Repository and compilation software:</p>
<ul>
<li><code>Git</code> distributed version control software used for the OpenFOAM source repositories.</li>
<li><code>Compiler</code>: either GCC version 5.5 or above; or LLVM Clang version 16 or above (possibly earlier); or the Intel oneAPI DPC++/C++ Compiler version 2021.3.0 or above. GCC is most commonly available and the version can be checked by typing</li>
<li><code>FLEX</code> fast lexical analyser, used by OpenFOAM for reading files of third-party format</li>
<li><code>cmake</code> build software for compiling ParaView, the third-party visualisation toolkit.</li>
</ul>
<p>Software for <code>OpenFOAM</code> (and <code>ParaView</code>):</p>
<ul>
<li><code>OpenMPI</code> message passing interface for parallel computation.</li>
<li><code>ParaView</code> can be installed as a system package, in which case its dependencies do not need to be installed. However, in order to compile its reader modules within OpenFOAM, all its dependencies need to be installed including the development environments of QT, graphics (GL), data formats, etc</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh"> $ micromamba <span class="hljs-built_in">env</span> create -n cfd_env<br>Empty environment created at prefix: /EM/wpsze/micromamba/envs/cfd_env<br> $ micromamba install conda-forge::zlib<br> $ micromamba install anaconda::cmake<br> $ micromamba install conda-forge::flex<br> $ micromamba install conda-forge::bison<br> $ micromamba install conda-forge::cgal<br> $ micromamba install anaconda::metis<br></code></pre></td></tr></table></figure>
<h2 id="載入環境">載入環境</h2>
<p>安裝需要載入 Intel 編譯環境和 gcc 環境，且 gcc 環境不應高於 Intel 編譯器環境</p>
<h2 id="environment-variables">Environment variables</h2>
<h3 id="wm-options">WM options</h3>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs sh">WM_THIRD_PARTY_DIR=<span class="hljs-variable">$HOME</span>/OpenFOAM/ThirdParty-1.6.x<br>WM_PROJECT_INST_DIR=<span class="hljs-variable">$HOME</span>/OpenFOAM<br>WM_PROJECT_DIR=<span class="hljs-variable">$HOME</span>/OpenFOAM/OpenFOAM-1.6.x<br>WM_DIR=<span class="hljs-variable">$HOME</span>/OpenFOAM/OpenFOAM-1.6.x/wmake<br>WM_PROJECT_USER_DIR=<span class="hljs-variable">$HOME</span>/OpenFOAM/<span class="hljs-variable">$USER</span>-1.6.x<br><br>WM_PRECISION_OPTION=DP<br>WM_ARCH_OPTION=64<br>WM_LINK_LANGUAGE=c++<br>WM_ARCH=linux64<br>WM_CXXFLAGS=-m64 -fPIC<br>WM_CFLAGS=-m64 -fPIC<br>WM_PROJECT_VERSION=1.6.x<br>WM_COMPILER_LIB_ARCH=64<br>WM_CXX=g++<br>WM_COMPILER_ARCH=<br>WM_PROJECT=OpenFOAM<br>WM_LDFLAGS=-m64<br>WM_COMPILER=Gcc<br>WM_MPLIB=OPENMPI<br>WM_CC=gcc<br>WM_COMPILE_OPTION=Opt<br>WM_OPTIONS=linux64GccDPOpt<br>WM_PRECISION_OPTION=DP<br>WM_ARCH_OPTION=64<br></code></pre></td></tr></table></figure>
<h3 id="foam-options">FOAM options</h3>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sh">FOAM_SOLVERS=<span class="hljs-variable">$HOME</span>/OpenFOAM/OpenFOAM-1.6.x/applications/solvers<br>FOAM_APPBIN=<span class="hljs-variable">$HOME</span>/OpenFOAM/OpenFOAM-1.6.x/applications/bin/linux64GccDPOpt<br>FOAM_TUTORIALS=<span class="hljs-variable">$HOME</span>/OpenFOAM/OpenFOAM-1.6.x/tutorials<br>FOAM_JOB_DIR=<span class="hljs-variable">$HOME</span>/OpenFOAM/jobControl<br>FOAM_LIB=<span class="hljs-variable">$HOME</span>/OpenFOAM/OpenFOAM-1.6.x/lib<br>FOAM_SITE_APPBIN=<span class="hljs-variable">$HOME</span>/OpenFOAM/site/1.6.x/bin/linux64GccDPOpt<br>FOAM_MPI_LIBBIN=<span class="hljs-variable">$HOME</span>/OpenFOAM/OpenFOAM-1.6.x/lib/linux64GccDPOpt/openmpi-1.3.3<br>FOAM_APP=<span class="hljs-variable">$HOME</span>/OpenFOAM/OpenFOAM-1.6.x/applications<br>FOAM_SITE_LIBBIN=<span class="hljs-variable">$HOME</span>/OpenFOAM/site/1.6.x/lib/linux64GccDPOpt<br>FOAM_SRC=<span class="hljs-variable">$HOME</span>/OpenFOAM/OpenFOAM-1.6.x/src<br>FOAM_SIGFPE=<br>FOAM_UTILITIES=<span class="hljs-variable">$HOME</span>/OpenFOAM/OpenFOAM-1.6.x/applications/utilities<br>FOAM_USER_LIBBIN=WM_PROJECT_USER_DIR/lib/linux64GccDPOpt<br>FOAM_INST_DIR=<span class="hljs-variable">$HOME</span>/OpenFOAM<br>FOAM_LIBBIN=<span class="hljs-variable">$HOME</span>/OpenFOAM/OpenFOAM-1.6.x/lib/linux64GccDPOpt<br>FOAM_RUN=WM_PROJECT_USER_DIR/run<br>FOAM_USER_APPBIN=WM_PROJECT_USER_DIR/applications/bin/linux64GccDPOpt<br></code></pre></td></tr></table></figure>
<h3 id="other-options">Other options</h3>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">MPI_ARCH_PATH=<span class="hljs-variable">$HOME</span>/OpenFOAM/ThirdParty-1.6.x/openmpi-1.3.3/platforms/linux64GccDPOpt<br>ParaView_INST_DIR=<span class="hljs-variable">$HOME</span>/OpenFOAM/ThirdParty-1.6.x/paraview-3.6.1<br>OPAL_PREFIX=<span class="hljs-variable">$HOME</span>/OpenFOAM/ThirdParty-1.6.x/openmpi-1.3.3/platforms/linux64GccDPOpt<br>ParaView_DIR=<span class="hljs-variable">$HOME</span>/OpenFOAM/ThirdParty-1.6.x/paraview-3.6.1/platforms/linux64Gcc<br>PARAVIEW_DIR=/opt/packages/Paraview3<br>ParaView_VERSION=3.6.1<br>MPI_HOME=<span class="hljs-variable">$HOME</span>/OpenFOAM/ThirdParty-1.6.x/openmpi-1.3.3<br></code></pre></td></tr></table></figure>
<h2 id="修改openfoam的配置">修改OpenFOAM的配置</h2>
<h3 id="for-openfoam-11etcbashrc">For OpenFOAM-11/<code>etc/bashrc</code>,</h3>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh">59 <span class="hljs-comment">#- Compiler location:</span><br>60 <span class="hljs-comment">#    WM_COMPILER_TYPE= system | ThirdParty (OpenFOAM)</span><br>61 <span class="hljs-built_in">export</span> WM_COMPILER_TYPE=system<br><br>63 <span class="hljs-comment">#- Compiler:</span><br>64 <span class="hljs-comment">#    WM_COMPILER = Gcc | Gcc48 ... Gcc62 | Clang | Icx</span><br>65 <span class="hljs-built_in">export</span> WM_COMPILER=Icx<br>66 <span class="hljs-built_in">unset</span> WM_COMPILER_ARCH WM_COMPILER_LIB_ARCH<br><br>86 <span class="hljs-comment">#- MPI implementation:</span><br>87 <span class="hljs-comment">#    WM_MPLIB = SYSTEMOPENMPI | OPENMPI | SYSTEMMPI | MPICH | MPICH-GM | HPMPI</span><br>88 <span class="hljs-comment">#               | MPI | FJMPI | QSMPI | SGIMPI | INTELMPI</span><br>89 <span class="hljs-built_in">export</span> WM_MPLIB=INTELMPI <br></code></pre></td></tr></table></figure>
<h3 id="for-cannot-find--lz-issude">For <strong>cannot find -lz</strong> issude,</h3>
<h4 id="check--lz">check -lz</h4>
<p>使用以下命令查詢gcc能否搜尋到指定的庫檔:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"> $ gcc -lz --verbose<br>Using built-in specs.<br>COLLECT_GCC=gcc<br>COLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-redhat-linux/8/lto-wrapper<br>...<br>/usr/bin/ld: cannot find -lz<br>collect2: error: ld returned 1 <span class="hljs-built_in">exit</span> status<br></code></pre></td></tr></table></figure>
<p>若安裝了軟體，找到了庫檔案的路徑。但依然會提示上述錯誤。則表示gcc的搜尋路徑不包含該庫檔案所在的路徑。</p>
<ul>
<li>修改環境變數
<ul>
<li><code>$ export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/opt/biosoft/hdf5-1.8.15-patch1/lib/</code></li>
<li>修改環境變數 <code>LD_LIBRARY_PATH</code>，加入函式庫檔案所在路徑。使用 <code>export</code> 指令使修改生效。</li>
<li><code>$ echo 'export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/opt/biosoft/hdf5-1.8.15-patch1/lib/' &gt;&gt; ~/.bashrc</code></li>
<li><code>$ source ~/.bashrc</code></li>
<li>將上述 <code>export</code> 指令加入設定檔 <code>~/.bashrc</code>，使其永久生效。</li>
<li><code>$ export LIBRARY_PATH=/opt/biosoft/hdf5-1.8.15-patch1/lib/:$LIBRARY_PATH</code></li>
<li><strong>若修改變數 <code>LD_LIBRARY_PATH</code> 不奏效，則修改變數 <code>LIBRARY_PATH</code> 。</strong></li>
</ul></li>
</ul>
<ol type="1">
<li><strong>cannot find -lz</strong>
<ol type="1">
<li><code>-lz</code> - is zlib, <a target="_blank" rel="noopener" href="http://zlib.net/" class="uri">http://zlib.net/</a>
<ol type="1">
<li>You may need <code>-L/opt/lib</code> to specify a path. This should give you another linker error, <strong>looking for zlib</strong>. Then add <code>-lz</code>.</li>
</ol></li>
<li><code>-lm</code> - is the math library as you've worked out (implementation defined AFAIK)</li>
<li><code>-lrt</code> - provides POSIX realtime extensions: <a target="_blank" rel="noopener" href="http://www.s-gms.ms.edus.si/cgi-bin/man-cgi?librt+3LIB" class="uri">http://www.s-gms.ms.edus.si/cgi-bin/man-cgi?librt+3LIB</a></li>
</ol></li>
<li>vim <code>ThirdParty-11/scotch_6.0.9/src/Makefile.inc</code></li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"> 6 AR      = icx<br><br> 9 CCS     = icx<br>10 CCP     = mpiicc<br>11 CCD     = mpiicc<br></code></pre></td></tr></table></figure>
<h2 id="setup-env">setup env</h2>
<ul>
<li><strong>openfoam_env.sh</strong></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">## Openfoam needs</span><br><span class="hljs-built_in">source</span> /home/wpsze/micromamba/etc/profile.d/micromamba.sh<br>micromamba activate cfd_env<br><br><span class="hljs-built_in">source</span> /home/wpsze/intel/oneapi/setvars.sh intel64<br><span class="hljs-built_in">export</span> MPI_ROOT=/home/wpsze/intel/oneapi/mpi/2021.9.0<br><span class="hljs-built_in">export</span> LD_LIBRARY_PATH=<span class="hljs-variable">$LD_LIBRARY_PATH</span>:/home/wpsze/micromamba/envs/cfd_env/lib<br><span class="hljs-built_in">export</span> C_INCLUDE_PATH=/home/wpsze/micromamba/envs/cfd_env/include<br><span class="hljs-built_in">export</span> CPLUS_INCLUDE_PATH=/home/wpsze/micromamba/envs/cfd_env/include<br><br><span class="hljs-built_in">export</span> LIBRARY_PATH=/home/wpsze/micromamba/envs/cfd_env/lib<br><span class="hljs-built_in">export</span> PATH=/home/wpsze/intel/oneapi/mpi/2021.9.0/bin:<span class="hljs-variable">$PATH</span><br><br>make --version<br>cmake --version<br>gcc --version<br>g++ --version<br>gfortran --version<br><span class="hljs-built_in">which</span> mpiifort<br>mpiifort --version<br><span class="hljs-built_in">which</span> mpiicc<br>mpiicc --version<br><br>mpirun -np 4 <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;hello&quot;</span><br></code></pre></td></tr></table></figure>
<h2 id="編譯安裝-thirdparty">編譯安裝 ThirdParty</h2>
<p>進入到 ThirdParty 的解壓縮目錄</p>
<p>在執行編譯之前，<strong>先輸入指令 echo $MPI_ROOT 查看該變數是否有值！</strong> 這點十分重要，如果MPI_ROOT為空，那麼編譯 ThirdParty 不會報錯，<strong>但是會有一個warning資訊說缺少MPI_ROOT，會缺少 ptscotchf.h</strong> 。這就導致在編譯 OpenFOAM的時候，<strong>會報錯說缺少 ptscotchf.h 導致編譯失敗！</strong>一般來說，載入intel編譯環境之後會自動 <code>export MPI_ROOT</code> 這個變量，但是也可以手動設置，輸入 <code>which mpicc</code> ，然後複製該目錄，複製到 mpi 層即可！</p>
<p>然後執行 <code>./Allclean</code> 進行清理，再執行 <code>./Allwmake</code> 進行編譯</p>
<p>如果發生報錯：本目錄不是 WM_THIRD_PARTY_DIR 目錄。說明 OpenFOAM 的 bashrc 檔案配置出現了問題，請確保 WM_THIRD_PARTY_DIR 所指定的目錄確定是ThirdParty目錄的上層目錄。</p>
<p>編譯完成之後，在同一會話視窗下回到OpenFOAM的安裝目錄，然後開始編譯安裝OpenFOAM</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">source</span> /EM/wpsze/openfoam/openfoam11/openfoam_env.sh<br><br><span class="hljs-built_in">source</span> /home/wpsze/openfoam/openfoam11/OpenFOAM-11/etc/bashrc<br><span class="hljs-built_in">cd</span> /home/wpsze/openfoam/openfoam11/ThirdParty-11<br><br><span class="hljs-built_in">pwd</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$MPI_ROOT</span><br><br>./Allclean<br>./Allwmake | <span class="hljs-built_in">tee</span> Allwmake.<span class="hljs-built_in">log</span><br></code></pre></td></tr></table></figure>
<p>output:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh">========================================<br>Build Metis decomposition<br>    optional component Metis was not found<br>========================================<br>Build Zoltan decomposition<br>    optional component Zoltan was not found<br><br>========================================<br>Done ThirdParty Allwmake<br>========================================<br></code></pre></td></tr></table></figure>
<h2 id="編譯安裝-openfoam">編譯安裝 OpenFOAM</h2>
<p>進入到OpenFOAM 的安裝目錄，執行 <code>./Allwmake -j</code> 以開始編譯，<code>-j</code> 這一參數的意思是調用起所有的CPU核心來並行編譯，當然，如果不希望調用起這麼多核，也可以指定核心數，例如 .<code>/Allwmake -j 8</code> ，只使用8 個核心</p>
<p>編譯過程十分漫長，如果編譯中途報錯說無法建立xx目錄，手動建立即可，然後重新執行 <code>./Allwmake -j</code> 會從中斷處開始編譯而不是重新從頭開始編譯。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">source</span> /home/wpsze/openfoam/openfoam11/openfoam_env.sh<br><br><span class="hljs-built_in">source</span> /home/wpsze/openfoam/openfoam11/OpenFOAM-11/etc/bashrc<br><span class="hljs-built_in">cd</span> /home/wpsze/openfoam/openfoam11/OpenFOAM-11<br><br><span class="hljs-built_in">pwd</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$MPI_ROOT</span><br><br>./Allclean<br>./Allwmake -j 16 | <span class="hljs-built_in">tee</span> Allwmake.<span class="hljs-built_in">log</span><br></code></pre></td></tr></table></figure>
<h2 id="配置運作環境">配置運作環境</h2>
<p>設定與編譯時相同的 MPI 編譯環境 - 將 OpenFOAM-x.0 裡面的 bin和platforms/linux64IccDPInt32Opt/bin 加入 PATH - 將 OpenFOAM-x.0 裡面的 platforms/linux64IccDPInt32Opt/lib 及其子目錄加入 LD_LIBRARY_PATH - 將 ThirdParty-x.0 裡面的 platforms/linux64IccDPInt32/lib 及其子目錄加入 LD_LIBRARY_PATH</p>
<h2 id="測試openfoam">測試OpenFOAM</h2>
<ul>
<li>新建一個測試目錄，將內容複製進去，然後執行OpenFOAM指令測試，如下：</li>
<li>cp -r OpenFoam-x.0/tutorials/incompressible/simpleFoam/pitzDaily .</li>
<li>cd pitzDaily</li>
<li>blockMesh</li>
<li>simpleFoam</li>
</ul>
<h1 id="paraview後處理工具安裝"><a target="_blank" rel="noopener" href="http://dyfluid.com/install.html#paraview">ParaView（後處理工具）安裝</a></h1>
<p>安裝OpenFOAM之後，還需要安裝ParaView。主要用於對OpenFOAM算例進行後處理。 Paraview的安裝有倆種方式。</p>
<ul>
<li>一種是安裝原版paraivew，</li>
<li>一種是在OpenFOAM環境中編譯paraFoam。</li>
</ul>
<div class="note note-primary">
            <p>注意，原版ParaView不能顯示拉格朗日粒子，但處理大網格算例較快。可按照所需進行選擇。也可兩者同時安裝。</p>
          </div>
<p>原版ParaView：可用透過下面的指令來安裝： <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">sudo</span> apt install paraview<br></code></pre></td></tr></table></figure> 在使用的過程中，可以在OpenFOAM算例下建立一個空檔案並命名為case.foam，然後在終端機鍵入paraview即可運作。運行後，用ParaView打開case.foam即可。</p>
<p>編譯版paraFoam：一次複製下面所有內容到終端機： <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> <span class="hljs-variable">$HOME</span>/OpenFOAM/ThirdParty-11 &amp;&amp;<br><span class="hljs-built_in">sudo</span> apt-get install git cmake build-essential libgl1-mesa-dev libxt-dev libqt5x11extras5-dev libqt5help5 qttools5-dev qtxmlpatterns5-dev-tools libqt5svg5-devm-py3335-m​​im-pyon ninja-build qtbase5-dev qtchooser qt5-qmake qtbase5-dev-tools &amp;&amp;<br>./makeParaView &amp;&amp;<br>wmRefresh &amp;&amp;<br><span class="hljs-built_in">cd</span> <span class="hljs-variable">$FOAM_UTILITIES</span>/postProcessing/graphics/PVReaders &amp;&amp;<br>./Allwclean &amp;&amp;<br>./Allwmake<br></code></pre></td></tr></table></figure></p>
<p>其會自動下載 <code>ParaView</code> 並開始編譯，編譯過程較長。然後鍵入 <code>paraFoam</code> 即可運行，其會自動建立一個後綴為 <code>.OpenFOAM</code> 的文件，並自動掛載。</p>
<h2 id="create-a-empty-file-as-.foam">Create a empty file as <code>.foam</code></h2>
<p>在資料夾中新增一個 <code>.foam</code> 的空文件，如</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs console"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">touch</span> test.foam</span><br></code></pre></td></tr></table></figure>
<p>使用 <code>paraview</code> 開啟 <code>test.foam</code>，即可查看執行結果。</p>
<h2 id="remote-paraview-recommend">Remote paraview (Recommend)</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://youtu.be/-jFw9jVHJgs">[High performance computing] How to connect to a remote ParaView server</a></li>
</ul>
<h3 id="remote-side-hpc">Remote side (HPC),</h3>
<ul>
<li>create a conda env</li>
</ul>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">micromamba <span class="hljs-built_in">env</span> create -n paraview</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">micromamba activate paraview</span> <br><span class="hljs-meta prompt_">$ </span><span class="language-bash">micromamba install paraview</span><br></code></pre></td></tr></table></figure>
<ul>
<li>open a server with define port number</li>
</ul>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs console"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cd</span> /Case-<span class="hljs-built_in">dir</span>/</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">touch</span> case.foam</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">pvserver --server-port=5566</span><br>Waiting for client...<br>Connection URL: cs://node.HPC.com:5566<br>Accepting connection(s): node.HPC.com:5566<br></code></pre></td></tr></table></figure>
<h3 id="local-pc">Local PC,</h3>
<ul>
<li>Open a new terminal, <code>ssh -N -L 5566:localhost:5566 username@remote-ip</code></li>
<li>Download the same version of paraview. <a target="_blank" rel="noopener" href="https://www.paraview.org/download/">link</a></li>
<li>Open paraview, file --&gt; connect (setup)</li>
</ul>
<p><img src="https://i.imgur.com/9szKnJ7.png" srcset="/img/loading.gif" lazyload width="600" /></p>
<div class="note note-primary">
            <p>Remark: Please re-build <code>$ pvserver --server-port=5566</code> after disconnect. (pvserver is Exited automatically.)</p>
          </div>
<div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/hcUDTWH.png" srcset="/img/loading.gif" lazyload alt="1" /></div><div class="group-image-wrap"><img src="https://i.imgur.com/4MPm2zG.png" srcset="/img/loading.gif" lazyload alt="2" /></div><div class="group-image-wrap"><img src="https://i.imgur.com/r3k8rJn.png" srcset="/img/loading.gif" lazyload alt="3" /></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/UgIhObW.png" srcset="/img/loading.gif" lazyload alt="4" /></div><div class="group-image-wrap"><img src="https://i.imgur.com/QNfj62G.png" srcset="/img/loading.gif" lazyload alt="5" /></div><div class="group-image-wrap"><img src="https://i.imgur.com/6YJTJWr.png" srcset="/img/loading.gif" lazyload alt="6" /></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="https://i.imgur.com/G2WTB6I.png" srcset="/img/loading.gif" lazyload alt="7" /></div><div class="group-image-wrap"><img src="https://i.imgur.com/ICAoNxU.png" srcset="/img/loading.gif" lazyload alt="8" /></div><div class="group-image-wrap"><img src="https://i.imgur.com/O6Pq9ar.png" srcset="/img/loading.gif" lazyload alt="9" /></div></div></div>
<div class="note note-primary">
            <p>Remark: "Display is not acessible on the server side. ......" may be login/multiple nodes issue. But, the connection is <strong>Done</strong>.</p>
          </div>
<h1 id="openfoam多版本共存">OpenFOAM多版本共存</h1>
<p>不同大廠的OpenFOAM版本各有特性，因此使用者可能有多版本OpenFOAM共存的需求。多版本OpenFOAM共存非常簡單。舉例說明：如果使用者打算在Ubuntu系統上安裝OpenFOAM-11以及OpenFOAM-8，</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">alias</span> of11=<span class="hljs-string">&quot;source ~/OpenFOAM/OpenFOAM-11/etc/bashrc&quot;</span><br><span class="hljs-built_in">alias</span> of8=<span class="hljs-string">&quot;source ~/OpenFOAM/OpenFOAM-8/etc/bashrc&quot;</span><br></code></pre></td></tr></table></figure>
<h1 id="scalability">Scalability</h1>
<p><a target="_blank" rel="noopener" href="https://www.cfd-china.com/topic/3988/200%E4%B8%87%E7%BD%91%E6%A0%BC%E5%B9%B6%E8%A1%8C%E7%AE%97%E5%8A%9B%E6%B5%8B%E8%AF%95-openfoam%E7%89%88%E6%9C%AC?_=1603587871660&amp;lang=en-US">200万网格并行算力测试（OpenFOAM版本）</a></p>
<ul>
<li>Model name: Intel(R) Xeon Phi(TM) CPU 7250 @ 1.40GHz
<ul>
<li>cpu MHz : 1500.915</li>
<li>Socket(s) : 1</li>
<li>cpu cores : 68</li>
</ul></li>
</ul>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs console"><span class="hljs-meta prompt_"># </span><span class="language-bash">cores   Wall time (s):</span><br>------------------------<br>68 266.42<br>48 403.87<br>24 562.83<br>16 825.56<br>8 1090.35<br>4 2084.06<br>2 3610.03<br>1 6573.22<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">cores   Wall time (s):</span><br>------------------------<br>204 248.78<br>136 206.09<br>68 212.28<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">cores   Wall time (s):</span><br>------------------------<br>204 251.24<br>136 207.51<br>68 207.64<br></code></pre></td></tr></table></figure>
<ul>
<li>model name : Intel(R) Xeon(R) Gold 6342 CPU @ 2.80GHz
<ul>
<li>cpu MHz : 3500.000</li>
<li>Socket(s) : 2</li>
<li>cpu cores : 24</li>
<li>siblings : 48</li>
</ul></li>
</ul>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs console"><span class="hljs-meta prompt_"># </span><span class="language-bash">cores   Wall time (s):</span><br>------------------------<br>48 55.82<br>24 92.98<br>16 132.98<br>8 175.14<br>4 348.56<br>2 554.62<br>1 920.68<br></code></pre></td></tr></table></figure>
<div class="note note-warning">
            <p><a target="_blank" rel="noopener" href="http://dyfluid.com/HPC.html">高性能计算最佳实践</a></p>
          </div>
<h2 id="性能测试cfd标准算例"><a target="_blank" rel="noopener" href="http://dyfluid.com/standard.html">性能测试CFD标准算例</a></h2>
<ul>
<li>200万网格/OpenFOAM
<ul>
<li>适用于机器内存大于16G的机器</li>
</ul></li>
<li>2000万网格/OpenFOAM
<ul>
<li>适用于机器内存大于70G的机器</li>
</ul></li>
<li>2亿网格/OpenFOAM
<ul>
<li>适用于机器内存大于512G的机器</li>
</ul></li>
</ul>
<h1 id="references">References</h1>
<ol type="1">
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_49181094/article/details/107345305">使用Intel编译器编译OpenFOAM</a></li>
<li><a target="_blank" rel="noopener" href="https://www.ctyun.cn/document/20661708/10239799">使用OpenFOAM软件进行流体力学仿真计算</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.qiql.net/archives/openfoam">Linux 平台 OpenFOAM 安装及调试指南【附安装脚本】</a></li>
<li><a target="_blank" rel="noopener" href="https://cfd-china.com/topic/3465/%E5%A4%A9%E6%B2%B3-2-%E5%8F%B7%E8%B6%85%E7%AE%97%E5%AE%89%E8%A3%85-openfoam-7-%E4%B8%8D%E5%90%ABcgal">天河 2 号超算安装 OpenFOAM 7 (不含CGAL)</a></li>
<li><a target="_blank" rel="noopener" href="https://community.intel.com/t5/Intel-MPI-Library/Parallel-CFD-simulations-with-OpenFOAM/m-p/1466576">y.tab.c:270:6: error: conflicting types for ‘scotchyyerror’</a>
<ol type="1">
<li>It means that the scotch library from ThirdParty-10 did not compile successfully. Do you have any ideas about how to solve it? I changed the line 65 in etc/bashrc to use the Intel compiler (because I think that it was possible to compile scotch with icx), however the scotch compilation during the execution of ./Allwmake still used gcc despite my changes.</li>
</ol></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhming26/p/6164131.html">/usr/bin/ld: cannot find -lxxx 的解决办法</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/panfeng412/archive/2011/10/20/library_path-and-ld_library_path.html">LIBRARY_PATH和LD_LIBRARY_PATH环境变量的区别</a>
<ol type="1">
<li><code>LIBRARY_PATH</code> 环境变量用于在<strong>程序编译期间</strong>查找动态链接库时指定查找共享库的路径</li>
<li><code>LD_LIBRARY_PATH</code> 环境变量用于在<strong>程序加载运行期间</strong>查找动态链接库时指定除了系统默认路径之外的其他路径</li>
</ol></li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CFD/" class="category-chain-item">CFD</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/HPC/" class="print-no-link">#HPC</a>
      
        <a href="/tags/OpenFOAM/" class="print-no-link">#OpenFOAM</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>CFD | OpenFOAM Installation</div>
      <div>https://waipangsze.github.io/2024/11/20/CFD-openfoam-installation/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>wpsze</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>November 20, 2024</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Updated on</div>
          <div>December 3, 2024</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/11/25/wps-in-parallel-or-in-serial/" title="WRF | WPS in parallel or in serial">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">WRF | WPS in parallel or in serial</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/11/19/A_review_of_non-hydrostatic_numerical_models_for_the_atmosphere/" title="NWP | Non-hydrostatic numerical models for the atmosphere">
                        <span class="hidden-mobile">NWP | Non-hydrostatic numerical models for the atmosphere</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">

  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  

  <span id="sitetime"></span>
  <script language=javascript>
    function siteTime(){
      window.setTimeout("siteTime()", 1000);
      var seconds = 1000;
      var minutes = seconds * 60;
      var hours = minutes * 60;
      var days = hours * 24;
      var years = days * 365;
      var today = new Date();
      var todayYear = today.getFullYear();
      var todayMonth = today.getMonth()+1;
      var todayDate = today.getDate();
      var todayHour = today.getHours();
      var todayMinute = today.getMinutes();
      var todaySecond = today.getSeconds();
      /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
      year - 作为date对象的年份，为4位年份值
      month - 0-11之间的整数，做为date对象的月份
      day - 1-31之间的整数，做为date对象的天数
      hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
      minutes - 0-59之间的整数，做为date对象的分钟数
      seconds - 0-59之间的整数，做为date对象的秒数
      microseconds - 0-999之间的整数，做为date对象的毫秒数 */
      var t1 = Date.UTC(2023,04,23,00,00,00); //北京时间2018-2-13 00:00:00
      var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
      var diff = t2-t1;
      var diffYears = Math.floor(diff/years);
      var diffDays = Math.floor((diff/days)-diffYears*365);
      var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
      var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
      var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
      /*document.getElementById("sitetime").innerHTML=" 已运行"+/*diffYears+" 年 "+*/diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
      document.getElementById("sitetime").innerHTML=" 已運行"+diffYears+" 年 "+diffDays+" 天 ";
    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
  </script>
  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
