

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="wpsze">
  <meta name="keywords" content="">
  
    <meta name="description" content="By micromamba (Recommend) 123456789101112$ micromamba create -n ecFlowEmpty environment created at prefix: &#x2F;home&#x2F;wpsze&#x2F;micromamba&#x2F;envs&#x2F;ecFlow$ micromamba activate ecFlow|ecFlow|wpsze:&#x2F;home&#x2F;wpsze $ mic">
<meta property="og:type" content="article">
<meta property="og:title" content="ecFlow -- Installation &amp; Usage">
<meta property="og:url" content="https://waipangsze.github.io/2024/06/07/ecflow/index.html">
<meta property="og:site_name" content="wpsze">
<meta property="og:description" content="By micromamba (Recommend) 123456789101112$ micromamba create -n ecFlowEmpty environment created at prefix: &#x2F;home&#x2F;wpsze&#x2F;micromamba&#x2F;envs&#x2F;ecFlow$ micromamba activate ecFlow|ecFlow|wpsze:&#x2F;home&#x2F;wpsze $ mic">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://ecflow.readthedocs.io/en/latest/_images/image1.png">
<meta property="article:published_time" content="2024-06-07T09:17:00.000Z">
<meta property="article:modified_time" content="2025-01-03T06:53:26.578Z">
<meta property="article:author" content="wpsze">
<meta property="article:tag" content="Installation">
<meta property="article:tag" content="Micromamba">
<meta property="article:tag" content="Spack">
<meta property="article:tag" content="ecFlow">
<meta property="article:tag" content="Conda">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://ecflow.readthedocs.io/en/latest/_images/image1.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>ecFlow -- Installation &amp; Usage - wpsze</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"waipangsze.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":"F7MK-FcxSomhtc1N3hIUDA"},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=F7MK-FcxSomhtc1N3hIUDA", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', 'F7MK-FcxSomhtc1N3hIUDA');
        });
      }
    </script>
  

  

  

  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>wpsze</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>Links</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/bookmark/" target="_self">
                <i class="iconfont icon-bookmark"></i>
                <span>Bookmarks</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                <span>Docs</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Physics/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Physics</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Maths/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Maths</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/CFD/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>CFD</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/ML/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>ML</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Meteorology/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>Meteorology</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/MPAS/" target="_self">
                    <i class="iconfont icon-plan"></i>
                    <span>MPAS</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/monitor/" target="_self">
                    
                    <span>Real Time Monitoring</span>
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About Me</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://ecflow.readthedocs.io/en/latest/_images/image1.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="ecFlow -- Installation &amp; Usage"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-06-07 17:17" pubdate>
          June 7, 2024 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          807 words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          7 mins
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> views
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">ecFlow -- Installation &amp; Usage</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="by-micromamba-recommend">By micromamba (Recommend)</h1>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ micromamba create -n ecFlow<br>Empty environment created at prefix: /home/wpsze/micromamba/envs/ecFlow<br>$ micromamba activate ecFlow<br>|ecFlow|wpsze:/home/wpsze $ micromamba install ecflow -c conda-forge<br>|ecFlow|wpsze:/home/wpsze $ ecflow_client --version<br>Ecflow version(5.13.0) boost(1.84.0) compiler(gcc 12.3.0) protocol(JSON cereal 1.3.0) openssl(enabled) Compiled on Jun 20 2024 08:28:01<br><br> $ ecf*<br>ecflow_client        ecflow_http          ecflow_logsvr.pl     ecflow_standalone    ecflow_stop.sh       <br>ecflow_udp_client    ecflow_ui.x<br>ecflow_fuse.py       ecflow_logserver.sh  ecflow_server        <br>ecflow_start.sh      ecflow_udp           ecflow_ui<br></code></pre></td></tr></table></figure>
<p>and it installs,</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">+ libboost-python                  1.84.0  py312h389efb2_3      conda-forge      124kB<br>+ libboost-python-devel            1.84.0  py312h9cebb41_3      conda-forge       20kB<br>+ ecflow                           5.13.0  py312hc3ad225_0      conda-forge       17MB<br></code></pre></td></tr></table></figure>
<p>where boost is 1.84.0</p>
<h1 id="ecflow-quickstart">ecFlow Quickstart</h1>
<p><a target="_blank" rel="noopener" href="https://confluence.ecmwf.int/display/ECFLOW/ecFlow+Quickstart">ecFlow Quickstart</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs sh"> $ ll ./ecflow_quickstart  <br>total 160K<br>drwxrwxr-x 3 wpsze wpsze  33K Jun  7 22:06 ./<br>drwxrwxr-x 3 wpsze wpsze  33K Jun  7 22:06 ../<br>-rw-rw-r-- 1 wpsze wpsze 2.4K Jun  7 17:51 ecflow_quickstart.tar.gz<br>-rw-r--r-- 1 wpsze wpsze 1.8K Nov  2  2022 head.h<br>-rw-r--r-- 1 wpsze wpsze  760 Nov  2  2022 instructions.txt<br>-rw-r--r-- 1 wpsze wpsze  209 Nov  1  2022 tail.h<br>drwxr-xr-x 2 wpsze wpsze  33K Nov  2  2022 <span class="hljs-built_in">test</span>/<br>-rw-r--r-- 1 wpsze wpsze  222 Nov  2  2022 test.def<br><br> $ ll <span class="hljs-built_in">test</span><br>total 165K<br>drwxr-xr-x 2 wpsze wpsze  33K Nov  2  2022 ./<br>drwxrwxr-x 3 wpsze wpsze  33K Jun  7 22:06 ../<br>-rw-r--r-- 1 wpsze wpsze  627 Nov  2  2022 t1.1<br>-rw-r--r-- 1 wpsze wpsze  877 Nov  2  2022 t1.2<br>-rw-r--r-- 1 wpsze wpsze  119 Nov  2  2022 t1.ecf<br>-rwxr-xr-x 1 wpsze wpsze 2.1K Nov  2  2022 t1.job1*<br>-rwxr-xr-x 1 wpsze wpsze 2.1K Nov  2  2022 t1.job2*<br>-rw-r--r-- 1 wpsze wpsze  627 Nov  2  2022 t2.1<br>-rw-r--r-- 1 wpsze wpsze  118 Nov  2  2022 t2.ecf<br>-rwxr-xr-x 1 wpsze wpsze 2.1K Nov  2  2022 t2.job1*<br><br> $ <span class="hljs-built_in">cat</span> <span class="hljs-built_in">test</span>/t1.ecf <br>%include <span class="hljs-string">&quot;../head.h&quot;</span><br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;I, %ECF_NAME%, am part of a suite that lives in %ECF_HOME%&quot;</span><br><span class="hljs-built_in">sleep</span> 2<br><br>%include <span class="hljs-string">&quot;../tail.h&quot;</span><br><br> $ <span class="hljs-built_in">cat</span> <span class="hljs-built_in">test</span>/t2.ecf <br>%include <span class="hljs-string">&quot;../head.h&quot;</span><br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;I, %ECF_NAME%, am part of a suite that lives in %ECF_HOME%&quot;</span><br><span class="hljs-built_in">sleep</span> 2<br><br>%include <span class="hljs-string">&quot;../tail.h&quot;</span><br></code></pre></td></tr></table></figure>
<h2 id="inspect-and-update-the-suite-definition">Inspect and update the suite definition</h2>
<p>The file <strong>test.def</strong> defines a suite called "test". Open this file in a text editor and note the structure.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">suite <span class="hljs-built_in">test</span><br>   edit ECF_HOME <span class="hljs-string">&quot;/replace/with/own/home/ecflow/quickstart&quot;</span><br>   task t1<br>   task t2<br>        trigger t1 eq complete<br>endsuite<br></code></pre></td></tr></table></figure>
<p>We define a suite called "test"; it defines a variable called <strong>ECF_HOME</strong>, then it defines two tasks <strong>("tasks" are things that actually run)</strong> and specifies that <strong>task t2 will be run as soon as task t1 has completed</strong>. The scripts corresponding to the tasks are specified in <strong>".ecf"</strong> files in the test directory. Have a look - they simply print some information about themselves, then sleep for 2 seconds.</p>
<p>The first thing you must do is to complete the path to your working directory in the <strong>ECF_HOME</strong> definition in test.def and save the file.</p>
<h2 id="start-an-ecflow-server">Start an ecFlow server</h2>
<p>We will start a <strong>new running instance of an ecFlow server using the default port (# start ecFlow with default port 3141)</strong>. It is possible to use a different port by <strong>adding --port=3500 (for example)</strong> to every ecFlow command-line action. Note also that we start it as a background task - it will run until the server is stopped. It can be run in the foreground, but in that case you will need to use a new terminal for any subsequent commands!</p>
<p>To start the ecflow server:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ ecflow_server &amp;<br>or<br>$ <span class="hljs-built_in">export</span> ECF_PORT=3141<br>$ ecflow_start.sh -d /home/wpsze/xxx -p <span class="hljs-variable">$ECF_PORT</span><br></code></pre></td></tr></table></figure>
<p><strong>make sure this port can be used</strong> {:.info}</p>
<h3 id="check-what-port-numbers-are-being-used">check what port numbers are being used</h3>
<h3 id="netstat--lnptu">netstat -lnptu</h3>
<p>You can check what port numbers are being used, with netstat: To list all open network ports on your machine, run <strong>netstat -lnptu</strong>. Here is a breakdown of the parameters:</p>
<p>l - List all listening ports n - Display the numeric IP addresses (i.e., don't do reverse DNS lookups p - List the process name that is attached to that port t - List all TCP connections u - List all UDP connections</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ netstat -lnptu<br>tcp        0      0 0.0.0.0:3141            0.0.0.0:*               LISTEN      169655/ecflow_serve<br></code></pre></td></tr></table></figure>
<p>Check that it is running:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ ecflow_client --ping --port=3141<br>ping server(localhost:3141) succeeded <span class="hljs-keyword">in</span> 00:00:00.034207  ~34 milliseconds<br></code></pre></td></tr></table></figure>
<p>or check</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"> $ ps -u wpsze -f | grep ecflow | grep -v grep<br>wpsze    3248171 3700943  0 14:26 pts/6    00:00:00 ecflow_server<br></code></pre></td></tr></table></figure>
<p>Please note <strong>“Host”</strong> and <strong>“Port Number”</strong> here. Also note that each user must use a unique port number (we recommend using a random number between 2500 and 9999)</p>
<p>To stop the ecflow server:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">ecflow_stop.sh -p <span class="hljs-variable">$ECF_PORT</span><br></code></pre></td></tr></table></figure>
<p>e.g.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh"> $ ecflow_stop.sh -p 3141<br>Fri Jun 28 08:57:33 UTC 2024<br><br>User <span class="hljs-string">&quot;10004&quot;</span> attempting to stop ecf server on ip:3141<br><br>Checking <span class="hljs-keyword">if</span> the server is running on ip:3141<br>ping server(ip:3141) succeeded <span class="hljs-keyword">in</span> 00:00:00.011797  ~11 milliseconds<br><br>Halting, check pointing and terminating the server<br>[1]+  Done                    ecflow_server<br></code></pre></td></tr></table></figure>
<p>and then,</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ ps -u wpsze -f | grep ecflow | grep -v grep<br></code></pre></td></tr></table></figure>
<p>has shown nothing now.</p>
<h2 id="load-your-suite-definition-into-the-server">Load your suite definition into the server **</h2>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ ecflow_client --load=test.def --port=3141<br></code></pre></td></tr></table></figure>
<p>More, <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">ecflow_client --<span class="hljs-built_in">help</span><br>ecflow_client --load=/my/home/fred.def<br>ecflow_client --load=/my/home/exotic.def            <span class="hljs-comment"># will error if suites of same name exists</span><br>ecflow_client --load=/my/home/exotic.def force      <span class="hljs-comment"># overwrite suite&#x27;s of same name in the server</span><br>ecflow_client --load=/my/home/exotic.def check_only <span class="hljs-comment"># Just check, don&#x27;t send to server</span><br>ecflow_client --load=/my/home/exotic.def stats      <span class="hljs-comment"># Show defs statistics, don&#x27;t send to server</span><br>ecflow_client --load=host1.3141.check               <span class="hljs-comment"># Load checkpoint file to the server</span><br>ecflow_client --load=host1.3141.check <span class="hljs-built_in">print</span>         <span class="hljs-comment"># print definition to standard out in defs format</span><br></code></pre></td></tr></table></figure></p>
<p>Check that it is loaded by asking the server to give you back the suite definition:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ ecflow_client --get --port=3141<br><span class="hljs-comment">#5.11.4</span><br>suite <span class="hljs-built_in">test</span><br>  edit ECF_HOME <span class="hljs-string">&#x27;/home/wpsze/ecflow/ecflow_quickstart/&#x27;</span><br>  task t1<br>  task t2<br>    trigger t1 eq complete<br>endsuite<br><span class="hljs-comment"># enddef</span><br></code></pre></td></tr></table></figure>
<h2 id="monitor-and-interact-via-the-gui">Monitor and interact via the GUI</h2>
<h3 id="start-ecflowui-local-pc">Start ecFlowUI: (Local PC)</h3>
<p>When opening the ecflow GUI flow for the first time you will need to add your server to the GUI. In the GUI click on <strong>“Servers” and then “Manage servers”</strong>. A new window will appear. Click on <strong>“Add server”. Here you need to add the Name, Host, and Port of your server</strong>. For “Host” and “Port” please refer to the last section of output from the previous step.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ ecflow_ui &amp;<br></code></pre></td></tr></table></figure>
<h3 id="ssh-tunnel">ssh tunnel</h3>
<p>SSH tunneling, or SSH port forwarding, is a method of transporting arbitrary data over an encrypted SSH connection. SSH tunnels allow connections made to a local port (that is, to a port on your own desktop) to be forwarded to a remote machine via a secure channel.</p>
<p>on local PC terminal, <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ ssh -L 9090:localhost:3141 server.ip<br>$ ssh -NL 9090:localhost:3141 server.ip<br></code></pre></td></tr></table></figure> where local PC's port 9090 to server.ip's port 3141</p>
<p>and you can set ecflow_ui config, - host=localhost - port=local PC's port 9090</p>
<h3 id="ecflowui-has-started">ecFlowUI has started</h3>
<p>Once ecFlowUI has started, you must tell it how to reach your server. Go to the</p>
<p>Servers → Manage Servers menu, click "Add server", then enter the details of your server. Name can be anything you want - it's for you to identify the server to your self; something like "localtest" would be fine here. Host should in this case be "localhost", and Port should be XXX. The other fields can be left blank, but keep the "Add server to current view" box ticked.</p>
<p>You should now see your suite loaded into the GUI! To make the server active, right-click on the top-level node representing the server ("localtest in our case) and choose <strong>"Restart"</strong>. Now right-click on the "test" node and <strong>choose "Begin"</strong> to make the suite active. The default behaviour is to only refresh its view of the suite every 60 seconds, so you will need to click the green refresh button at the top every so often to see the progress of the tasks.</p>
<figure>
<img src="https://confluence.ecmwf.int/download/attachments/52464709/worddavd23273b6552a14558257676bb73f41be.png?version=1&amp;modificationDate=1448363109499&amp;api=v2" srcset="/img/loading.gif" lazyload alt="ecflow-ui_Task" /><figcaption>ecflow-ui_Task</figcaption>
</figure>
<p>The diagram shows the typical status changes for a Task.</p>
<h2 id="start">Start</h2>
<p>At this time, the service is stopped and needs to be started manually.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-variable">$ecflow_client</span> --begin --host=login05 --port=3141<br></code></pre></td></tr></table></figure>
<p>Since no triggering mechanism is added, t1 will be executed immediately after the service starts.</p>
<h2 id="replace-suite">Replace suite</h2>
<p>Replace the entire suite, <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">ecflow_client --replace=/test test.def --port=3141<br></code></pre></td></tr></table></figure></p>
<h2 id="check-the-status-of-the-server">check the status of the server</h2>
<p>To check the status of the server, enter the following unix command <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">ecflow_client --host=login05 --port=3141 --stats<br>Server statistics<br>   Version                         Ecflow version(5.13.0) boost(1.84.0) compiler(gcc 12.3.0) protocol(JSON cereal 1.3.0) openssl(enabled) Compiled on Jun 20 2024 08:28:01<br>   Status                          RUNNING<br>   Host                            xxx.com<br>   Port                            3141<br>   Up since                        2024-Jul-02 23:44:29<br>......<br></code></pre></td></tr></table></figure> If ecflow_server is in <strong>halted state</strong>, the server needs to be restarted.</p>
<h2 id="ecflow-variables">ecFlow variables</h2>
<p><a target="_blank" rel="noopener" href="https://confluence.ecmwf.int/display/ECFLOW/ecFlow++variables">ecFlow variables</a></p>
<blockquote>
<p>ECF_HOME ECF_INCLUDE ECF_FILES</p>
</blockquote>
<h2 id="execute-rerun-requeue">Execute, rerun, requeue</h2>
<p>In ecflow_ui, it is important to understand the distinction between execute, rerun and re-queue.</p>
<p>These options are available with the right mouse button over a task.</p>
<blockquote>
<p><strong>Execute</strong>: This means run the task immediately. (Hence ignores any dependency that holds the task).</p>
</blockquote>
<p>This option preserves the previous output, from the job. You should see output files t1.1, t1.2, t1.3, each time the task is run.</p>
<blockquote>
<p><strong>Rerun</strong>: This places the task, back into the queued state.</p>
</blockquote>
<p>The task will now honour any dependencies that would hold the job. i.e. time dependencies, limits, triggers, suspend, etc. (You will be introduced to these terms later on in the tutorial) If the task does run, the previous output is preserved.</p>
<blockquote>
<p><strong>Re-queue</strong>: This resets the task back to the queued state.</p>
</blockquote>
<p>If the task has a default status, this is applied. The task output number is reset, such that the next output will be written to t1.1. This will overwrite any existing output with that extension when the task runs. Any subsequent calls to execute or rerun will now overwrite the output files, t1.2,t1.3 etc.</p>
<h2 id="add-description">Add description</h2>
<p>The manual page makes the documentation in the <strong>ecf script</strong> visible in ecflow_ui.</p>
<p>The description page is the combination of all the text before the directives <strong>%manual</strong> and <strong>%end</strong>. (or create <strong>f1.man</strong>)</p>
<p>e.g. edit t2.ecf <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sh">%manual<br>   Manual <span class="hljs-keyword">for</span> task t2<br>   Operations: <span class="hljs-keyword">if</span> this task fails, <span class="hljs-built_in">set</span> it to complete and report next working day<br>   Analyst:    Check something ?<br>%end<br> <br>%include &lt;head.h&gt;<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;I am part of a suite that lives in %ECF_HOME%&quot;</span><br>%include &lt;tail.h&gt;<br> <br>%manual<br>   There can be multiple manual pages <span class="hljs-keyword">in</span> the same file.<br>   When viewed they are simply concatenated.<br>%end<br></code></pre></td></tr></table></figure></p>
<h2 id="familys">familys</h2>
<p>Tasks can be organized into a tree structure similar to a Unix file system, where <strong>task is like a file</strong> and <strong>family is like a folder</strong>.</p>
<p>A suite is a family with additional properties (see Dates). <strong>family</strong> can contain other families. Similar to directories, tasks in different families can have the same name.</p>
<p>Unless a file location is specified, ecFlow assumes that the structure of the suite corresponds to the location of the task file in the file system.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># Definition of the suite test.</span><br> suite <span class="hljs-built_in">test</span><br>   edit ECF_INCLUDE <span class="hljs-string">&quot;<span class="hljs-variable">$ECF_HOME</span>/course&quot;</span>  <span class="hljs-comment"># replace &#x27;$ECF_HOME&#x27; with the path to your ECF_HOME directory</span><br>   edit ECF_HOME    <span class="hljs-string">&quot;<span class="hljs-variable">$ECF_HOME</span>/course&quot;</span><br>   family f1<br>      task t1<br>      task t2<br>   endfamily<br>endsuite<br></code></pre></td></tr></table></figure>
<h2 id="time-dependencies">Time Dependencies</h2>
<p><a target="_blank" rel="noopener" href="https://confluence.ecmwf.int/display/ECFLOW/Time+Dependencies">Time Dependencies</a></p>
<h2 id="time-triggers">Time Triggers</h2>
<p><a target="_blank" rel="noopener" href="https://confluence.ecmwf.int/display/ECFLOW/Time+Triggers">Time Triggers</a></p>
<h2 id="add-a-cron">Add a Cron</h2>
<p><a target="_blank" rel="noopener" href="https://confluence.ecmwf.int/display/ECFLOW/Add+a+Cron">Add a Cron</a></p>
<h2 id="repeat-repeat">Repeat *** <a target="_blank" rel="noopener" href="https://confluence.ecmwf.int/display/ECFLOW/Repeat">Repeat</a></h2>
<p>It is sometimes useful to repeat the same task or family several times, looping on a specific value. You can do that by defining a repeat attribute. You can iterate over sequences of:</p>
<ul>
<li>strings</li>
<li>integers</li>
<li>dates</li>
</ul>
<p>A sequence of integers or dates is created by specifying the first and the last element, with an optional increment (the default is one).</p>
<p>From <strong>ecflow5 we can also loop over an arbitrary list of dates</strong>. <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">repeat datelist YMD 20130101 20130102 20130103 20200101 20190101<br>repeat <span class="hljs-built_in">date</span> YMD 20090331 20121212 1  <span class="hljs-comment"># &lt;start&gt; &lt;end&gt; &lt;increment&gt;</span><br></code></pre></td></tr></table></figure></p>
<blockquote>
<p>The following generated variables, are accessible for trigger expressions YMD, YMD_YYYY, YMD_MM, YMD_DD, YMD_DOW,YMD_JULIAN</p>
</blockquote>
<p>e.g. <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sh"><br><span class="hljs-comment"># Definition of the suite test.</span><br>suite <span class="hljs-built_in">test</span><br> edit ECF_INCLUDE <span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/course&quot;</span><br> edit ECF_HOME    <span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/course&quot;</span><br> family f4<br>     edit SLEEP 2<br>     repeat string NAME a b c d e f<br>     family f5<br>         repeat <span class="hljs-built_in">integer</span> VALUE 1 10<br>         task t1<br>             repeat <span class="hljs-built_in">date</span> DATE 20101230 20110105<br>             label info <span class="hljs-string">&quot;&quot;</span><br>             label <span class="hljs-built_in">date</span> <span class="hljs-string">&quot;&quot;</span><br>     endfamily<br> endfamily<br>endsuite<br></code></pre></td></tr></table></figure></p>
<p><a target="_blank" rel="noopener" href="https://confluence.ecmwf.int/display/ECFLOW/Glossary#term-trigger">repeat &amp; trigger</a></p>
<p>When we use relative time attributes under a Repeat. They are automatically reset when the repeat loops. Take for example: <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh">suite <span class="hljs-built_in">test</span><br> edit ECF_HOME    <span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/course&quot;</span><br> edit ECF_INCLUDE <span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/course&quot;</span><br> edit ECF_FILES <span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/course&quot;</span><br>  family hc00<br>    repeat <span class="hljs-built_in">integer</span> HYEAR 1993 2017<br>    task t1<br>    task t2<br>      trigger t1  == complete<br>  endfamily<br>endsuite<br></code></pre></td></tr></table></figure></p>
<p><strong>Repeat increment</strong></p>
<p>A repeat under a family node will only increment when all the child nodes are complete.</p>
<p>In the example above, <strong>once task t1, and t2 are complete</strong>, the repeat integer rep will increment to the next value.</p>
<h2 id="with-sbatch">with SBATCH</h2>
<p>sbatch.h <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c++">#SBATCH --qos=%QUEUE%<br>#SBATCH --job-name=%TASK%_%FAMILY1:NOT_DEF%<br>#SBATCH --account=%ACCOUNT%<br>#SBATCH --output=%ECF_JOBOUT%<br>#SBATCH --error=%ECF_JOBOUT%<br>#SBATCH --time=%RQ_TIME%<br></code></pre></td></tr></table></figure></p>
<h1 id="references">References</h1>
<ol type="1">
<li><a target="_blank" rel="noopener" href="https://perillaroc.github.io/ecflow-tutorial-cn/chap01/">ECFLOW教程 2018</a></li>
<li><strong><a target="_blank" rel="noopener" href="https://cemc-ecflow-tutorial-2023.readthedocs.io/zh-cn/latest/">CEMC ecFlow 实战教程 本教程用于 CEMC 2023 培训的 ecFlow 上机实习环节</a></strong></li>
<li><a target="_blank" rel="noopener" href="https://confluence.ecmwf.int/display/ECFLOW/Conda-forge">The latest ecflow is available for Linux and macOS from conda forge</a></li>
<li><a target="_blank" rel="noopener" href="https://git.ecmwf.int/projects/USS">https://git.ecmwf.int/projects/USS</a></li>
<li><a target="_blank" rel="noopener" href="https://confluence.ecmwf.int/display/UDOC/HPC2020%3A+Using+ecFlow">HPC2020: Using ecFlow</a></li>
<li><a target="_blank" rel="noopener" href="http://qxkj.ijournals.cn/qxkj/article/abstract/20190122">基于ECFLOW实现华中区域快速更新-同化预报业务流程</a></li>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/d17lDCd7f2_hS0S4E1mgTg">ecFlow学习笔记：编译V5.X版本</a></li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/MPAS/" class="category-chain-item">MPAS</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Installation/" class="print-no-link">#Installation</a>
      
        <a href="/tags/Micromamba/" class="print-no-link">#Micromamba</a>
      
        <a href="/tags/Spack/" class="print-no-link">#Spack</a>
      
        <a href="/tags/ecFlow/" class="print-no-link">#ecFlow</a>
      
        <a href="/tags/Conda/" class="print-no-link">#Conda</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>ecFlow -- Installation &amp; Usage</div>
      <div>https://waipangsze.github.io/2024/06/07/ecflow/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>wpsze</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>June 7, 2024</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Updated on</div>
          <div>January 3, 2025</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/06/10/spack_stack_jedi_mpas/" title="Spack-Stack (MPAS-JEDI)">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Spack-Stack (MPAS-JEDI)</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/06/07/spack/" title="Spack">
                        <span class="hidden-mobile">Spack</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9HL36SZ28R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9HL36SZ28R');
</script>

    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">

  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  

  <span id="sitetime"></span>
  <script language=javascript>
    function siteTime(){
      window.setTimeout("siteTime()", 1000);
      var seconds = 1000;
      var minutes = seconds * 60;
      var hours = minutes * 60;
      var days = hours * 24;
      var years = days * 365;
      var today = new Date();
      var todayYear = today.getFullYear();
      var todayMonth = today.getMonth()+1;
      var todayDate = today.getDate();
      var todayHour = today.getHours();
      var todayMinute = today.getMinutes();
      var todaySecond = today.getSeconds();
      /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
      year - 作为date对象的年份，为4位年份值
      month - 0-11之间的整数，做为date对象的月份
      day - 1-31之间的整数，做为date对象的天数
      hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
      minutes - 0-59之间的整数，做为date对象的分钟数
      seconds - 0-59之间的整数，做为date对象的秒数
      microseconds - 0-999之间的整数，做为date对象的毫秒数 */
      var t1 = Date.UTC(2023,04,23,00,00,00); //北京时间2018-2-13 00:00:00
      var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
      var diff = t2-t1;
      var diffYears = Math.floor(diff/years);
      var diffDays = Math.floor((diff/days)-diffYears*365);
      var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
      var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
      var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
      /*document.getElementById("sitetime").innerHTML=" 已运行"+/*diffYears+" 年 "+*/diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
      document.getElementById("sitetime").innerHTML=" 已運行"+diffYears+" 年 "+diffDays+" 天 ";
    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
  </script>
  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
